<!DOCTYPE html><html lang="en-US"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 32.3.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>


<style>

#discoverer-fetch-iteration {
  background-color: yellow;
}
#discoverer-fetch-links {
  background-color: yellow;
}
#discoverer-fetch-tdd {
  background-color: yellow;
}
#discoverer-track {
  background-color: yellow;
}
#exploration-link-description-link {
  background-color: yellow;
}
#exploration-link-description-type {
  background-color: yellow;
}
#exploration-secboot-401 {
  background-color: yellow;
}
#exploration-secboot-auth {
  background-color: yellow;
}
#exploration-secboot-oauth2-flows {
  background-color: yellow;
}
#exploration-server-coap-size2 {
  background-color: yellow;
}
#exploration-server-http-alternate-content {
  background-color: yellow;
}
#exploration-server-http-alternate-language {
  background-color: yellow;
}
#introduction-core-rd-resource-type-directory {
  background-color: yellow;
}
#introduction-direct-directory-description {
  background-color: yellow;
}
#introduction-dns-sd-service-name-directory-udp {
  background-color: yellow;
}
#introduction-dns-sd-service-name-udp {
  background-color: yellow;
}
#priv-loc-anonymous-tds {
  background-color: yellow;
}
#priv-loc-disable-public-directories {
  background-color: yellow;
}
#priv-loc-explicit-care {
  background-color: yellow;
}
#priv-loc-explicit-strip {
  background-color: yellow;
}
#priv-loc-gen-ids {
  background-color: yellow;
}
#priv-loc-priv-dir-access {
  background-color: yellow;
}
#priv-query-anon {
  background-color: yellow;
}
#sec-self-proxy {
  background-color: yellow;
}
#sec-tdd-intro-if-multicast-required {
  background-color: yellow;
}
#sec-tdd-intro-limit-response-size {
  background-color: yellow;
}
#sec-tdd-intro-no-multicast {
  background-color: yellow;
}
#sec-tdd-intro-no-observe {
  background-color: yellow;
}
#sec-tdd-intro-throttling {
  background-color: yellow;
}
#sec-tdd-limit-query-complexity {
  background-color: yellow;
}
#sec-tdd-query-watchdog {
  background-color: yellow;
}
#sec-tdd-throttle-queries {
  background-color: yellow;
}
#security-bootstrapping-endpoints {
  background-color: yellow;
}
#tdd-absolute-time {
  background-color: yellow;
}
#tdd-http-alternate-language {
  background-color: yellow;
}
#tdd-http-error-response-lang {
  background-color: yellow;
}
#tdd-http-representation-alternate-output {
  background-color: yellow;
}
#tdd-notification-data-diff-unsupported {
  background-color: yellow;
}
#tdd-registrationinfo-expiry-config {
  background-color: yellow;
}
#tdd-things-list-pagination-collection {
  background-color: yellow;
}
#tdd-things-list-pagination-order {
  background-color: yellow;
}
#tdd-things-list-pagination-order-nextlink {
  background-color: yellow;
}
#tdd-things-list-pagination-order-utf-8 {
  background-color: yellow;
}
#tdd-things-list-pagination-orderable {
  background-color: yellow;
}
#tdd-validation-response-lang {
  background-color: yellow;
}

</style>


<title>Web of Things (WoT) Discovery</title>



<style type="text/css">

a[href].internalDFN {
        color: inherit;
        border-bottom: 1px solid #99c;
        text-decoration: none;
}
img.wot-diagram {
    max-width: 90%;
    height: auto;
}
.rfc2119-assertion {
  background-color: rgb(230,230,230)
}
.at-risk {
  background-color: yellow
}

</style>

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="description" content="The W3C Web of Things (WoT) is intended to enable
           interoperability across IoT platforms and application
           domains.  One key mechanism for accomplishing this goal
           is the definition and use of metadata describing the
           interactions an IoT device or service makes available
           over the network at a suitable level of abstraction.  
           The WoT Thing Description specification satisfies this objective.">
<link rel="canonical" href="https://www.w3.org/TR/wot-discovery/">
<script type="application/ld+json">{
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en-US",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/wot-discovery/",
  "type": [
    "TechArticle",
    "w3p:CR"
  ],
  "name": "Web of Things (WoT) Discovery",
  "inLanguage": "en-US",
  "license": "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document",
  "datePublished": "2022-11-02",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/wot-discovery/issues/",
  "alternativeHeadline": "",
  "isBasedOn": "https://www.w3.org/TR/2022/WD-wot-discovery-20220810/",
  "description": "The W3C Web of Things (WoT) is intended to enable\n           interoperability across IoT platforms and application\n           domains.  One key mechanism for accomplishing this goal\n           is the definition and use of metadata describing the\n           interactions an IoT device or service makes available\n           over the network at a suitable level of abstraction.  \n           The WoT Thing Description specification satisfies this objective.",
  "editor": [
    {
      "type": "Person",
      "name": "Andrea Cimmino",
      "worksFor": {
        "name": "Universidad Politécnica de Madrid",
        "url": "https://www.upm.es/"
      }
    },
    {
      "type": "Person",
      "name": "Michael McCool",
      "worksFor": {
        "name": "Intel Corp.",
        "url": "https://www.intel.com/"
      }
    },
    {
      "type": "Person",
      "name": "Farshid Tavakolizadeh",
      "worksFor": {
        "name": "Invited Expert"
      }
    },
    {
      "type": "Person",
      "name": "Kunihiko Toumura",
      "worksFor": {
        "name": "Hitachi, Ltd.",
        "url": "https://www.hitachi.com/"
      }
    }
  ],
  "contributor": [],
  "citation": [
    {
      "id": "https://www.w3.org/TR/wot-architecture11/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Architecture 1.1",
      "url": "https://www.w3.org/TR/wot-architecture11/",
      "creator": [
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Kunihiko Toumura"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-thing-description11/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Thing Description 1.1",
      "url": "https://www.w3.org/TR/wot-thing-description11/",
      "creator": [
        {
          "name": "Sebastian Käbisch"
        },
        {
          "name": "Takuki Kamiya"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Victor Charpenay"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/sparql11-overview/",
      "type": "TechArticle",
      "name": "SPARQL 1.1 Overview",
      "url": "https://www.w3.org/TR/sparql11-overview/",
      "creator": [
        {
          "name": "The W3C SPARQL Working Group"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://w3c.github.io/wot-usecases/",
      "type": "TechArticle",
      "name": "Web of Things (WoT): Use Cases",
      "url": "https://w3c.github.io/wot-usecases/",
      "creator": [
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Tomoaki Mizushima"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8615",
      "type": "TechArticle",
      "name": "Well-Known Uniform Resource Identifiers (URIs)",
      "url": "https://www.rfc-editor.org/rfc/rfc8615",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6763",
      "type": "TechArticle",
      "name": "DNS-Based Service Discovery",
      "url": "https://www.rfc-editor.org/rfc/rfc6763",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6762",
      "type": "TechArticle",
      "name": "Multicast DNS",
      "url": "https://www.rfc-editor.org/rfc/rfc6762",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7595",
      "type": "TechArticle",
      "name": "Guidelines and Registration Procedures for URI Schemes",
      "url": "https://www.rfc-editor.org/rfc/rfc7595",
      "creator": [
        {
          "name": "D. Thaler, Ed."
        },
        {
          "name": "T. Hansen"
        },
        {
          "name": "T. Hardie"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6690",
      "type": "TechArticle",
      "name": "Constrained RESTful Environments (CoRE) Link Format",
      "url": "https://www.rfc-editor.org/rfc/rfc6690",
      "creator": [
        {
          "name": "Z. Shelby"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9176",
      "type": "TechArticle",
      "name": "Constrained RESTful Environments (CoRE) Resource Directory",
      "url": "https://www.rfc-editor.org/rfc/rfc9176",
      "creator": [
        {
          "name": "C. Amsüss, Ed."
        },
        {
          "name": "Z. Shelby"
        },
        {
          "name": "M. Koster"
        },
        {
          "name": "C. Bormann"
        },
        {
          "name": "P. van der Stok"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/did-core/",
      "type": "TechArticle",
      "name": "Decentralized Identifiers (DIDs) v1.0",
      "url": "https://www.w3.org/TR/did-core/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Amy Guy"
        },
        {
          "name": "Markus Sabadello"
        },
        {
          "name": "Drummond Reed"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1",
      "url": "https://www.w3.org/TR/json-ld11/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Pierre-Antoine Champin"
        },
        {
          "name": "Dave Longley"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7959",
      "type": "TechArticle",
      "name": "Block-Wise Transfers in the Constrained Application Protocol (CoAP)",
      "url": "https://www.rfc-editor.org/rfc/rfc7959",
      "creator": [
        {
          "name": "C. Bormann"
        },
        {
          "name": "Z. Shelby, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc3339",
      "type": "TechArticle",
      "name": "Date and Time on the Internet: Timestamps",
      "url": "https://www.rfc-editor.org/rfc/rfc3339",
      "creator": [
        {
          "name": "G. Klyne"
        },
        {
          "name": "C. Newman"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc4122",
      "type": "TechArticle",
      "name": "A Universally Unique IDentifier (UUID) URN Namespace",
      "url": "https://www.rfc-editor.org/rfc/rfc4122",
      "creator": [
        {
          "name": "P. Leach"
        },
        {
          "name": "M. Mealling"
        },
        {
          "name": "R. Salz"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7807",
      "type": "TechArticle",
      "name": "Problem Details for HTTP APIs",
      "url": "https://www.rfc-editor.org/rfc/rfc7807",
      "creator": [
        {
          "name": "M. Nottingham"
        },
        {
          "name": "E. Wilde"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7231.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content",
      "url": "https://httpwg.org/specs/rfc7231.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc1738",
      "type": "TechArticle",
      "name": "Uniform Resource Locators (URL)",
      "url": "https://www.rfc-editor.org/rfc/rfc1738",
      "creator": [
        {
          "name": "T. Berners-Lee"
        },
        {
          "name": "L. Masinter"
        },
        {
          "name": "M. McCahill"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7396",
      "type": "TechArticle",
      "name": "JSON Merge Patch",
      "url": "https://www.rfc-editor.org/rfc/rfc7396",
      "creator": [
        {
          "name": "P. Hoffman"
        },
        {
          "name": "J. Snell"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc8288.html",
      "type": "TechArticle",
      "name": "Web Linking",
      "url": "https://httpwg.org/specs/rfc8288.html",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/eventsource/",
      "type": "TechArticle",
      "name": "Server-Sent Events",
      "url": "https://www.w3.org/TR/eventsource/",
      "creator": [
        {
          "name": "Ian Hickson"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/xpath-31/",
      "type": "TechArticle",
      "name": "XML Path Language (XPath) 3.1",
      "url": "https://www.w3.org/TR/xpath-31/",
      "creator": [
        {
          "name": "Jonathan Robie"
        },
        {
          "name": "Michael Dyck"
        },
        {
          "name": "Josh Spiegel"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://owasp.org/www-project-top-ten/",
      "type": "TechArticle",
      "name": "OWASP Top Ten",
      "url": "https://owasp.org/www-project-top-ten/",
      "publisher": {
        "name": "OWASP"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9175",
      "type": "TechArticle",
      "name": "Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing",
      "url": "https://www.rfc-editor.org/rfc/rfc9175",
      "creator": [
        {
          "name": "C. Amsüss"
        },
        {
          "name": "J. Preuß Mattsson"
        },
        {
          "name": "G. Selander"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9000",
      "type": "TechArticle",
      "name": "QUIC: A UDP-Based Multiplexed and Secure Transport",
      "url": "https://www.rfc-editor.org/rfc/rfc9000",
      "creator": [
        {
          "name": "J. Iyengar, Ed."
        },
        {
          "name": "M. Thomson, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc4279",
      "type": "TechArticle",
      "name": "Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)",
      "url": "https://www.rfc-editor.org/rfc/rfc4279",
      "creator": [
        {
          "name": "P. Eronen, Ed."
        },
        {
          "name": "H. Tschofenig, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://gdpr-info.eu/art-4-gdpr/",
      "type": "TechArticle",
      "name": "General Data Protection Regulation (GDPR) Article 4 - Definitions",
      "url": "https://gdpr-info.eu/art-4-gdpr/",
      "publisher": {
        "name": "European Union (EU) and the European Economic Area (EEA)"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8981",
      "type": "TechArticle",
      "name": "Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6",
      "url": "https://www.rfc-editor.org/rfc/rfc8981",
      "creator": [
        {
          "name": "F. Gont"
        },
        {
          "name": "S. Krishnan"
        },
        {
          "name": "T. Narten"
        },
        {
          "name": "R. Draves"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6335",
      "type": "TechArticle",
      "name": "Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry",
      "url": "https://www.rfc-editor.org/rfc/rfc6335",
      "creator": [
        {
          "name": "M. Cotton"
        },
        {
          "name": "L. Eggert"
        },
        {
          "name": "J. Touch"
        },
        {
          "name": "M. Westerlund"
        },
        {
          "name": "S. Cheshire"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://www.rfc-editor.org/rfc/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://www.rfc-editor.org/rfc/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "type": "TechArticle",
      "name": "RESTful Design for Internet of Things Systems",
      "url": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "creator": [
        {
          "name": "Ari Keranen"
        },
        {
          "name": "Matthias Kovatsch"
        },
        {
          "name": "Klaus Hartke"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/ldp-paging/",
      "type": "TechArticle",
      "name": "Linked Data Platform Paging 1.0",
      "url": "https://www.w3.org/TR/ldp-paging/",
      "creator": [
        {
          "name": "Steve Speicher"
        },
        {
          "name": "John Arwe"
        },
        {
          "name": "Ashok Malhotra"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "type": "TechArticle",
      "name": "JSONPath: Query expressions for JSON",
      "url": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "creator": [
        {
          "name": "Stefan Gössner"
        },
        {
          "name": "Glyn Normington"
        },
        {
          "name": "Carsten Bormann"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-security/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Security and Privacy Guidelines",
      "url": "https://www.w3.org/TR/wot-security/",
      "creator": [
        {
          "name": "Elena Reshetova"
        },
        {
          "name": "Michael McCool"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7230.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing",
      "url": "https://httpwg.org/specs/rfc7230.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7540.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol Version 2 (HTTP/2)",
      "url": "https://httpwg.org/specs/rfc7540.html",
      "creator": [
        {
          "name": "M. Belshe"
        },
        {
          "name": "R. Peon"
        },
        {
          "name": "M. Thomson, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8323",
      "type": "TechArticle",
      "name": "CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets",
      "url": "https://www.rfc-editor.org/rfc/rfc8323",
      "creator": [
        {
          "name": "C. Bormann"
        },
        {
          "name": "S. Lemay"
        },
        {
          "name": "H. Tschofenig"
        },
        {
          "name": "K. Hartke"
        },
        {
          "name": "B. Silverajan"
        },
        {
          "name": "B. Raymor, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    }
  ]
}</script>
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "lint": {
    "check-punctuation": true,
    "local-refs-exist": true,
    "no-http-props": true,
    "no-headingless-sections": true,
    "no-unused-dfns": false
  },
  "doJsonLd": true,
  "specStatus": "CR",
  "crEnd": "2023-01-11",
  "implementationReportURI": "https://w3c.github.io/wot-discovery/testing/report.html",
  "shortName": "wot-discovery",
  "copyrightStart": 2017,
  "group": "wg/wot",
  "wgPublicList": "public-wot-wg",
  "github": {
    "repoURL": "https://github.com/w3c/wot-discovery",
    "branch": "main"
  },
  "previousPublishDate": "2022-08-10",
  "previousMaturity": "FPWD",
  "editors": [
    {
      "name": "Andrea Cimmino",
      "w3cid": "115672",
      "company": "Universidad Politécnica de Madrid",
      "companyURL": "https://www.upm.es/"
    },
    {
      "name": "Michael McCool",
      "w3cid": "93137",
      "company": "Intel Corp.",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Farshid Tavakolizadeh",
      "w3cid": "122520",
      "company": "Invited Expert"
    },
    {
      "name": "Kunihiko Toumura",
      "w3cid": "83488",
      "company": "Hitachi, Ltd.",
      "companyURL": "https://www.hitachi.com/"
    }
  ],
  "formerEditors": [
    {
      "name": "Farshid Tavakolizadeh",
      "w3cid": "122520",
      "company": "Fraunhofer-Gesellschaft",
      "companyURL": "https://www.fraunhofer.de/",
      "retiredDate": "2021-09-30"
    }
  ],
  "otherLinks": [
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-discovery/graphs/contributors"
        }
      ]
    }
  ],
  "localBiblio": {
    "GDPR-Defs": {
      "title": "General Data Protection Regulation (GDPR) Article 4 - Definitions",
      "href": "https://gdpr-info.eu/art-4-gdpr/",
      "publisher": "European Union (EU) and the European Economic Area (EEA)",
      "id": "gdpr-defs"
    },
    "OWASP-Top-10": {
      "title": "OWASP Top Ten",
      "href": "https://owasp.org/www-project-top-ten/",
      "publisher": "OWASP",
      "id": "owasp-top-10"
    },
    "REST-IOT": {
      "title": "RESTful Design for Internet of Things Systems",
      "href": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "authors": [
        "Ari Keranen",
        "Matthias Kovatsch",
        "Klaus Hartke"
      ],
      "publisher": "IETF",
      "date": "11 May 2020",
      "id": "rest-iot"
    },
    "JSONPATH": {
      "title": "JSONPath: Query expressions for JSON",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "authors": [
        "Stefan Gössner",
        "Glyn Normington",
        "Carsten Bormann"
      ],
      "publisher": "IETF",
      "status": "DRAFT",
      "id": "jsonpath"
    },
    "wot-usecases": {
      "title": "Web of Things (WoT): Use Cases",
      "href": "https://w3c.github.io/wot-usecases/",
      "authors": [
        "Michael Lagally",
        "Michael McCool",
        "Ryuichi Matsukura",
        "Tomoaki Mizushima"
      ],
      "publisher": "W3C",
      "date": "15 October 2020",
      "status": "Editor's Draft",
      "id": "wot-usecases"
    }
  },
  "publishISODate": "2022-11-02T00:00:00.000Z",
  "generatedSubtitle": "W3C Candidate Recommendation Snapshot 02 November 2022"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-CR"></head>
<body class="h-entry toc-inline"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Web of Things (WoT) Discovery</h1> 
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#CR">W3C Candidate Recommendation Snapshot</a> <time class="dt-published" datetime="2022-11-02">02 November 2022</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2022/CR-wot-discovery-20221102/">https://www.w3.org/TR/2022/CR-wot-discovery-20221102/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/wot-discovery/">https://www.w3.org/TR/wot-discovery/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/wot-discovery/">https://w3c.github.io/wot-discovery/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/wot-discovery">https://www.w3.org/standards/history/wot-discovery</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/wot-discovery/commits/main">Commit history</a>
                  </dd>
        
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/wot-discovery/testing/report.html">https://w3c.github.io/wot-discovery/testing/report.html</a>
              </dd>
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="115672">
    <span class="p-name fn">Andrea Cimmino</span> (<a class="p-org org h-org" href="https://www.upm.es/">Universidad Politécnica de Madrid</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="93137">
    <span class="p-name fn">Michael McCool</span> (<a class="p-org org h-org" href="https://www.intel.com/">Intel Corp.</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="122520">
    <span class="p-name fn">Farshid Tavakolizadeh</span> (<span class="p-org org h-org">Invited Expert</span>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="83488">
    <span class="p-name fn">Kunihiko Toumura</span> (<a class="p-org org h-org" href="https://www.hitachi.com/">Hitachi, Ltd.</a>)
  </dd>
        <dt>
                Former editor:
              </dt><dd class="editor p-author h-card vcard" data-editor-id="122520">
    <span class="p-name fn">Farshid Tavakolizadeh</span> (<a class="p-org org h-org" href="https://www.fraunhofer.de/">Fraunhofer-Gesellschaft</a>) -  Until <time datetime="2021-09-30">30 September 2021</time>
  </dd>
        
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/wot-discovery/">GitHub w3c/wot-discovery</a>
        (<a href="https://github.com/w3c/wot-discovery/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/wot-discovery/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/wot-discovery/issues/">open issues</a>)
      </dd><dd><a href="mailto:public-wot-wg@w3.org?subject=%5Bwot-discovery%5D%20YOUR%20TOPIC%20HERE">public-wot-wg@w3.org</a> with subject line <kbd>[wot-discovery] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-wot-wg">archives</a>)</dd>
        
        <dt>Contributors</dt><dd>
    <a href="https://github.com/w3c/wot-discovery/graphs/contributors">In the GitHub repository</a>
  </dd>
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    ©
    2017-2022
    
    <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
    <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>,
    <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
        <p>The <abbr title="World Wide Web Consortium">W3C</abbr> Web of Things (WoT) is intended to enable
           interoperability across IoT platforms and application
           domains.  One key mechanism for accomplishing this goal
           is the definition and use of metadata describing the
           interactions an IoT device or service makes available
           over the network at a suitable level of abstraction.  
           The WoT Thing Description specification satisfies this objective.
        </p>
        <p>However, in order to use a Thing its Thing Description
           first has to be obtained.  The <em>WoT Discovery</em> process described 
           in this document addresses this problem.
           WoT Discovery needs to support the distribution of WoT Thing Descriptions
           in a variety of use cases.  This includes ad-hoc and engineered systems;
           during development and at runtime; and on both local and global networks.
           The process also needs to work with existing discovery mechanisms,
           be secure, protect private information, and be able to efficiently
           handle updates to WoT Thing Descriptions and the 
           dynamic and diverse nature of the IoT ecosystem.
        </p>
        <p>The WoT Discovery process is divided into two phases,
           Introduction, and Exploration.  The Introduction phase 
           leverages existing discovery mechanisms but does not directly
           expose metadata; they are simply used to discover Exploration
           services, which provide metadata but only after secure authentication
           and authorization.  This document normatively defines two Exploration
           services: for distributing a single WoT Thing Description from a regular
           web service, including as a special case self-description; 
           and a searchable WoT Thing Description Directory
           service for collections of Thing Descriptions.
           A variety of Introduction services are also described and where
           necessary normative definitions are given to support them.
        </p>
    </section>
    
    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
    <p>At the time of CR transition, due to insufficient implementation
    experience the following features and sections are at risk:</p>
    <ul>
    <li>DNS-SD support for UDP protocols, specifically support for 
    the <code>_wot._udp</code> service type.
<a href="#introduction-dns-sd-service-name-directory-udp">introduction-dns-sd-service-name-directory-udp</a> and
<a href="#introduction-dns-sd-service-name-udp">introduction-dns-sd-service-name-udp</a>.
    </li>
    <li>Mandatory use of RFC3339 format for date-time.</li>
<a href="#tdd-absolute-time">tdd-absolute-time</a>.
    
    <li>Mandatory rejection of query with <code>diff</code> parameter if
    <code>diff</code> is not supported.
<a href="#tdd-notification-data-diff-unsupported">tdd-notification-data-diff-unsupported</a>.
    </li>
    <li>Discoverer behavior when fetching additional results from 
    Exploration services and Thing Links, including tracking of
    already fetched results:
<a href="#discoverer-fetch-iteration">discoverer-fetch-iteration</a>,
<a href="#discoverer-fetch-links">discoverer-fetch-links</a>,
<a href="#discoverer-fetch-tdd">discoverer-fetch-tdd</a>, 
and
<a href="#discoverer-track">discoverer-track</a>.
    </li>
    <li>Security bootstrapping.
<a href="#exploration-secboot-401">exploration-secboot-401</a>,
<a href="#exploration-secboot-auth">exploration-secboot-auth</a>,
<a href="#exploration-secboot-oauth2-flows">exploration-secboot-oauth2-flows</a>, and
<a href="#security-bootstrapping-endpoints">security-bootstrapping-endpoints</a>.
    </li>
    <li>CoAP-based TD Server support.
<a href="#exploration-server-coap-size2">exploration-server-coap-size2</a>.
    </li>
    <li>Alternative content and language support.
<a href="#exploration-server-http-alternate-content">exploration-server-http-alternate-content</a>,
<a href="#exploration-server-http-alternate-language">exploration-server-http-alternate-language</a>,
<a href="#tdd-http-alternate-language">tdd-http-alternate-language</a>, 
<a href="#tdd-http-error-response-lang">tdd-http-error-response-lang</a>,
<a href="#tdd-http-representation-alternate-output">tdd-http-representation-alternate-output</a>, and
<a href="#tdd-validation-response-lang">tdd-validation-response-lang</a>.
    </li>
    <li>Support for CoRE-RD and CoRE Link Format.
<a href="#introduction-core-rd-resource-type-directory">introduction-core-rd-resource-type-directory</a>, and
    </li>
    <li>Sorting support during pagination.
<a href="#tdd-things-list-pagination-collection">tdd-things-list-pagination-collection</a>,
<a href="#tdd-things-list-pagination-order">tdd-things-list-pagination-order</a>,
<a href="#tdd-things-list-pagination-order-nextlink">tdd-things-list-pagination-order-nextlink</a>,
<a href="#tdd-things-list-pagination-order-utf-8">tdd-things-list-pagination-order-utf-8</a>, and
<a href="#tdd-things-list-pagination-orderable">tdd-things-list-pagination-orderable</a>.
    </li>
    <li>Others:
<a href="#exploration-link-description-link">exploration-link-description-link</a>,
<a href="#exploration-link-description-type">exploration-link-description-type</a>,
<a href="#introduction-direct-directory-description">introduction-direct-directory-description</a>, and
<a href="#tdd-registrationinfo-expiry-config">tdd-registrationinfo-expiry-config</a>.
    </li>
    </ul>
    <p>In addition, a number of assertions in the Privacy Considerations 
    and Security Considerations sections are at risk:
    </p>
<ul>
<li><a href="#priv-loc-anonymous-tds">priv-loc-anonymous-tds</a></li>
<li><a href="#priv-loc-disable-public-directories">priv-loc-disable-public-directories</a></li>
<li><a href="#priv-loc-explicit-care">priv-loc-explicit-care</a></li>
<li><a href="#priv-loc-explicit-strip">priv-loc-explicit-strip</a></li>
<li><a href="#priv-loc-gen-ids">priv-loc-gen-ids</a></li>
<li><a href="#priv-loc-priv-dir-access">priv-loc-priv-dir-access</a></li>
<li><a href="#priv-query-anon">priv-query-anon</a></li>
<li><a href="#sec-self-proxy">sec-self-proxy</a></li>
<li><a href="#sec-tdd-intro-if-multicast-required">sec-tdd-intro-if-multicast-required</a></li>
<li><a href="#sec-tdd-intro-limit-response-size">sec-tdd-intro-limit-response-size</a></li>
<li><a href="#sec-tdd-intro-no-multicast">sec-tdd-intro-no-multicast</a></li>
<li><a href="#sec-tdd-intro-no-observe">sec-tdd-intro-no-observe</a></li>
<li><a href="#sec-tdd-intro-throttling">sec-tdd-intro-throttling</a></li>
<li><a href="#sec-tdd-limit-query-complexity">sec-tdd-limit-query-complexity</a></li>
<li><a href="#sec-tdd-query-watchdog">sec-tdd-query-watchdog</a></li>
<li><a href="#sec-tdd-throttle-queries">sec-tdd-throttle-queries</a></li>
</ul>
    <p>
    These represent best
    practices but often relate to deployment policy rather than implementations
    and in some cases are difficult to validate.  The intention is to complete
    as many of these as possible by PR; those that cannot be validated but
    that represent best-practice recommendations will be converted into
    informative statements.</p>
    <p class="at-risk">At-risk assertions are marked with yellow highlighting.</p>
    <p>
    The Web of Things Working Group intends to submit this document for
    consideration as a <abbr title="World Wide Web Consortium">W3C</abbr> Proposed Recommendation after at least the
    minimum CR review period has passed.
    However, before PR transition is requested,
    any features or assertions currently marked as at-risk that do not
    have at least two implementations at that time will either be
    removed or converted into informative statements, as appropriate.
    </p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/wot">Web of Things Working Group</a> as
    a Candidate Recommendation Snapshot using the
        <a href="https://www.w3.org/2021/Process-20211102/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a Candidate Recommendation does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. A Candidate Recommendation Snapshot has received
        <a href="https://www.w3.org/2021/Process-20211102/#dfn-wide-review">wide review</a>, is intended to
        gather
        <a href="https://w3c.github.io/wot-discovery/testing/report.html">implementation experience</a>,
        and has commitments from Working Group members to
        <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Requirements">royalty-free licensing</a>
        for implementations.</p><p>
          This Candidate Recommendation is not expected to advance to Proposed
          Recommendation any earlier than 11 January 2023.
        </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/Consortium/Patent-Policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/wot/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                  This document is governed by the
                  <a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">2 November 2021 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">2. </bdi>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">3. </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#architecture"><bdi class="secno">4. </bdi>Architecture</a></li><li class="tocline"><a class="tocxref" href="#discoverer-process"><bdi class="secno">5. </bdi>Discoverer Process</a></li><li class="tocline"><a class="tocxref" href="#introduction-mech"><bdi class="secno">6. </bdi>Introduction Mechanisms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#introduction-direct"><bdi class="secno">6.1 </bdi>Direct</a></li><li class="tocline"><a class="tocxref" href="#introduction-well-known"><bdi class="secno">6.2 </bdi>Well-Known URIs</a></li><li class="tocline"><a class="tocxref" href="#introduction-dns-sd-sec"><bdi class="secno">6.3 </bdi>DNS-Based Service Discovery</a></li><li class="tocline"><a class="tocxref" href="#introduction-core-rd-sec"><bdi class="secno">6.4 </bdi>CoRE Link Format and CoRE Resource Directory</a></li><li class="tocline"><a class="tocxref" href="#introduction-did-sec"><bdi class="secno">6.5 </bdi>DID Documents</a></li></ol></li><li class="tocline"><a class="tocxref" href="#exploration-mech"><bdi class="secno">7. </bdi>Exploration Mechanisms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-overview"><bdi class="secno">7.1 </bdi>Overview</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-ontology"><bdi class="secno">7.1.1 </bdi>Ontology</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-td-type-thingdirectory"><bdi class="secno">7.1.1.1 </bdi><code>ThingDirectory</code></a></li><li class="tocline"><a class="tocxref" href="#exploration-td-type-thinglink"><bdi class="secno">7.1.1.2 </bdi><code>ThingLink</code></a></li></ol></li><li class="tocline"><a class="tocxref" href="#exploration-secboot"><bdi class="secno">7.1.2 </bdi>Security Bootstrapping</a></li></ol></li><li class="tocline"><a class="tocxref" href="#exploration-server"><bdi class="secno">7.2 </bdi>Thing Description Server</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory"><bdi class="secno">7.3 </bdi>Thing Description Directory</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-directory-info"><bdi class="secno">7.3.1 </bdi>Information Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-directory-registration-info"><bdi class="secno">7.3.1.1 </bdi>Registration Information</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-registration-expiry"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-anonymous-td"><bdi class="secno">7.3.1.3 </bdi>Anonymous TD Identifiers</a></li></ol></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api"><bdi class="secno">7.3.2 </bdi>Directory Service API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things"><bdi class="secno">7.3.2.1 </bdi>Things API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-creation"><bdi class="secno">7.3.2.1.1 </bdi>Creation</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-retrieval"><bdi class="secno">7.3.2.1.2 </bdi>Retrieval</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-update"><bdi class="secno">7.3.2.1.3 </bdi>Update</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-deletion"><bdi class="secno">7.3.2.1.4 </bdi>Deletion</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-listing"><bdi class="secno">7.3.2.1.5 </bdi>Listing</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-things-validation"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a></li></ol></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-notification"><bdi class="secno">7.3.2.2 </bdi>Events API</a></li><li class="tocline"><a class="tocxref" href="#exploration-directory-api-search"><bdi class="secno">7.3.2.3 </bdi>Search API</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#jsonpath-semantic"><bdi class="secno">7.3.2.3.1 </bdi>Syntactic search: JSONPath</a></li><li class="tocline"><a class="tocxref" href="#xpath-semantic"><bdi class="secno">7.3.2.3.2 </bdi>Syntactic search: XPath</a></li><li class="tocline"><a class="tocxref" href="#search-semantic"><bdi class="secno">7.3.2.3.3 </bdi>Semantic search: SPARQL</a></li></ol></li><li class="tocline"><a class="tocxref" href="#directory-api-spec"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">8. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#security-consideration-dos"><bdi class="secno">8.1 </bdi>Denial of Service</a></li><li class="tocline"><a class="tocxref" href="#security-consideration-amp-ddos"><bdi class="secno">8.2 </bdi>Amplification and Distributed Denial of Service</a></li><li class="tocline"><a class="tocxref" href="#security-consideration-lan-self-discovery"><bdi class="secno">8.3 </bdi>Self-Discovery on LANs</a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">9. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#privacy-consideration-location-tracking"><bdi class="secno">9.1 </bdi>Location Tracking and Profiling</a></li><li class="tocline"><a class="tocxref" href="#privacy-consideration-query-tracking"><bdi class="secno">9.2 </bdi>Query Tracking</a></li></ol></li><li class="tocline"><a class="tocxref" href="#performance-considerations"><bdi class="secno">10. </bdi>Performance Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#perf-incremental-transfer"><bdi class="secno">10.1 </bdi>Incremental Transfer</a></li></ol></li><li class="tocline"><a class="tocxref" href="#iana-considerations"><bdi class="secno">11. </bdi>IANA Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#well-known-uri-suffix"><bdi class="secno">11.1 </bdi>Well-Known URI Registration</a></li><li class="tocline"><a class="tocxref" href="#service-name"><bdi class="secno">11.2 </bdi>Service Name Registration</a></li><li class="tocline"><a class="tocxref" href="#core-resource-type"><bdi class="secno">11.3 </bdi>CoRE Resource Types Registration</a></li></ol></li><li class="tocline"><a class="tocxref" href="#other-name-considerations"><bdi class="secno">12. </bdi>Other Name Registration Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#did-service-name"><bdi class="secno">12.1 </bdi>DID Service Name Registration</a></li></ol></li><li class="tocline"><a class="tocxref" href="#tdd-extensions-jsonschema"><bdi class="secno">A. </bdi>JSON Schema for WoT Discovery TD-extensions</a></li><li class="tocline"><a class="tocxref" href="#changes"><bdi class="secno">B. </bdi>Recent Specification Changes</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#changes-from-third-draft"><bdi class="secno">B.1 </bdi>Changes from 10 August 2022 Working Draft</a></li><li class="tocline"><a class="tocxref" href="#changes-from-second-draft"><bdi class="secno">B.2 </bdi>Changes from 2 June 2021 Working Draft</a></li><li class="tocline"><a class="tocxref" href="#changes-from-first-draft"><bdi class="secno">B.3 </bdi>Changes from 24 November 2020 First Public Working Draft</a></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">C. </bdi>Acknowledgments</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">D. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">D.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">D.2 </bdi>Informative references</a></li></ol></li></ol></nav>
    <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
        
        <p>The Web of Things (WoT) defines an architecture that supports the integration
           and use of web technologies with IoT devices.
           The WoT Architecture [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>] document defines the basic
           concepts and patterns of usage supported.
           However, the WoT Thing Description [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>] is a key
           specification for WoT Discovery since it is the purpose of WoT Discovery
           to make WoT Thing Descriptions available.
           Specifically, WoT Discovery has to allow authenticated and authorized entities
           (and only those entities) to find WoT Thing Descriptions satisfying a set of
           criteria, such as 
          
           having certain semantics,
           or containing certain interactions.  Conversely, in order to support
           security and privacy objectives, the WoT Discovery process must not
           leak information to unauthorized entities.  This includes leaking information
           that a given entity is requesting certain information, not just the information
           distributed in the Thing Descriptions themselves.
	    </p>
        <p>There are already a number of discovery mechanisms defined, so we have to 
           establish why we are proposing a new one.  First, many existing 
           discovery mechanisms have relatively weak security and privacy protections.
           One of our objectives is to establish a mechanism that not only uses best
           practices to protect metadata, but that can be upgraded to support future
           best practices as needed.
           Second, we are using discovery in a broad sense to include both local and
           non-local mechanisms.  While a local mechanism might use a broadcast protocol,
           non-local mechanisms might go beyond the current network segment where broadcast
           is not scalable, and so a different approach, such as a search service, is needed. 
           Our approach is to use existing mechanisms as needed to bootstrap into a more 
           general and secure metadata distribution system.
           Third, the metadata we are distributing, the WoT Thing Description, is highly
           structured and includes rich data such as data schemas and semantic annotations.
           Existing discovery mechanisms based on a list of simple key-value pairs are 
           not appropriate.  
           At the same time, 
           use of existing standards for semantic data query, 
           such as SPARQL [<cite><a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title="SPARQL 1.1 Overview">SPARQL11-OVERVIEW</a></cite>], 
           while potentially suitable for some advanced use cases, 
           might require too much effort for many anticipated IoT applications.
           Therefore in order to address more basic applications,
           we also define some simpler query mechanisms. 
        </p>
        <p>After defining some basic terminology, we will summarize the basic use cases and
           requirements for WoT Discovery.  These are a subset of the more detailed and
           exhaustive use cases and requirements presented in the WoT Use Cases [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-usecases" title="Web of Things (WoT): Use Cases">wot-usecases</a></cite>] and 
           WoT Architecture [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>] documents.
           Then we will describe the basic architecture of the WoT Discovery process,
           which uses a two-phase Introduction/Exploration approach.  The basic goal of this
           architecture is to be able to use existing discovery standards to bootstrap
           access to protected discovery services, but to distribute detailed metadata only to 
           authorized users, and to also protect those making queries from eavesdroppers 
           as much as possible.
           We then describe details of specific Introduction and Exploration mechanisms.
           In particular, we define in detail a normative API for a 
           WoT Thing Description Directory (WoT TDD) service that provides a search mechanism for
           collections of WoT Thing Descriptions that can be dynamically registered by Things or
           entities acting on their behalf.  The WoT Discovery mechanism however also supports
           distribution of single TDs from regular web services, with a special case of this 
           being self-description.
           Finally, we discuss some security and privacy considerations, including a set of 
           potential risks and mitigations.
        </p>
    </section>
    
    <section id="conformance"><div class="header-wrapper"><h2 id="x2-conformance"><bdi class="secno">2. </bdi>Conformance</h2><a class="self-link" href="#conformance" aria-label="Permalink for Section 2."></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">OPTIONAL</em>, <em class="rfc2119">RECOMMENDED</em>, <em class="rfc2119">SHOULD</em>, and <em class="rfc2119">SHOULD NOT</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p></section>
    <section id="terminology" class="informative"><div class="header-wrapper"><h2 id="x3-terminology"><bdi class="secno">3. </bdi>Terminology</h2><a class="self-link" href="#terminology" aria-label="Permalink for Section 3."></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
            The fundamental WoT terminology such as
            <dfn id="dfn-thing" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Thing</dfn>,
            <dfn data-plurals="thing descriptions" id="dfn-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Thing Description</dfn> (<dfn data-plurals="tds" id="dfn-td" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">TD</dfn>),
            <dfn id="dfn-thing-model" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Thing Model</dfn> (<dfn id="dfn-tm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">TM</dfn>),
            <dfn id="dfn-property" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Property</dfn>,
            <dfn id="dfn-action" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Action</dfn>,
            <dfn id="dfn-event" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Event</dfn>,
            <dfn data-lt="WoT Anonymous Thing Description|Anonymous TD" data-plurals="anonymous tds" id="dfn-wot-anonymous-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Anonymous TD</dfn>,
            <dfn data-lt="WoT Discoverer|Discoverer" id="dfn-wot-discoverer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Discoverer</dfn>,
            <dfn data-lt="WoT Discovery|Discovery" id="dfn-wot-discovery" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Discovery</dfn>,
            <dfn data-lt="WoT Exploration|Exploration" id="dfn-wot-exploration" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Exploration</dfn>,
            <dfn data-lt="WoT Introduction|Introduction" id="dfn-wot-introduction" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Introduction</dfn>,
            <dfn data-lt="WoT Thing Description Server|Thing Description Server" id="dfn-wot-thing-description-server" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Thing Description Server</dfn>
            (<dfn data-lt="WoT TD Server|TD Server" data-plurals="td servers" id="dfn-wot-td-server" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">TD Server</dfn>),
            <dfn data-lt="WoT Thing Description Directory|Thing Description Directory" data-plurals="thing description directories" id="dfn-wot-thing-description-directory" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Thing Description Directory</dfn>
            (<dfn data-lt="WoT TDD|TDD" id="dfn-wot-tdd" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">TDD</dfn>),
            <dfn data-lt="WoT Partial Thing Description|Partial TD" id="dfn-wot-partial-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Partial TD</dfn>,
            <dfn data-lt="WoT Enriched Thing Description|Enriched TD" data-plurals="enriched tds" id="dfn-wot-enriched-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Enriched TD</dfn>
            are defined in <a href="https://www.w3.org/TR/wot-architecture11/#terminology">Section 3</a>
            of the WoT Architecture 1.1 specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>].
        </p>
    </section>
    <section id="architecture" class="informative"><div class="header-wrapper"><h2 id="x4-architecture"><bdi class="secno">4. </bdi>Architecture</h2><a class="self-link" href="#architecture" aria-label="Permalink for Section 4."></a></div><p><em>This section is non-normative.</em></p>
        
        <p>
        <a href="#discovery-overview" class="fig-ref" title="Discovery architecture overview. A set of open Introduction mechanisms provides a set of URLs, which point at Exploration services that only provide metadata (TDs) after suitable authentication. Thing Links and Thing Description Directories provide additional flexibility but retrieving further results from these is at the discretion of the application.">Figure <bdi class="figno">1</bdi></a> shows an overview of the WoT Discovery process.
	      Discovery uses a two-phase architecture to resolve the competing requirements to be
        both open and to restrict access to metadata to authorized entities.
	      In the first phase, one or more of a set of relatively open
        "Introduction" mechanisms may be used to generate a set of candidate URLs.  
        These URLs do not themselves contain metadata,
	      but are used in the second stage to reference "Exploration"
        services that can actually provide metadata, after authentication,
        in the form of <a href="#dfn-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-description-1">Thing Descriptions</a>.
       </p>
        <figure id="discovery-overview">
            <img src="images/overview.png" srcset="images/overview.svg" class="wot-diagram" alt="Discovery process overview">
            <figcaption>Figure <bdi class="figno">1</bdi> <span class="fig-title">Discovery architecture overview.  
              A set of open Introduction mechanisms provides a set of URLs, which
              point at Exploration services that only provide metadata (TDs) after suitable
              authentication.  Thing Links and Thing Description Directories provide
              additional flexibility but retrieving further results from these is
              at the discretion of the application.
            </span></figcaption>
        </figure>
        <p>
	       The intention is that Introduction mechanisms are relatively open "first contact"
         mechanisms to provide a starting point for the rest of the Discovery process.
         In this document we specify details on several Introduction
         mechanisms, suitable for different use cases, including both local and non-local
         scenarios, but Introductions can in fact be provided by any mechanism that can return a URL.
	       Introductions, however, do not include any security or privacy controls and
	       so should not provide metadata directly. 
         Instead, the URLs provided by Introduction mechanisms reference
	       "Exploration" services.  Exploration services actually do provide metadata,
         but only after suitable authentication and access controls have been applied.
        </p>
	      <p>
	       The Discovery process can produce a <em>set</em> of URLs as output from
	       its Introduction phase, even if only one Introduction mechanism is used
         (some Introduction mechanisms can themselves return multiple URLs).
	       The final output after the Exploration phase
	       can also be a <em>set</em> of Thing Descriptions.
        </p>
        <p>
	       Each URL provided by the Introduction phase always points at an 
         Exploration service endpoint that will return a single Thing Description.
	       In the simplest case this URL references an ordinary resource
         provided by a web server which provides the Thing Description of a Thing 
	       describing an IoT endpoint device.  
         As a special case of this, for self-describing Things an Introduction URL might
	       point directly at an endpoint provided by a 
         Thing serving its own Thing Description.
        </p>
        <p>
	       In general Thing Descriptions might be provided in various ways and
         in particular may not be self-describing.
         For example, 
        </p>
         <ul>
         <li>brownfield devices not designed with the WoT 
             specification in mind will not be capable of serving their
             own Thing Descriptions; 
         </li>
         <li>battery-powered devices may not be online
             most of the time; and 
         </li>
         <li>some devices may not be powerful enough to manage and 
             serve TDs directly.  
         </li>
         </ul>
        <p>
         The Thing Description for such Things should be provided
         by separate services.
        </p>
        <p>
	       This document specifies two special cases that allow for more flexibility:
	      </p>
	      <ul>
	        <li>A Thing Description referenced by an Introduction URL 
            may describe a <a href="#exploration-td-type-thingdirectory">Thing Description Directory</a> service.  
	          A Thing Description Directory service (which is still a Thing) 
            maintains a (possibly dynamic) database of Thing Descriptions.
            Thing Description Directories that maintain large numbers of 
            Thing Descriptions may also support queries that can be used to 
            selectively retrieve Thing Descriptions.
	        </li>
	        <li>
            The second special case is a 
            <a href="#exploration-td-type-thinglink">Thing Link</a>.  
            A Thing Link is also a Thing Description,
            but rather than describing a Thing directly, it holds a link to
            a Thing Description hosted elsewhere.
	          A Thing Description Directory can also store Thing Links
	          which can redirect to other Thing Description Directories, 
            allowing for a linked directory structure.
	        </li>
	      </ul>
        <p>
         It is <em>not</em> mandatory for the Discovery process to retrieve
         the contents of Thing Description Directories and return them as 
         part of the results, 
         because in general this might result in a huge set of results.  
         Instead the application
         should scan the results for Thing Description Directory TDs and
         decide whether to retrieve TDs from them, possibly selectively.
         Likewise, it is not required to follow Thing Links automatically;
         instead the application may choose to follow them selectively.
        </p>
    </section>
    <section id="discoverer-process" class="normative"><div class="header-wrapper"><h2 id="x5-discoverer-process"><bdi class="secno">5. </bdi>Discoverer Process</h2><a class="self-link" href="#discoverer-process" aria-label="Permalink for Section 5."></a></div>
        
	<p>In this section we will describe the WoT Discovery process from the point of view of a client,
	and what it means to say that a client supports WoT Discovery.
	We will use the term <a href="#dfn-wot-discoverer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-discoverer-1">Discoverer</a> for an entity that is a client of the WoT Discovery
	process.  
	A Discoverer may or may not be a full Consumer.
	A Discoverer does however need to read and extract information from special TDs for Directories 
	and Thing Links and use specific affordances and links provided in them.  
	Conversely, a Consumer may not support Discovery, although it is recommended
	[<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>].
</p>
<p>
	The WoT Discovery process is designed so that nearly any client that can fetch a single TD 
	given a single URI can be said to support WoT Discovery. 
	Of course, Discoverers may support more powerful Discovery mechanisms, but some of these 
	have additional requirements.  

	Some Introduction mechanisms can return multiple URLs, 
	each of which can in turn be used to fetch at least one TD.
	So even without a TDD, it is possible to discover multiple TDs.

	</p>
	<p>
	The following assertions describe the specific responsibilities of a Discoverer:
	</p>
	<ul>
		<li><span class="rfc2119-assertion" id="discoverer-must-support-intros">
			A Discoverer <em class="rfc2119">MUST</em> support at least one Introduction mechanism.</span>
			The simplest Introduction mechanism, Direct, simply provides a single URL of a target TD.  
			This assertion results in different minimal requirements depending on
			which Introduction mechanism is selected out of the several available.
			For example, when Direct is used as the sole Introduction mechanism,
			at a minimum a Discoverer must be able to accept a single URL pointing at a TD.
			Note, however, that this TD could still be describing a Directory.
			Another option would be for a Discoverer to implement, as its sole 
			Introduction mechanism, an "automatic" Introduction mechanism such as 
			DNS-SD, possibly in combination with mDNS. 
			In this case the application 
			code running in the Discoverer
			would not have to supply any additional information to invoke Discovery.
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-must-support-fetching">
			A Discoverer <em class="rfc2119">MUST</em> support fetching a TD from at least one URL provided as part of the Introduction process.</span>
			In other words, not only must a Discoverer accept URLs pointing at TDs, it must be
			able to fetch that TD, for example by using a GET for an HTTP URL.
			It is permissible to split the implementation of a Discoverer into two components, one that
			fetches/reads a TD and sets up a configuration during installation to be used by a
			run-time component that cannot itself read TDs.
			In this case, however, the latter component is not by itself a Discoverer.
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-may-multiple-intro">
			A Discoverer <em class="rfc2119">MAY</em> support multiple invocations of the same Introduction mechanism.</span>
			If multiple invocations of a single Introduction mechanism is supported, 
			or if multiple Introduction mechanisms are used, then the Discoverer needs to
			manage a set of Introduction results.  
			Some Introduction mechanisms themselves return a set of results, e.g. CoRE-RD, DID, or DNS-SD. 
			Some mechanisms, such as scanning Bluetooth beacons, may intrinsically result in separate multiple "invocations".
			However, this Discoverer requirement is optional to support an important special case: 
			it is permissible to have a simple
			Discoverer that only supports a single invocation of a Direct Introduction, 
			directly specifying a single TD via a URL.
                </li>
		<li><span class="rfc2119-assertion" id="discoverer-merge-intros">
			A Discoverer <em class="rfc2119">MUST</em> be able to merge URLs resulting from 
			multiple Introduction mechanisms, multiple results from a single Introduction mechanism,
			and multiple Introduction invocations into a single set.</span>
			Note that even if only one Introduction mechanism is supported multiple results might be 
			produced.  
			This assertion states that the overall output of the Introduction phase is
			a single set of URLs.  
			The word "set" is used here in the mathematical sense: the results are unordered and unique.
                        Uniqueness means that if multiple Introductions have the same result, they are merged into
			a single result.
			If the Discoverer only supports one Introduction mechanism and that mechanism
			can only produce one URL, then the "merge" is trivial.
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-td-identify">
			A Discoverer <em class="rfc2119">MUST</em> be able to identify whether a TD fetched from an 
			Introduction URL has <a href="#exploration-td-type-thingdirectory">Thing Directory</a>
            or <a href="#exploration-td-type-thingdirectory">Thing Link</a> type.</span>
			This implies that the Discoverer needs to be able
			to check the <code>@type</code> field and make this distinction.

                        A Discoverer can decide whether or not to follow links or fetch TDD contents.
	                There are some use cases where a Consumer may not expand certain URLs, for example links pointing
	                at external resources, or when a TDD contains many TDs and fetching them all
	                would exceed the Consumer's memory processing capabilities.
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-fetch-tdd">
			A Discoverer <em class="rfc2119">MAY</em> fetch additional TDs from any Exploration mechanism
			described in its initial set of TDs (including, in particular, Thing Description Directories) 
			and add them into the set of TD results.</span>
			This only adds the results of fetching TDs from an Exploration mechanism to the set of
			results. These new results do not delete the original TD describing the Exploration mechanism. 
                        A Discoverer implementation can decide whether or not to fetch TDD contents.
                        Implementers should consider the fact that TDDs may be large and fetching the contents of an entire TDD
			might be prohibitively expensive.  
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-fetch-links">
			A Discoverer <em class="rfc2119">MAY</em> fetch source TDs from the targets of the links in a <a href="#exploration-td-type-thingdirectory">Thing Link</a>
			described in its initial set of TDs and add them into the set of TD results.</span>
			This only adds the results of fetching TDs from a Thing Link to the set of
			results. These new results do not delete the original TD describing the Thing Link. 
			A Discoverer implementation can decide whether or not to fetch the targets of Thing Links.
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-fetch-iteration">
			A Discoverer <em class="rfc2119">MAY</em> fetch additional TDs iteratively from any <a href="#exploration-td-type-thingdirectory">Thing Link</a> or
			Exploration mechanism described in its set of TDs and add them into the set of TD results.</span>
			This only adds the results of fetching TDs from an Exploration mechanism to the set of
			results. These new results do not delete the original TD describing the Exploration mechanism. 
		</li>
		<li><span class="rfc2119-assertion" id="discoverer-termination">
			A Discoverer <em class="rfc2119">MAY</em> terminate fetching additional TDs at any point or for
			any reason.</span>
	        </li>
		<li><span class="rfc2119-assertion" id="discoverer-any-order">
			A Discoverer <em class="rfc2119">MAY</em> fetch additional TDs by following links or fetching
			additional TDs from Exploration mechanisms (e.g. TDDs) in any order.</span>
			The Discoverer can fetch additional TDs in any order from any Exploration mechanism and is not
			required to use all of them.
	        </li>
		<li><span class="rfc2119-assertion" id="discoverer-track">
			A Discoverer <em class="rfc2119">MUST</em> track which TDs describing links or Exploration mechanisms
			have already been fetched and avoid fetching duplicate results.</span>
			This is to avoid infinite loops.  Note that Thing Description Directories can easily refer to each other,
			for example, so fetching the TDs from a TDD, then fetching all those TDs will give another copy of the
			original TDD's TD.  This second copy should NOT trigger further fetches. 
			Note that tracking cannot depend only on the value of "id" fields in TDs since this
			field is optional. 
		</li>
        </ul>
	<p>
	The above process supports a way to let Directories reference other Directories without duplicating their TDs: 
	a Directory wanting to reference other Directories should include a <a href="#exploration-td-type-thingdirectory">Thing Link</a> with a "describedby" relation to the
	TD of the other Directory service.  Then the above process would expand the Thing Link to obtain the actual TD of the Directory, 
	and then (optionally) use the appropriate Directory affordance to access the contents of the linked Directory.
	Note that such a Thing Link points at the TD of the Directory, not at the Directory itself.  These
	may or may not be hosted in the same location.
	</p><p>
        Recursively fetching the contents of such linked directories, especially without a specific
	query or filter, could easily result in downloading a large amount of data.  Such recursive expansion should be limited to use
	cases that require it, such as inventory, auditing, or indexing.  
        </p><p>
	URLs for Directory services can also be
	used with the federation capabilities of SPARQL queries, noted below, which in most cases will be a more efficient way
	to collect specific information from a set of distributed directory services.
	However, SPARQL requires the URL of a SPARQL endpoint for such federation, which can be found in the TDs
	of Directories supporting SPARQL queries.  This is not the same as the URL pointing at the TD of a Directory.
	</p>
    <p></p>
    </section>
    <section id="introduction-mech" class="normative"><div class="header-wrapper"><h2 id="x6-introduction-mechanisms"><bdi class="secno">6. </bdi>Introduction Mechanisms</h2><a class="self-link" href="#introduction-mech" aria-label="Permalink for Section 6."></a></div>
        
        <p>This chapter describes mechanisms for initial contact with
           Things or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-1">Thing Description Directories</a>.
           Any of the following mechanisms may 
           be provided by the Thing or the <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-2">Thing Description Directory</a> to Consumers.
           The result of an introduction mechanism is always a URL (address) of an exploration service
           which can be used to obtain detailed metadata (TDs) after suitable authentication.
           It is also possible for multiple introduction mechanisms to be used and the results merged.
           No particular introduction mechanism is mandatory, as long as the URL of at least one
           exploration service is somehow obtained.
        </p>

        <section id="introduction-direct" class="normative"><div class="header-wrapper"><h3 id="x6-1-direct"><bdi class="secno">6.1 </bdi>Direct</h3><a class="self-link" href="#introduction-direct" aria-label="Permalink for Section 6.1"></a></div>
            
            <p><span class="rfc2119-assertion" id="introduction-direct-url">To obtain an URL of an exploration service, any mechanism that results in a single URL <em class="rfc2119">MAY</em> be used.</span>
               This includes Bluetooth beacons, QR codes, and written URLs to be 
               typed by a user.
                <span class="rfc2119-assertion" id="introduction-direct-thing-description">
                    A request on all such URLs <em class="rfc2119">MUST</em> result in a TD as prescribed in
                    <a href="#exploration-mech" data-matched-text="[[[#exploration-mech]]]" class="sec-ref"><bdi class="secno">7. </bdi>Exploration Mechanisms</a>.</span>
                For self-describing Things, this can be the TD of the Thing itself.
                <span class="rfc2119-assertion" id="introduction-direct-directory-description">
                   If the URL references a <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-3">Thing Description Directory</a>, this <em class="rfc2119">MUST</em> be the Thing Description of the
                    <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-4">Thing Description Directory</a>.</span>
            </p>
        </section>
        <section id="introduction-well-known" class="normative"><div class="header-wrapper"><h3 id="x6-2-well-known-uris"><bdi class="secno">6.2 </bdi>Well-Known URIs</h3><a class="self-link" href="#introduction-well-known" aria-label="Permalink for Section 6.2"></a></div>
            
            <p>
                <span class="rfc2119-assertion" id="introduction-well-known-uri">A Thing or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-5">Thing Description Directory</a> <em class="rfc2119">MAY</em> use the Well-Known Uniform Resource Identifier [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title="Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>]
                to advertise its presence.</span>
                <span class="rfc2119-assertion" id="introduction-well-known-path">If a Thing or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-6">Thing Description Directory</a> use the Well-Known Uniform Resource Identifier [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title="Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>] to advertise its presence, it <em class="rfc2119">MUST</em> register its own Thing Description
                into the following path:
                <code>/.well-known/wot</code>.</span>
            </p><p>
                <span class="rfc2119-assertion" id="introduction-well-known-thing-description">
                    When a request is made at the above Well-Known URI, the server <em class="rfc2119">MUST</em> return
                    a Thing Description as prescribed in <a href="#exploration-mech" data-matched-text="[[[#exploration-mech]]]" class="sec-ref"><bdi class="secno">7. </bdi>Exploration Mechanisms</a>.</span>
            </p>

        </section>
        <section id="introduction-dns-sd-sec" class="normative"><div class="header-wrapper"><h3 id="x6-3-dns-based-service-discovery"><bdi class="secno">6.3 </bdi>DNS-Based Service Discovery</h3><a class="self-link" href="#introduction-dns-sd-sec" aria-label="Permalink for Section 6.3"></a></div>
            
            <p class="at-risk">The DNS-SD mechanism for 
            UDP discovery described in this section is at risk.</p>
            <div class="note" id="issue-container-generatedID"><div role="heading" class="ednote-title marker" id="h-ednote" aria-level="4"><span>Editor's note</span></div><p class="">The DNS-SD service names are still subject to IANA approval.  If necessary they may have to be
            changed prior to PR if IANA requires different names.</p></div>
            <p><span class="rfc2119-assertion" id="introduction-dns-sd">A Thing or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-7">Thing Description Directory</a> <em class="rfc2119">MAY</em> use DNS-Based Service Discovery (DNS-SD)[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6763" title="DNS-Based Service Discovery">RFC6763</a></cite>].</span>
                This can be also be used on the same local network in combination with Multicast DNS (mDNS)[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6762" title="Multicast DNS">RFC6762</a></cite>].
            </p>
            <p>
                The following table lists the service names and protocols for advertising their presense.
                </p><table class="def">
                    <thead>
                        <tr>
                            <th>Service name</th>
                            <th>Thing or TDD</th>
                            <th>Protocol</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="rfc2119-table-assertion" id="introduction-dns-sd-service-name">
                            <td><code>_wot._tcp</code></td>
                            <td>Thing</td>
                            <td>HTTP over TCP, HTTP over TLS/TCP, CoAP over TCP, or CoAP over TLS/TCP</td>
                        </tr>
                        <tr class="rfc2119-table-assertion" id="introduction-dns-sd-service-name-directory">
                            <td><code>_directory._sub._wot._tcp</code></td>
                            <td>TDD</td>
                            <td>HTTP over TCP, HTTP over TLS/TCP, CoAP over TCP, or CoAP over TLS/TCP</td>
                        </tr>
                        <tr class="rfc2119-table-assertion" id="introduction-dns-sd-service-name-udp">
                            <td><code>_wot._udp</code></td>
                            <td>Thing</td>
                            <td>CoAP over UDP or CoAP over DTLS/UDP</td>
                        </tr>
                        <tr class="rfc2119-table-assertion" id="introduction-dns-sd-service-name-directory-udp">
                            <td><code>_directory._sub._wot._udp</code></td>
                            <td>TDD</td>
                            <td>CoAP over UDP or CoAP over DTLS/UDP</td>
                        </tr>
                    </tbody>

                </table>
            <p></p>
                <div class="rfc2119-assertion" id="introduction-dns-sd-txt-record">
                    <p>
                    In addition, the following information <em class="rfc2119">MUST</em> be included in the <code>TXT</code>
                    record that is pointed to by the Service Instance Name:
                    </p>
                    <dl>
                        <dt><code>td</code></dt>
                        <dd>Absolute pathname of the Thing Description of the Thing or Thing Description of the <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-8">Thing Description Directory</a>.</dd>
                        <dt><code>type</code></dt>
                        <dd>Type of the Thing Description, i.e. <code>Thing</code> or <code>Directory</code>.
                        If omitted, the type is assumed to be <code>Thing</code>.</dd>
                        <dt><code>scheme</code></dt>
                        <dd>Scheme part of URL.  One of the following values can be specified, with the standard registered URI interpretations [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7595" title="Guidelines and Registration Procedures for URI Schemes">RFC7595</a></cite>]: <code>http</code> (HTTP over TCP),<code>https</code> (HTTP over TLS/TCP), <code>coap</code> (CoAP over UDP), <code>coaps</code> CoAP over DTLS/UDP), <code>coap+tcp</code> (CoAP over TCP), or <code>coaps+tcp</code> (CoAP over TLS/TCP).
                        If omitted, the scheme is assumed to be <code>http</code> for TCP and <code>coap</code> for UDP. </dd>
                    </dl>
                </div>
            <p>
                <a href="#sequence-dnssd-thing" class="fig-ref" title="Using mDNS for discovery of the Thing Description of a Thing">Figure <bdi class="figno">2</bdi></a> and <a href="#sequence-dnssd-directory" class="fig-ref" title="Using mDNS for discovery of the Thing Description of a Thing Description Directory (TDD)">Figure <bdi class="figno">3</bdi></a> shows example sequences
                supporting discovery of a Thing or a <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-9">Thing Description Directory</a> using DNS-SD and mDNS. 
            </p>
            <figure id="sequence-dnssd-thing">
                <img src="images/sequence-dnssd-thing.png" srcset="images/sequence-dnssd-thing.svg" class="wot-diagram" alt="An example sequence of discovery of Thing using DNS-SD and mDNS">
                <figcaption>Figure <bdi class="figno">2</bdi> <span class="fig-title">Using mDNS for discovery of the Thing Description of a Thing</span></figcaption>
            </figure>
            <figure id="sequence-dnssd-directory">
                <img src="images/sequence-dnssd-directory.png" srcset="images/sequence-dnssd-directory.svg" class="wot-diagram" alt="An example sequence of discovery of directory service using DNS-SD and mDNS">
                <figcaption>Figure <bdi class="figno">3</bdi> <span class="fig-title">Using mDNS for discovery of the Thing Description of a Thing Description Directory (TDD)</span></figcaption>
            </figure>

        </section>
        <section id="introduction-core-rd-sec" class="normative"><div class="header-wrapper"><h3 id="x6-4-core-link-format-and-core-resource-directory"><bdi class="secno">6.4 </bdi>CoRE Link Format and CoRE Resource Directory</h3><a class="self-link" href="#introduction-core-rd-sec" aria-label="Permalink for Section 6.4"></a></div>
            
            <p class="at-risk">This section is at risk.</p>
            <p>
                <span class="rfc2119-assertion" id="introduction-core-rd">A Thing or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-10">Thing Description Directory</a> <em class="rfc2119">MAY</em> advertise its presence using the
                Constrained RESTful Environment (CoRE) Link Format [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6690" title="Constrained RESTful Environments (CoRE) Link Format">RFC6690</a></cite>].</span>
                <span class="rfc2119-assertion" id="introduction-core-rd-directory">
                A <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-1">Thing</a> or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-11">Thing Description Directory</a> <em class="rfc2119">MAY</em> use the CoRE Resource Directory [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9176" title="Constrained RESTful Environments (CoRE) Resource Directory">RFC9176</a></cite>]
                to register a link to its corresponding Thing Description.</span>
            </p>
            <p>
                <span class="rfc2119-assertion" id="introduction-core-rd-resource-type-thing">
                    The resource type (<code>rt</code>) of the Link that targets the Thing Description of the Thing
                    <em class="rfc2119">MUST</em> be <code>wot.thing</code>.</span>
                <span class="rfc2119-assertion" id="introduction-core-rd-resource-type-directory">
                    The resource type of the Link that targets the Thing Description of the <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-12">Thing Description Directory</a>
                    <em class="rfc2119">MUST</em> be <code>wot.directory</code>.</span>
            </p>
        </section>
        <section id="introduction-did-sec" class="normative"><div class="header-wrapper"><h3 id="x6-5-did-documents"><bdi class="secno">6.5 </bdi>DID Documents</h3><a class="self-link" href="#introduction-did-sec" aria-label="Permalink for Section 6.5"></a></div>
            
            <p><span class="rfc2119-assertion" id="introduction-did">A <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-2">Thing</a> or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-13">Thing Description Directory</a> 
                using a Decentralized Identifier (DID) [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>] <em class="rfc2119">MAY</em> advertise the location of its <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-1">TD</a>
                by including a DID Service Endpoint of type 
                <code>WotThing</code> or <code>WotDirectory</code>, respectively, in the DID Document that 
                the TD's identifier resolves to.</span>
            </p>
            <p><span class="rfc2119-assertion" id="introduction-did-service-endpoint">
                If the DID Document obtained by resolving the DID of a <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-3">Thing</a> or <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-14">Thing Description Directory</a> 
                contains a Service Endpoint of type <code>WotThing</code> or <code>WotDirectory</code>, respectively,
                then this Service Endpoint <em class="rfc2119">MUST</em> refer to the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-2">TD</a> describing that Thing 
                (when using the <code>WotThing</code> service name) 
		            or the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-3">TD</a> describing that <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-15">Thing Description Directory</a> (when using the <code>WotDirectory</code> service name),
                respectively.</span>
            </p>
            <aside class="example" id="example-a-example-service-endpoint-in-a-did-document-wotthing"><div class="marker">
    <a class="self-link" href="#example-a-example-service-endpoint-in-a-did-document-wotthing">Example<bdi> 1</bdi></a><span class="example-title">: A Example Service Endpoint in a DID Document - WotThing</span>
  </div>
                <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"service"</span>: [{
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:wotdiscoveryexample#td"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"WotThing"</span>,
        <span class="hljs-attr">"serviceEndpoint"</span>:
            <span class="hljs-string">"https://wot.example.com/.well-known/wot"</span>
    }]
}</code></pre>
            </aside>
            <aside class="example" id="example-a-example-service-endpoint-in-a-did-document-wotdirectory"><div class="marker">
    <a class="self-link" href="#example-a-example-service-endpoint-in-a-did-document-wotdirectory">Example<bdi> 2</bdi></a><span class="example-title">: A Example Service Endpoint in a DID Document - WotDirectory</span>
  </div>
                <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"service"</span>: [{
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:wotdiscoveryexample#tdd"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"WotDirectory"</span>,
        <span class="hljs-attr">"serviceEndpoint"</span>:
            <span class="hljs-string">"https://wot.example.com/tdd"</span>
    }]
}</code></pre>
            </aside>
        </section>
    </section>
    <section id="exploration-mech" class="normative"><div class="header-wrapper"><h2 id="x7-exploration-mechanisms"><bdi class="secno">7. </bdi>Exploration Mechanisms</h2><a class="self-link" href="#exploration-mech" aria-label="Permalink for Section 7."></a></div>
        

        This section defines the supported exploration mechanisms
        after providing some common background material.

        <section id="exploration-overview" class="normative"><div class="header-wrapper"><h3 id="x7-1-overview"><bdi class="secno">7.1 </bdi>Overview</h3><a class="self-link" href="#exploration-overview" aria-label="Permalink for Section 7.1"></a></div>
            
            <figure id="exploration-class-diagram">
                <img src="images/exploration-class-diagram.svg" class="wot-diagram" alt="Exploration mechanisms high-level class diagram" height="273" width="766">
                <figcaption>Figure <bdi class="figno">4</bdi> <span class="fig-title">
                    The high-level class diagram of the exploration mechanisms,
                    depicting how Thing Description Servers and Thing Description Directories provide <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-4">TDs</a>.
                    A Self-describing Thing is a special case of a Thing Description Server that is also a Thing.
                    A Thing Description Directory acts as a Thing Description Server for each 
                    Thing Description it contains.
                </span></figcaption>
            </figure>

            <p>
            <a href="#exploration-class-diagram" data-matched-text="[[[#exploration-class-diagram]]]" class="fig-ref" title="The high-level class diagram of the exploration mechanisms, depicting how Thing Description Servers and Thing Description Directories provide TDs. A Self-describing Thing is a special case of a Thing Description Server that is also a Thing. A Thing Description Directory acts as a Thing Description Server for each Thing Description it contains.">Figure <bdi class="figno">4</bdi></a> depicts the high-level information 
            model for <a href="#dfn-wot-td-server" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-td-server-1">TD Servers</a> (serving single TDs, including those for self-description) 
            and <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-16">Thing Description Directory</a> services.
            A <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-17">Thing Description Directory</a> may contain <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-5">TDs</a> 
            and at the same time is also a Thing, which means it has its own TD.  
            A directory also hosts web service endpoints 
            for retrieving individual TDs for other Things
            and each of these can be used as a TD Server.
            A Thing may in general host its own TD in which case it
            is a Self-Describing Thing.
            Self-description is not mandatory for directories,
            but Self-Describing Thing Description Directories are possible
            that are both Thing Description Directories and Self-Describing Things.
            </p>
            <p>
            The two basic exploration mechanisms are described in
            <a href="#exploration-server" data-matched-text="[[[#exploration-server]]]" class="sec-ref"><bdi class="secno">7.2 </bdi>Thing Description Server</a> and <a href="#exploration-directory" data-matched-text="[[[#exploration-directory]]]" class="sec-ref"><bdi class="secno">7.3 </bdi>Thing Description Directory</a>.
            </p>

            <section id="exploration-ontology" class="normative"><div class="header-wrapper"><h4 id="x7-1-1-ontology"><bdi class="secno">7.1.1 </bdi>Ontology</h4><a class="self-link" href="#exploration-ontology" aria-label="Permalink for Section 7.1.1"></a></div>
                
                <figure id="discovery-class-diagram-ontology">
                    <img src="images/discovery-class-diagram-ontology.svg" class="wot-diagram" alt="Ontology of TD in discovery context" height="288" width="787">
                    <figcaption>Figure <bdi class="figno">5</bdi> <span class="fig-title">The ontology of Thing Descriptions in the Discovery context.</span></figcaption>
                </figure>

                <p>
                    <a href="#discovery-class-diagram-ontology" data-matched-text="[[[#discovery-class-diagram-ontology]]]" class="fig-ref" title="The ontology of Thing Descriptions in the Discovery context.">Figure <bdi class="figno">5</bdi></a> illustrates the Discovery ontology
                    as an extension of the Thing ontology.
                </p>
                <p>
                    The ontology includes a class for metadata that are associated with
                    TDs stored in a directory.
                    This class is called <code>RegistrationInformation</code> and described as part
                    of the directory specification in <a href="#exploration-directory-registration-info" data-matched-text="[[[#exploration-directory-registration-info]]]" class="sec-ref"><bdi class="secno">7.3.1.1 </bdi>Registration Information</a>.
                </p>

                <p>
                    The Discovery ontology also defines two new Thing Description classes,
                    described in the following sections,
                    that may be used to model special exploratory metadata: 
                    <a href="#exploration-td-type-thingdirectory">ThingDirectory</a> and 
                    <a href="#exploration-td-type-thinglink">ThingLink</a>.
                </p>

                <section id="exploration-td-type-thingdirectory" class="normative"><div class="header-wrapper"><h5 id="x7-1-1-1-thingdirectory"><bdi class="secno">7.1.1.1 </bdi><code>ThingDirectory</code></h5><a class="self-link" href="#exploration-td-type-thingdirectory" aria-label="Permalink for Section 7.1.1.1"></a></div>
                    
                    <div class="issue" id="issue-container-number-148"><div role="heading" class="issue-title marker" id="h-issue" aria-level="6"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                        The type URIs used below are tentative and subject to change.
                    </div></div>  

                    <span class="rfc2119-assertion" id="exploration-directory-description-type"> 
                        A TD which describes a Thing Description Directory instance <em class="rfc2119">MUST</em> use type <code>ThingDirectory</code> from the
                        discovery context or URI <code>https://www.w3.org/2021/wot/discovery#ThingDirectory</code>.</span>
                    <p>
                        A TD of this class can be derived from Directory's Thing Model; see <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                    </p>
                
                </section>
                <section id="exploration-td-type-thinglink" class="normative"><div class="header-wrapper"><h5 id="x7-1-1-2-thinglink"><bdi class="secno">7.1.1.2 </bdi><code>ThingLink</code></h5><a class="self-link" href="#exploration-td-type-thinglink" aria-label="Permalink for Section 7.1.1.2"></a></div>
                    
            <p class="at-risk">The Think Link type described in this section
            is at risk.</p>
                    <div class="issue" id="issue-container-number-148-0"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="6"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                        The type URIs used below are tentative and subject to change.
                    </div></div>  

                    <span class="rfc2119-assertion" id="exploration-link-description-type"> 
                        A TD which describes a reference to another TD <em class="rfc2119">MUST</em> use type <code>ThingLink</code> from the
                        discovery context or URI <code>https://www.w3.org/2021/wot/discovery#ThingLink</code>.</span>
                    <span class="rfc2119-assertion" id="exploration-link-description-link"> 
                        A Thing Link <em class="rfc2119">MUST</em> define the referenced TD as a Link with
                        <code>describedby</code> link relation type, <code>application/td+json</code> media type
                        and <code>href</code> set to the target URL.</span>

                    <p>
                        <a href="#example-td-link-type" data-matched-text="[[[#example-td-link-type]]]" class="box-ref">Example<bdi> 3</bdi></a> is an example Thing Link.
                    </p>

                    
                    <aside class="example" id="example-td-link-type"><div class="marker">
    <a class="self-link" href="#example-td-link-type">Example<bdi> 3</bdi></a><span class="example-title">: Example of a Thing Link, referencing a remote TD</span>
  </div>
                        <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingLink"</span>,
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"urn:example:link"</span>,
    <span class="hljs-attr">"links"</span>: [{
        <span class="hljs-attr">"rel"</span>: <span class="hljs-string">"describedby"</span>,
        <span class="hljs-attr">"href"</span>: <span class="hljs-string">"https://example.com/td.jsonld"</span>,
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"application/td+json"</span>
    }],
    <span class="hljs-attr">"security"</span>: <span class="hljs-string">"nosec_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"nosec_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class="hljs-string">"nosec"</span>
        }
    },
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Example TD referencing another"</span>
}</code></pre>
                        <div class="issue" id="issue-container-number-148-1"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="6"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                            The context URIs are tentative and subject to change.
                        </div></div>                    
                    </aside>
                    <p>
                        A Thing Link can be used in various scenarios. For example:
                    </p>
                        <ul>
                            <li>
                                A self-describing Thing with limited computational resources intends
                                to describe itself: host a minimal <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-6">TD</a> (Thing Link) locally
                                and references a larger one with the full details hosted at a
                                different URL, perhaps in a directory.
                            </li>
                            <li>
                                A self-describing Thing or proxy has a very large or dynamic description:
                                registers a small or static <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-7">TD</a> (Thing Link) in a 
                                directory which references the actual <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-8">TD</a> hosted at the edge.
                            </li>
                    
                        </ul>
                </section>
            </section>
            <section id="exploration-secboot" class="normative"><div class="header-wrapper"><h4 id="x7-1-2-security-bootstrapping"><bdi class="secno">7.1.2 </bdi>Security Bootstrapping</h4><a class="self-link" href="#exploration-secboot" aria-label="Permalink for Section 7.1.2"></a></div>
                
                <p>The purpose of an exploration service is to serve TDs, but only after suitable
                authentication, and only to authorized parties.  
                However, in some cases a Discoverer may not know what security credentials are
                needed to access a TD via an exploration service, particularly in ad-hoc scenarios.
                Since upon first access to an exploration service a Discoverer will not yet
                have access to the TD if suitable authentication credentials are not provided, 
                the Discoverer can't depend on the security metadata
                held in TDs to know what kind of authentication and authorization information is needed.
                If the Discoverer has no prior knowledge,
                it will have to depend on existing security negotation support to
                bootstrap access, at least to the TD itself.
                </p>
                <p>
                We define the following for the HTTP protocol, for which security negotiation
                processes already exist.
                However, most of the HTTP negotiation processes assume there is a human user in the loop,
                but this is also appropriate for WoT Discovery, since this problem will
                typically occur when a user is trying to access a public WoT service or perform
                integration of a new device. In this case the purpose of negotiation is to
                provide guidance on what credentials are needed to access the system.
                </p>
                <p>
                In cases when exploration services are being used to
                automate system management it would be best to pre-establish what credentials (and
                authentication mechanisms) are needed to access the relevant exploration services
                and security bootstrapping would not be required.  
                For this reason security bootstrapping is not a mandatory feature, and can
                be omitted or disabled on devices that are to be used with pre-established
                security mechanisms.
                </p>
                <p>Security bootstrapping may also only be necessary on the <em>first</em> access to
                a TD. Once a Discoverer has determined what credentials and authentication mechanism
                are required to access a particular exploration service, they can retain this information
                and attempt to use them for future accesses.
                Note however that depending on the security scheme used, credentials themselves
                may expire and may need to be re-established periodically.
                </p>
                <p>
                <span class="rfc2119-assertion" id="security-bootstrapping-endpoints">Security
                bootstrapping <em class="rfc2119">MAY</em> be provided on any HTTP endpoint that serves a TD.</span>

                As mentioned above, disabling or omitting security bootstrapping is permissible if 
                security mechanisms have been previously established.  For example, if an installation 
                wants to use the OAuth2 <code>client</code> flow and provide potential clients with
                an address of an authentication server to use in advance, then security bootstrapping
                can be disabled, since the alternative would be to include other (and potentially
                weaker) forms of authentication. 
                </p>
                <p>In the HTTP protocol, the authentication and authorization mechanisms to be used can generally be negotiated by
                the HTTP server returning a "401 (Unauthorized)" response code in conjunction with
                a <code>WWW-Authenticate</code> header that specifies the information required.
                To gain access, the client then needs to make another request 
                with the necessary information.
                <a href="https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml">There 
                are several authentication schemes registered with IANA.</a>
                However, not all of these are in wide use, some are experimental, and there is only
                partial overlap with the schemes supported by TDs.
                Also, note that the <code>oauth</code> scheme in the IANA registration refers
                to OAuth1, which is deprecated, so it should not be used.
                The relevant OAuth2 flow, the <code>code</code> flow, instead of a 401 response
                begins with a redirection to an authentication
                server, eventually resulting in credentials (bearer tokens in the case of WoT)
                that can be used for access.
                </p>
                <p>
                Given these considerations,
                to enable security bootstrapping on a wide variety of devices as well
                as on browsers, the following constraints should be observed:
                </p>
                <ul>
                <li><span class="rfc2119-assertion" id="exploration-secboot-401">
                If security bootstrapping is enabled on an exploration service,
                after initial contact using the URL provided
                by an introduction mechanism, the exploration service
                <em class="rfc2119">MUST</em> reply with either an HTTP "401 (Unauthorized)" response code 
                or (in the case of OAuth2) with either a HTTP "302 (Found)" or "303 (See Other)" response code if appropriate
                authentication information has not been provided but access can be granted
                when it is.</span>
                Note that if the exploration service does not want to provide access for
                some reason, or if security bootstrapping is disabled,
                it can ignore the request or reply with another code such as 404 or 403.
                Also, if no authentication is required, then the 
                system can reply immediately with the requested TD as if authentication information
                were provided.  
                Bypassing authentication however is only
                appropriate if the TD served as a response does not contain and cannot be used to infer 
                Personally Identifiable Information; see <a href="#privacy-considerations" class="sec-ref"><bdi class="secno">9. </bdi>Privacy Considerations</a>.
                </li>
                <li><span class="rfc2119-assertion" id="exploration-secboot-auth">
                If security bootstrapping is enabled on an exploration service
                using one of the following IANA-registered
                HTTP Authentication Schemes: Basic, Bearer, or Digest,
                then a 401 HTTP response 
                at an API endpoint intended to serve a TD
                <em class="rfc2119">MUST</em> include a <code>WWW-Authenticate</code> header
                and any other headers
                describing the required authorizations.</span>
                For details of the requirements, the IANA registry should be consulted for
                each of the above authentication schemes.  
                <span class="rfc2119-assertion" id="exploration-secboot-oauth2-flows">
                If the OAuth2 <code>code</code> flow is used during security bootstrapping, the
                "302 (Found)" or "303 (See Other)" response code <em class="rfc2119">MUST</em> be used for redirection
                to the authentication server,
                with access credentials eventually being represented with bearer tokens.</span>
                Note that the other OAuth2 flows supported in WoT Thing Description 1.1,
                <code>client</code> and <code>device</code>, both expect the initial access
                to be to the authentication server, not the final endpoint, and so cannot be
                used via security bootstrapping.
                These requirements also apply only to endpoints of exploration services that might need
                to support security bootstrapping, that is those that serve TDs,
                not to other endpoints that might be
                provided by the same exploration service.  
                In particular, these requirements apply
                only to URLs that can be referenced by introduction mechanisms, not to (for example)
                event subscription endpoints.
                </li>
                </ul>
                <p>
                There are relevant Security and Privacy Considerations in [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>] 
                and [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>] 
                regarding when authentication is required for access
                to TDs and the use of secure transport.  
                See also <a href="#privacy-considerations" data-matched-text="[[[#privacy-considerations]]]" class="sec-ref"><bdi class="secno">9. </bdi>Privacy Considerations</a>.
                In summary, secure transport (e.g. TLS) is required for public services and strongly recommended
                even on private networks (even if there is no authentication requirement, to
                protect the confidentiality of queries), and serving requests without authentication and authorization should only be considered 
                in limited circumstances when no Personally Identifiable Information is 
                present or can be inferred.
                </p>
            </section>
        </section>

        <section id="exploration-server" class="normative"><div class="header-wrapper"><h3 id="x7-2-thing-description-server"><bdi class="secno">7.2 </bdi>Thing Description Server</h3><a class="self-link" href="#exploration-server" aria-label="Permalink for Section 7.2"></a></div>
            
            <p>
             Any web service that can be referenced by a URL and return a TD with
             appropriate authentication and access controls can be used as an
             exploration mechanism.  
             We will refer to this as a Thing Description Server or TD Server.
             A TD Server does not need to be a Thing.
             In particular, a TD can be hosted on an ordinary web server
             and referenced by its URL.  
            </p>
            <p>
            A TD Server can be used to support self-description.
            For self-description, a <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-4">Thing</a>
            hosts its own <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-9">TD</a> and makes it available via a web resource
            identified with a URL.  Such a web resource however is not included
            as an affordance in the TD itself.  This web resource may or may not
            be the same as the well-known URL used as an Introduction mechanism
            defined in <a href="#introduction-well-known" class="sec-ref"><bdi class="secno">6.2 </bdi>Well-Known URIs</a>.
            </p> 
            <p>Use of secure transport is subject to assertions given in the 
            Security Considerations and Privacy Considerations sections of the 
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>] specifications, 
            which define scenarios where secure transport is recommended or mandatory and mutual 
            authentication is recommended.
            </p>
            <p>
             A TD Server distributing a TD 
             using the following protocols 
             is subject to the following constraints:
            </p> 
            <dl>
                <dt>HTTP</dt>
                <dd>
                    <p>
                        <span class="rfc2119-assertion" id="exploration-server-http-method"> 
                            An HTTP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-10">TD</a> 
                            <em class="rfc2119">MUST</em> serve that resource with a <code>GET</code> method.</span>
                        <span class="rfc2119-assertion" id="exploration-server-http-resp">
                            A successful response from an HTTP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-11">TD</a>
                            <em class="rfc2119">MUST</em> have 200 (OK) status and the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-12">TD</a> in the body.</span>
                        <span class="rfc2119-assertion" id="exploration-server-http-resp-content-type">
                            A successful response with JSON serialization <em class="rfc2119">MUST</em> contain either <code>application/json</code>
                            or <code>application/td+json</code> in the Content-Type header.</span>
                            Here <code>application/td+json</code> is preferred as it is 
                            more specific and implies <code>application/json</code>.
                        <span class="rfc2119-assertion" id="exploration-server-http-resp-json">
                            The default serialization format for successful response bodies <em class="rfc2119">MUST</em> be
                            JSON, with JSON-LD 1.1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] syntax.</span>
                        The JSON-LD syntax allows semantic extensions and processing.
                        <span class="rfc2119-assertion" id="exploration-server-http-alternate-content">
                            An HTTP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-13">TD</a> 
                            <em class="rfc2119">MAY</em> provide alternative representations through
                            server-driven content negotiation, that is by honoring the 
                            request's Accept and Accept-Encoding headers and responding with the supported
                            TD serialization and equivalent Content-Type and Content-Encoding headers.</span>
                        <span class="rfc2119-assertion" id="exploration-server-http-alternate-language">
                            An HTTP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-14">TD</a> 
                            <em class="rfc2119">MAY</em> provide modified TDs or error responses 
                            using a different default language after server-driven content negotiation, 
                            that is by honouring the request's Accept-Language header.</span>
                    </p>
                    <p>
                        <span class="rfc2119-assertion" id="exploration-server-http-head">
                            An HTTP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-15">TD</a> 
                            <em class="rfc2119">MUST</em> respond to <code>HEAD</code> requests by returning only the headers
                            equivalent to those returned by a <code>GET</code> request to the same endpoint.</span>
                        This enables clients to retrieve HTTP headers such as the Content-Length in advance 
                        to know the size of the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-16">TD</a> (in bytes) and decide on an efficient query strategy.
                    </p>
                    <p>
                        In constrained environments, a single <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-17">TD</a> may be too large to process
                        for the server or clients. 
                        See <a href="#perf-incremental-transfer" data-matched-text="[[[#perf-incremental-transfer]]]" class="sec-ref"><bdi class="secno">10.1 </bdi>Incremental Transfer</a> for protocol-specific recommendations on 
                        incremental transfer of the requested payload. 
                    </p>
                    
                    <p>
                        Error responses:  
                    </p>
                        <ul>
                            <li>
                                401 (Unauthorized): No authentication.
                            </li>
                            <li>
                                403 (Forbidden): Insufficient rights to the resource.
                            </li>
                        </ul>
                </dd>
            </dl>
            <dl>
                <dt>CoAP</dt>
                <dd>
            <p class="at-risk">CoAP-based TD Servers are at risk.</p>
                <p>
                    <span class="rfc2119-assertion" id="exploration-server-coap-method">
                        A CoAP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-18">TD</a>
                        <em class="rfc2119">MUST</em> serve that resource with a <code>GET</code> method.</span>
                    <span class="rfc2119-assertion" id="exploration-server-coap-resp">
                        A successful response from a CoAP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-19">TD</a>
                        <em class="rfc2119">MUST</em> have a 2.05 (Content) status, contain a Content-Format option
                        with value 50 (<code>application/json</code>) or 432 (<code>application/td+json</code>), 
                        and the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-20">TD</a> in the payload.</span>
                    Content-Format 432 is preferred as it is more specific and implies Content-Format 50.
                    Note that the payload might be split over multiple message exchanges using
                    block-wise transfer [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7959" title="Block-Wise Transfers in the Constrained Application Protocol (CoAP)">RFC7959</a></cite>].
                    <span class="rfc2119-assertion" id="exploration-server-coap-alternate-content">
                        A CoAP-based TD Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-21">TD</a>
                        <em class="rfc2119">MAY</em> provide alternative representations through
                        server-driven content negotiation, that is by honouring the
                        request's Accept option and responding with the supported
                        <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-22">TD</a> serialization and equivalent Content-Format option.</span>
                </p>
                <p>
                    <span class="rfc2119-assertion" id="exploration-server-coap-size2">
                        A CoAP-based <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-23">TD</a> Server providing a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-24">TD</a>
                        <em class="rfc2119">SHOULD</em> respond to requests containing a Size2 option by including
                        the size estimate of the <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-25">TD</a> in its next response.</span>
                    This is relevant when obtaining a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-26">TD</a> using block-wise transfer and
                    enables clients to abort the retrieval if the total payload size should be too
                    large for them to process.
                </p>
                <p>
                    In constrained environments, a single <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-27">TD</a> may be too large to process
                    for the server or clients.
                    See <a href="#perf-incremental-transfer" data-matched-text="[[[#perf-incremental-transfer]]]" class="sec-ref"><bdi class="secno">10.1 </bdi>Incremental Transfer</a> for protocol-specific recommendations on
                    incremental transfer of the requested payload.
                </p>

                <p>
                    Error responses:
                </p>
                    <ul>
                        <li>
                            4.01 (Unauthorized): No authentication.
                        </li>
                        <li>
                            4.03 (Forbidden): Insufficient rights to the resource.
                        </li>
                    </ul>
            </dd>
            </dl>
        </section>
        
        <section id="exploration-directory" class="normative"><div class="header-wrapper"><h3 id="x7-3-thing-description-directory"><bdi class="secno">7.3 </bdi>Thing Description Directory</h3><a class="self-link" href="#exploration-directory" aria-label="Permalink for Section 7.3"></a></div>
            
            <p>
             A <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-18">Thing Description Directory</a> (TDD or Directory for short) is a 
             <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-5">Thing</a> that provides a service to manage a set of TDs describing other Things.
            </p>

            <section id="exploration-directory-info" class="normative"><div class="header-wrapper"><h4 id="x7-3-1-information-model"><bdi class="secno">7.3.1 </bdi>Information Model</h4><a class="self-link" href="#exploration-directory-info" aria-label="Permalink for Section 7.3.1"></a></div>
                
                <p>
                As shown in <a href="#exploration-class-diagram" data-matched-text="[[[#exploration-class-diagram]]]" class="fig-ref" title="The high-level class diagram of the exploration mechanisms, depicting how Thing Description Servers and Thing Description Directories provide TDs. A Self-describing Thing is a special case of a Thing Description Server that is also a Thing. A Thing Description Directory acts as a Thing Description Server for each Thing Description it contains.">Figure <bdi class="figno">4</bdi></a>, 
                the <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-19">Thing Description Directory</a> can contain zero or more <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-28">TDs</a>.
                For every TD, the directory maintains additional metadata
                for bookkeeping and search purposes.
                These are described in
                <a href="#exploration-directory-registration-info" data-matched-text="[[[#exploration-directory-registration-info]]]" class="sec-ref"><bdi class="secno">7.3.1.1 </bdi>Registration Information</a> and
                <a href="#exploration-directory-anonymous-td" data-matched-text="[[[#exploration-directory-anonymous-td]]]" class="sec-ref"><bdi class="secno">7.3.1.3 </bdi>Anonymous TD Identifiers</a>.
                A <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-29">TD</a> that embeds such additional metadata as part of the
                interaction with the directory is called an <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-1">Enriched TD</a>.
                </p>

                <section id="exploration-directory-registration-info" class="normative"><div class="header-wrapper"><h5 id="x7-3-1-1-registration-information"><bdi class="secno">7.3.1.1 </bdi>Registration Information</h5><a class="self-link" href="#exploration-directory-registration-info" aria-label="Permalink for Section 7.3.1.1"></a></div>
                    
                    <p>
                    The ontology of a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-30">TD</a> in the Discovery context was
                    introduced in <a href="#discovery-class-diagram-ontology" data-matched-text="[[[#discovery-class-diagram-ontology]]]" class="fig-ref" title="The ontology of Thing Descriptions in the Discovery context.">Figure <bdi class="figno">5</bdi></a>.
                    The <code>RegistrationInformation</code> class is associated with <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-31">TDs</a> that are
                    stored in a directory. 
                    The following table lists the registration information attributes for
                    use within <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-32">TDs</a> that embed or reference the Discovery context. 
                    Note that only an <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-2">Enriched TD</a> embeds the registration information. 
		            <span class="rfc2119-assertion" id="tdd-context-injection">An <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-3">Enriched TD</a>
                        <em class="rfc2119">MUST</em> contain in its @context the URI <code>https://w3c.github.io/wot-discovery/context/discovery-context.jsonld</code>.</span>
                    In this table,
                    client refers to the producer or consumer of a <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-33">TD</a> and server refers to
                    the <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-20">Thing Description Directory</a>.
                    </p>
                    <p>
                    <span class="rfc2119-assertion" id="tdd-absolute-time">Whenever an absolute time is expressed
                    using <a href="https://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime">dateTime</a> 
                    it <em class="rfc2119">MUST</em> be interpreted as date-time as specified in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc3339" title="Date and Time on the Internet: Timestamps">RFC3339</a></cite>].</span>
                    Specifically, the timezone offset is not optional.
                    </p>
                    <div class="note" id="issue-container-generatedID-0"><div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="6"><span>Editor's note</span><span class="issue-label">: dateTime vs. date-time</span></div><p class="">We should update the ontology to 
                    only use date-time and RFC3339 and
                    not this odd combination of dateTime and date-time, 
                    but this should also be resolved in the TD specification.
                    However, we would need a new SHACL shape with this additional restriction.
                    </p></div>
                    
                    <table class="def">
                        <thead>
                            <tr>
                                <th>Vocabulary term</th>
                                <th>Description</th>
                                <th>Client Assignment</th>
                                <th>Server Assignment</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="rfc2119-table-assertion" id="tdd-registrationinfo-vocab-created">
                                <td><code>created</code></td>
                                <td>
                                    Provides the absolute time when the TD instance was
                                    created inside the directory.
                                    <p>
                                        This <em class="rfc2119">MAY</em> be set by the directory and returned to consumers.
                                    </p>
                                </td>
                                <td>read-only</td>
                                <td>optional</td>
                                <td><a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code>dateTime</code></a></td>
                            </tr>
                            <tr class="rfc2119-table-assertion" id="tdd-registrationinfo-vocab-modified">
                                <td><code>modified</code></td>
                                <td>
                                    Provides the absolute time when the TD instance was
                                    last modified inside the directory.
                                    <p>
                                        This <em class="rfc2119">MAY</em> be set by the directory and returned to consumers.
                                    </p>
                                </td>
                                <td>read-only</td>
                                <td>optional</td>
                                <td><a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code>dateTime</code></a></td>
                            </tr>
                            <tr class="rfc2119-table-assertion" id="tdd-registrationinfo-vocab-expires">
                                <td><code>expires</code></td>
                                <td>
                                    Provides the absolute time when the TD instance registration expires.
                                    <p>
                                        The producer <em class="rfc2119">MAY</em> set this to indicate the absolute expiry time
                                        during the registration.
                                    </p>
                                    <p>
                                        For servers that support expirable TDs:
                                        If <code>ttl</code> (relative expiry) is present, the server <em class="rfc2119">MUST</em> ignore
                                        client assignments to <code>expires</code> and instead compute and set it internally.
                                    </p>
                                </td>
                                <td>optional</td>
                                <td>optional</td>
                                <td><a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code>dateTime</code></a></td>
                            </tr>
                            <tr class="rfc2119-table-assertion" id="tdd-registrationinfo-vocab-ttl">
                                <td><code>ttl</code></td>
                                <td>
                                    Time-to-live: relative amount of time in seconds from the registration time 
                                    until when the TD instance registration expires. 
                                    <p>
                                        The producer <em class="rfc2119">MAY</em> set this to indicate the relative expiry time
                                        during the registration.
                                    </p>
                                    <p>
                                        For servers that support expirable TDs:
                                        The server <em class="rfc2119">MUST</em> use <code>ttl</code> to calculate the <code>expires</code> (absolute expiry) value.
                                    </p>
                                </td>
                                <td>optional</td>
                                <td>read-only</td>
                                <td><code>number</code></td>
                            </tr>
                            <tr class="rfc2119-table-assertion" id="tdd-registrationinfo-vocab-retrieved">
                                <td><code>retrieved</code></td>
                                <td>
                                    The absolute time at which the TD was retrieved from the server.
                                    <p>
                                        This is useful for clients that intend to process other absolute timestamps but
                                        do not have an internal clock or other means of acquiring the current time.
                                    </p>
                                </td>
                                <td>read-only</td>
                                <td>optional</td>
                                <td><a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code>dateTime</code></a></td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                <section id="exploration-directory-registration-expiry" class="normative"><div class="header-wrapper"><h5 id="x7-3-1-2-registration-expiry"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</h5><a class="self-link" href="#exploration-directory-registration-expiry" aria-label="Permalink for Section 7.3.1.2"></a></div>
                    
                    Section <a href="#exploration-directory-registration-info" data-matched-text="[[[#exploration-directory-registration-info]]]" class="sec-ref"><bdi class="secno">7.3.1.1 </bdi>Registration Information</a> introduces some attributes to
                    specify and discover the expiry time of registered <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-34">TDs</a>. 

                    <p>
                        Producers can set the expiry time to inform the directory and other consumers
                        about the validity of the TD registrations. 
                        The expiry is also a useful indicator to inform the consumers about
                        expiry of dynamic <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-35">TDs</a>, e.g. when changes to metadata such as
                        geolocation or properties are expected to be valid for a limited period.
                        Consumers may rely on the expiry time to know how long a retrieved <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-36">TD</a>
                        will be valid and when they need to request a more recent one.
                        Consumers who retrieve an expired TD may consider it as metadata of an
                        inactive client.
                    </p>
                    <p>
                        For the servers, the expiry time is useful for implementing automatic
                        removal of obsolete or accidental registrations.
                        <span class="rfc2119-assertion" id="tdd-registrationinfo-expiry-purge">
                            Servers <em class="rfc2119">SHOULD</em> periodically purge TDs that are past 
                            their expiry times.</span>
                        Prescribing a global mandate or upper limit for the expiry time is
                        application-specific and beyond the scope of this specification.
                        <span class="rfc2119-assertion" id="tdd-registrationinfo-expiry-config">
                            The servers <em class="rfc2119">MAY</em> mandate or set a configurable upper limit to expiry times
                            and refuse incompliant requests.</span>
                        
                        The purging by servers is particularly beneficial when interacting with
                        clients (e.g. IoT devices) that are unable to explicitly deregister
                        their <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-37">TDs</a>. This could be due to protocol-specific limitations,
                        failure, destruction, or ungraceful decommissioning.
                        Such clients should set a reasonably short expiry time and periodically
                        extend it during the normal operation. The expiry can be extended by
                        updating the registration either fully or partially, including an update that makes no
                        changes to the TD; see <a href="#exploration-directory-api-things-update" data-matched-text="[[[#exploration-directory-api-things-update]]]" class="sec-ref"><bdi class="secno">7.3.2.1.3 </bdi>Update</a>.
                       
                        If a client ceases to operate, a directory with purging capability will
                        automatically remove its registration.
                    </p>
                        
                </section>
                <section id="exploration-directory-anonymous-td" class="normative"><div class="header-wrapper"><h5 id="x7-3-1-3-anonymous-td-identifiers"><bdi class="secno">7.3.1.3 </bdi>Anonymous TD Identifiers</h5><a class="self-link" href="#exploration-directory-anonymous-td" aria-label="Permalink for Section 7.3.1.3"></a></div>
                    
                    The directory assigns local identifiers to <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-1">Anonymous TDs</a>
                    to enable management and retrieval of such TDs from the directory.
                    <span class="rfc2119-assertion" id="tdd-anonymous-td-identifier">
                        In situations where the server exposes an Anonymous TD (e.g. retrieval, listing, search),
                        it <em class="rfc2119">MUST</em> add the local identifier as <code>id</code> of the TD to allow local referencing.</span>

                    <span class="rfc2119-assertion" id="tdd-anonymous-td-local-uuid">
                        The local identifier <em class="rfc2119">SHOULD</em> be a UUID Version 4, presented as a URN [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4122" title="A Universally Unique IDentifier (UUID) URN Namespace">RFC4122</a></cite>].</span>
                    UUID Version 4 is a random or pseudo-random number which does not carry unintended information
                    about the host or the resource.
                </section>
            </section>
            <section id="exploration-directory-api" class="normative"><div class="header-wrapper"><h4 id="x7-3-2-directory-service-api"><bdi class="secno">7.3.2 </bdi>Directory Service API</h4><a class="self-link" href="#exploration-directory-api" aria-label="Permalink for Section 7.3.2"></a></div>
                
                <p>
                Directory services provide access to
                <a href="https://www.w3.org/TR/wot-security/#dfn-system-user-data">System User Data</a> 
                and need to provide appropriate security and privacy protections.
                The use of secure transport protocols and access controls for
                authenticity and confidentiality in implementations of the WoT Directory Service API are governed by
                the Security Consideration and Privacy Considerations given in [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title="Web of Things (WoT) Architecture 1.1">wot-architecture11</a></cite>].
                </p> 
                <p>
                    The HTTP API responses must use appropriate status codes described in 
                    this section for success and error responses.
                    <span class="rfc2119-assertion" id="tdd-http-error-response"> 
                        The HTTP API <em class="rfc2119">MUST</em> use the Problem Details [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7807" title="Problem Details for HTTP APIs">RFC7807</a></cite>] format to carry
                        error details in HTTP client error (4xx) and server error (5xx) responses.</span>
                    This enables both machines and humans to know the high-level error class
                    and fine-grained details.
                    <span class="rfc2119-assertion" id="tdd-http-error-response-utf-8">
                        All HTTP API error responses described using Problem Details <em class="rfc2119">MUST</em> be encoded using UTF-8.</span>
                    <span class="rfc2119-assertion" id="tdd-http-error-response-lang">
                        HTTP API error responses <em class="rfc2119">MAY</em> report details in different languages using
                        proactive negotiation, if the <code>Accept-Language</code> header field has been
                        set in the HTTP request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7231" title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>].</span>
                </p>



                <p>
                    The APIs set the HTTP status codes as defined in 
                    <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-6">Section 6</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7231" title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>].
                    The list of used error codes include (but are not limited to) the following:
                </p>
                    <ul>
                        <li>
                            400 (Bad Request): Invalid client input in body, query, or headers.
                            This is accompanied by an appropriate response message.
                        </li>
                        <li>
                            401 (Unauthorized): The request lacks valid authentication credentials.
                            As noted in <a href="#exploration-secboot" data-matched-text="[[[#exploration-secboot]]]" class="sec-ref"><bdi class="secno">7.1.2 </bdi>Security Bootstrapping</a>, this is the first
                            step in authentication negotiation, needed to bootstrap secure access to TDs.
                            Information on what credentials are required will be included 
                            in a <code>WWW-Authenticate</code> header.
                        </li>
                        <li>
                            403 (Forbidden): Insufficient rights to access the resource.
                        </li>
                        <li>
                            404 (Not Found): TD or endpoint does not exist.
                            This is accompanied by an appropriate response message.
                        </li>
                    </ul>
                
                <p>
                    <span class="rfc2119-assertion" id="tdd-http-head"> 
                        For each HTTP endpoint that responds to the <code>GET</code> method, the server <em class="rfc2119">MUST</em> accept <code>HEAD</code> 
                        requests and return only the headers.</span>
                    This allows clients to retrieve headers such as the Content-Length without receiving the body
                    and decide on a suitable strategy to query the information. For example, a constrained client can
                    request only the necessary parts of an object (using an appropriate search query) or 
                    retrieve a list of items in small subsets.
                </p>

                <p>
                    In constrained environments, a single TD may be too large to process for the server or clients.
                    This affects both read (i.e. retrieving one or more TDs or TD fragments) 
                    and write (i.e. submitting a TD or Partial TD) operations.
                    See <a href="#perf-incremental-transfer" data-matched-text="[[[#perf-incremental-transfer]]]" class="sec-ref"><bdi class="secno">10.1 </bdi>Incremental Transfer</a> for protocol-specific recommendations on
                    incremental transfer of the payloads.
                </p>

                <p>
                    To ensure the safe transmission of data over the URL, it is expected that
                    both client and server percent encode/decode characters that conflict with
                    delimiters in the rest of the URL.
                    These characters are defined as <i>unsafe</i> in
                    <a href="https://datatracker.ietf.org/doc/html/rfc1738#section-2.2">Section 2.2</a>
                    of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1738" title="Uniform Resource Locators (URL)">RFC1738</a></cite>].
                    Unsafe characters can result in unexpected behavior if they appear in the URL, for example,
                    when the resource ID included in the path is a URL by itself, or
                    in the search query string.
                </p>

                <p>
                    The directory APIs include mandatory, recommended, and optional
                    features. 
                    <span class="rfc2119-assertion" id="tdd-http-unsupported-feature">
                        When a directory is unable to answer a request because of unsupported
                        recommended or optional features, it <em class="rfc2119">SHOULD</em> inform the client about the
                        absence of those features by returning appropriate HTTP errors.</span>
                    The following examples can be used as guideline for implementations:
                    </p><ul>
                        <li>
                            If the missing feature is to customize functionality of an
                            existing API (e.g. custom sort ordering when listing),
                            use 400 (Bad Request) or 501 (Not Implemented).
                        </li>
                        <li>
                            If an API endpoint is not provided (e.g. <code>/search/sparql</code> endpoint),
                            use 404 (Not Found).
                        </li>
                        <li>
                            If a method is not supported on an existing API endpoint
                            (e.g. <code>PATCH</code> for <code>/things</code> endpoint), use 405 (Method Not Allowed).
                        </li>
                    </ul>

                <p>
                    <span class="rfc2119-assertion" id="tdd-http-alternate-language">
                        A Directory server <em class="rfc2119">MAY</em> provide modified TDs or error responses using a different
                        default language after server-driven content negotiation, 
                        that is by honouring the request's Accept-Language header.</span>
                    The process of modifying the default language of a TD using translations already
                    provided in a TD is described in the WoT Thing Description 1.1 specification
                    [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>].

                </p><section id="exploration-directory-api-things" class="normative"><div class="header-wrapper"><h5 id="x7-3-2-1-things-api"><bdi class="secno">7.3.2.1 </bdi>Things API</h5><a class="self-link" href="#exploration-directory-api-things" aria-label="Permalink for Section 7.3.2.1"></a></div>
                    
                    <p>
                        The Things API is a RESTful HTTP API served at the <code>/things</code> endpoint
                        providing interfaces to 
                        create, retrieve, update, delete, and list (CRUDL) <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-38">TDs</a>.
                        The design of this API is in accordance with [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7231" title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-rest-iot" title="RESTful Design for Internet of Things Systems">REST-IOT</a></cite>].
                    </p>

                    <p>
                        The HTTP API follows these general rules:
                    </p>
                        <ul>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-list-only">
                                    The API <em class="rfc2119">MUST</em> provide the interface to list TDs.</span>
                                The Search API allows filtering and selection from this list; see
                                <a href="#exploration-directory-api-search" data-matched-text="[[[#exploration-directory-api-search]]]" class="sec-ref"><bdi class="secno">7.3.2.3 </bdi>Search API</a>.
                            </li>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-crud">
                                    The API <em class="rfc2119">MAY</em> provide the interfaces to
                                    create, read, update, and delete (CRUD) individual TDs.</span>
                            </li>
                            <li>
                                A directory that provides both read and write over HTTP is considered
                                a full HTTP directory.
                                <span class="rfc2119-assertion" id="tdd-things-crudl">
                                    Full HTTP directories <em class="rfc2119">SHOULD</em> implement all of
                                    CRUDL (create, read, update, delete, and list) interfaces.</span>
                                It is practical to implement only the interfaces to read and list
                                if the directory serves a static collection of <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-39">TDs</a>.
                                This is also useful for directories that intend to expose only
                                retrieval operations over HTTP, and perform other operations via out-of-band mechanisms.
                                <span class="rfc2119-assertion" id="tdd-things-read-only-auth">
                                    To expose read-only access, the directory <em class="rfc2119">MUST</em> enforce access control
                                    on create, update, and delete interfaces.</span>
                            </li>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-default-representation">
                                    The default serialization format for all request and success response bodies <em class="rfc2119">MUST</em> be
                                    JSON, with JSON-LD 1.1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>] syntax to support extensions and semantic
                                    processing.</span>
                            </li>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-representation-alternate-input">
                                    Directories <em class="rfc2119">MAY</em> accept alternative representations based on request's indicated
                                    Content-Type or Content-Encoding headers.</span>
                                This is useful for applications that need to provide representations other than
                                raw JSON as input to a directory.
                            </li>
                            <li>                       
                                <span class="rfc2119-assertion" id="tdd-http-representation-alternate-output">
                                    Directories <em class="rfc2119">MAY</em> provide alternative representations through
                                    server-driven content negotiation, that is by honouring the 
                                    request's Accept and Accept-Encoding headers and responding with the supported
                                    TD representation and equivalent Content-Type and Content-Encoding headers.</span>
                                This is useful for applications that need to retrieve representations other than
                                raw JSON from a directory, such as Gzip-compressed JSON.
                            </li>
                        </ul>
                    
                    <p>
                        The CRUDL operations are described in the following sections:
                    </p>

                    <section id="exploration-directory-api-things-creation" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-1-creation"><bdi class="secno">7.3.2.1.1 </bdi>Creation</h6><a class="self-link" href="#exploration-directory-api-things-creation" aria-label="Permalink for Section 7.3.2.1.1"></a></div>
                        
                        <p>
                            Creation refers to the registration of a new <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-40">TD</a> inside the directory.
                        </p>
                        <p> 
                            The TD object is validated in accordance with <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
                            Note that a TD may or may not be generated by the <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-6">Thing</a> it describes.
                            For brownfield devices in particular a separate <a href="#dfn-wot-discoverer" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-discoverer-2">Discoverer</a> process
                            or service may be required that generates and registers a TD for a <a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-7">Thing</a>
                            on its behalf.
                        </p>
                        <p>
                            <span class="rfc2119-assertion" id="tdd-things-create-known-vs-anonymous"> 
                                A TD which is identified with an <code>id</code> attribute <em class="rfc2119">MUST</em> be handled 
                                differently with one that has no identifier (<a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-2">Anonymous TD</a>).</span>
                            The create operations are elaborated below:
                        </p>
                        <ul>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-create-known-td">
                                    A TD that has an <code>id</code> <em class="rfc2119">MUST</em> be submitted to the directory in the body of an HTTP <code>PUT</code> request
                                    at <code>/things/{id}</code> endpoint, where <code>id</code> is the unique TD identifier,
                                    present inside the TD object.</span>
                                An <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-3">Anonymous TD</a> is handled differently; see below.
                                <span class="rfc2119-assertion" id="tdd-things-create-known-contenttype">
                                    The request <em class="rfc2119">SHOULD</em> contain <code>application/td+json</code> Content-Type header for 
                                    JSON serialization of TD.</span>
                                The TD object is validated in accordance with <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
                                <span class="rfc2119-assertion" id="tdd-things-create-known-td-resp">  
                                    Upon successful processing, the server <em class="rfc2119">MUST</em> respond with
                                    201 (Created) status.</span>

                                <p>
                                    Note: If the target location corresponds to an existing TD,
                                    the request shall instead proceed as an Update operation and respond
                                    the appropriate status code (see Update section).
                                </p>
                                <p>
                                    The create operation for <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-41">TDs</a> that have identifiers is specified
                                    as <code>createThing</code> action in <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                                </p>
                            </li>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-create-anonymous-td">
                                    An <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-4">Anonymous TD</a> <em class="rfc2119">MUST</em> be submitted to the directory in the body of
                                    an HTTP <code>POST</code> request at <code>/things</code> endpoint.</span>
                                <span class="rfc2119-assertion" id="tdd-things-create-anonymous-contenttype">
                                    The request <em class="rfc2119">SHOULD</em> contain <code>application/td+json</code> Content-Type header for 
                                    JSON serialization of TD.</span>
                                The TD object is validated in accordance with <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
                                <span class="rfc2119-assertion" id="tdd-things-create-anonymous-id">
                                    The directory <em class="rfc2119">MUST</em> assign a local identifier to any <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-5">Anonymous TD</a>
                                    to enable local management and retrieval from the directory.</span>
                                The scheme of the system-generated ID is described in <a href="#exploration-directory-anonymous-td" data-matched-text="[[[#exploration-directory-anonymous-td]]]" class="sec-ref"><bdi class="secno">7.3.1.3 </bdi>Anonymous TD Identifiers</a>.

                                <span class="rfc2119-assertion" id="tdd-things-create-anonymous-td-resp">
                                    Upon successful processing, the server <em class="rfc2119">MUST</em> respond with 201 (Created) status
                                    and a Location header containing the system-generated URI of created TD resource.</span>
                                The system-generated URI includes the system-generated identifier of the TD and
                                can be used subsequently to query the TD from the directory.

                                <p>
                                    The create operation for <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-6">Anonymous TDs</a> is specified as <code>createAnonymousThing</code> action in
                                    <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                                </p>
                            </li>
                        </ul>

                        <p>
                            A server that supports expirable TDs will realize such functionality
                            as described in <a href="#exploration-directory-registration-expiry" data-matched-text="[[[#exploration-directory-registration-expiry]]]" class="sec-ref"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a>.
                            In particular, if <code>ttl</code> (relative expiry) is given during the creation,
                            such servers will calculate and store the <code>expires</code> value.
                        </p>
                    </section>

                    <section id="exploration-directory-api-things-retrieval" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-2-retrieval"><bdi class="secno">7.3.2.1.2 </bdi>Retrieval</h6><a class="self-link" href="#exploration-directory-api-things-retrieval" aria-label="Permalink for Section 7.3.2.1.2"></a></div>
                        
                        <p>
                            <span class="rfc2119-assertion" id="tdd-things-retrieve">
                                The retrieval of an existing TD <em class="rfc2119">MUST</em> be done using an HTTP <code>GET</code> request
                                at <code>/things/{id}</code> endpoint, where <code>id</code> is the unique TD identifier.</span>
                            <span class="rfc2119-assertion" id="tdd-things-retrieve-resp">
                                A successful response <em class="rfc2119">MUST</em> have 200 (OK) status and the requested TD in the body.</span>
                            <span class="rfc2119-assertion" id="tdd-things-retrieve-resp-content-type">
                                A successful response with JSON serialization <em class="rfc2119">MUST</em> contain either <code>application/json</code>
                                or <code>application/td+json</code> in the Content-Type header.</span>
                            Here <code>application/td+json</code> is preferred as it is 
                            more specific and implies <code>application/json</code>.
                            Note that the default serialization is JSON with JSON-LD syntax,
                            and alternative serializations can be negotiated; see <a href="#exploration-directory-api-things" data-matched-text="[[[#exploration-directory-api-things]]]" class="sec-ref"><bdi class="secno">7.3.2.1 </bdi>Things API</a>.
                            </p><p>
                                The retrieve operation is specified as <code>retrieveThing</code> action in 
                                <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                            </p>
                        <p></p>

                        <p>
                            The following is an example of a retrieved TD:
                        </p>
                            <aside class="example" id="example-enriched-td"><div class="marker">
    <a class="self-link" href="#example-enriched-td">Example<bdi> 4</bdi></a><span class="example-title">: Example Enriched TD</span>
  </div>
                                <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"urn:example:simple-td"</span>,
    <span class="hljs-attr">"security"</span>: <span class="hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class="hljs-string">"basic"</span>
        }
    },
    <span class="hljs-attr">"registration"</span>: {
        <span class="hljs-attr">"created"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>,
        <span class="hljs-attr">"modified"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>
    },
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Simple TD"</span>
}</code></pre>
                                <div class="issue" id="issue-container-number-148-2"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="7"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                                    The context URIs are tentative and subject to change.
                                </div></div>                    
                            </aside>
                            <p>
                            This is an <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-4">Enriched TD</a> which includes the registration information
                            such as the creation and modification time of the TD within the directory.
                        </p>
                        
                        <p>
                            The example below shows a retrieved <a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-anonymous-thing-description-7">Anonymous TD</a> that is in
                            <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-5">Enriched TD</a> form and has local identifier <code>urn:uuid:48951ff3-4019-4e67-b217-dbbf011873dc</code>.
                        </p>
                            <aside class="example" id="example-anonymous-enriched-td"><div class="marker">
    <a class="self-link" href="#example-anonymous-enriched-td">Example<bdi> 5</bdi></a><span class="example-title">: Example Enriched Anonymous TD</span>
  </div>
                                <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"urn:uuid:48951ff3-4019-4e67-b217-dbbf011873dc"</span>,
    <span class="hljs-attr">"security"</span>: <span class="hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class="hljs-string">"basic"</span>
        }
    },
    <span class="hljs-attr">"registration"</span>: {
        <span class="hljs-attr">"created"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>,
        <span class="hljs-attr">"modified"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>
    },
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Anonymous TD"</span>
}</code></pre>
                                <div class="issue" id="issue-container-number-148-3"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="7"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                                    The context URIs are tentative and subject to change.
                                </div></div>                    
                            </aside>

                        <p>

                            The following is an example of a retrieved TD that was registered with a relative
                            expiry time of 3600 seconds (one hour). The server has calculated the absolute expiry time as 
                            one hour after the modification time.
                            </p>
                            <aside class="example" id="example-expirable-enriched-td"><div class="marker">
    <a class="self-link" href="#example-expirable-enriched-td">Example<bdi> 6</bdi></a><span class="example-title">: Example Expirable Enriched TD</span>
  </div>
                                <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"id"</span>: <span class="hljs-string">"urn:example:expirable-td"</span>,
    <span class="hljs-attr">"security"</span>: <span class="hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class="hljs-string">"basic"</span>
        }
    },
    <span class="hljs-attr">"registration"</span>: {
        <span class="hljs-attr">"created"</span>: <span class="hljs-string">"2021-05-10T16:00:00Z"</span>,
        <span class="hljs-attr">"modified"</span>: <span class="hljs-string">"2021-05-10T17:00:00Z"</span>,
        <span class="hljs-attr">"expires"</span>: <span class="hljs-string">"2021-05-10T18:00:00Z"</span>,
        <span class="hljs-attr">"ttl"</span>: <span class="hljs-number">3600</span>,
        <span class="hljs-attr">"retrieved"</span>: <span class="hljs-string">"2021-05-10T17:35:00Z"</span>
    },
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Expirable TD"</span>
}</code></pre>
                                <div class="issue" id="issue-container-number-148-4"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="7"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                                    The context URIs are tentative and subject to change.
                                </div></div>                    
                            </aside>
                            <p>
                            For the sake of readability, the time values in this example are set to exact numbers.
                            In realistic settings, time values may include fractions.
                        </p>

                    </section>

                    <section id="exploration-directory-api-things-update" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-3-update"><bdi class="secno">7.3.2.1.3 </bdi>Update</h6><a class="self-link" href="#exploration-directory-api-things-update" aria-label="Permalink for Section 7.3.2.1.3"></a></div>
                        
                        <p>
                            The update operations are to replace or partially modify an existing TD.
                        </p>
                        <p>
                            The update operations are described below:
                        </p>

                        <ul>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-update">
                                    A modified TD <em class="rfc2119">MUST</em> replace an existing one when submitted using an HTTP <code>PUT</code> request
                                    at <code>/things/{id}</code> endpoint, where <code>id</code> is the identifier of the existing TD.</span>
                                <span class="rfc2119-assertion" id="tdd-things-update-contenttype">
                                    The request <em class="rfc2119">SHOULD</em> contain <code>application/td+json</code> Content-Type header for JSON
                                    serialization of TD.</span>
                                The TD object is validated in accordance with <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
                                <span class="rfc2119-assertion" id="tdd-things-update-resp">
                                    Upon success, the server <em class="rfc2119">MUST</em> respond with 204 (No Content) status.</span>

                                <p>
                                    This operation is specified as <code>updateThing</code> property in 
                                    <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                                </p>

                                <p>
                                    A server that supports expirable TDs will realize such functionality
                                    as described in <a href="#exploration-directory-registration-expiry" data-matched-text="[[[#exploration-directory-registration-expiry]]]" class="sec-ref"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a>.
                                    If <code>ttl</code> (relative expiry) is set during the update operation,
                                    the server will calculate and set the <code>expires</code> (absolute expiry) value.
                                </p>

                                <p>
                                    Note: If the target location does not correspond to an existing TD,
                                    the request shall instead proceed as a Create operation and respond
                                    the appropriate status code (see Create section). In other words, an HTTP <code>PUT</code>
                                    request acts as a create or update operation.
                                </p>
                            </li>
                            <li>
                                <span class="rfc2119-assertion" id="tdd-things-update-partial">
                                    An existing TD <em class="rfc2119">MUST</em> be partially modified when the modified parts are submitted using an 
                                    HTTP <code>PATCH</code> request
                                    at <code>/things/{id}</code> endpoint, where <code>id</code> is the identifier of the existing TD.</span>
                                <span class="rfc2119-assertion" id="tdd-things-update-partial-mergepatch">
                                    The partial update <em class="rfc2119">MUST</em> be processed using the JSON merge patch
                                    format described in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7396" title="JSON Merge Patch">RFC7396</a></cite>].</span>
                                <span class="rfc2119-assertion" id="tdd-things-update-partial-contenttype">
                                    The request <em class="rfc2119">MUST</em> contain <code>application/merge-patch+json</code> Content-Type header for JSON
                                    serialization of the merge patch document.</span>
                                <span class="rfc2119-assertion" id="tdd-things-update-partial-partialtd">
                                    The input <em class="rfc2119">MUST</em> be in <a href="#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-partial-thing-description-1">Partial TD</a> form and conform to the
                                    original TD structure.</span>
                                
                                If the input contains members that appear in the original TD, 
                                their values are replaced. If a member does not appear in the 
                                original TD, that member is added. If the member is set to <code>null</code> 
                                but appear in the original TD, that member is removed. 
                                Members with object values are processed recursively.
                                
                                After applying the modifications, the TD object is validated in accordance with <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
                                <span class="rfc2119-assertion" id="tdd-things-update-partial-resp">
                                    Upon success, the server <em class="rfc2119">MUST</em> respond with a 204 (No Content) status.</span>

                                <p>
                                    This operation is specified as <code>partiallyUpdateThing</code> property in 
                                    <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                                </p>

                                <p>
                                    A server that supports expirable TDs will realize such functionality
                                    as described in <a href="#exploration-directory-registration-expiry" data-matched-text="[[[#exploration-directory-registration-expiry]]]" class="sec-ref"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a>.
                                    During the partial update operation, if the resulting <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-42">TD</a> has 
                                    <code>ttl</code> (relative expiry), the server will calculate and set a new
                                    <code>expires</code> (absolute expiry) value.
                                </p>
                                
                                <p>
                                    A patch operation is particularly useful to efficiently extend the expiry of
                                    a registration that uses a <code>ttl</code> (relative expiry) value.
                                    This is typically done by submitting an empty merge patch document,
                                    i.e. an empty JSON object.
                                    This effectively translates to performing a partial update operation that
                                    updates nothing, but triggers the recalculation of <code>expires</code> (absolute expiry) value.
                                    This expiry functionality only works if the server supports it as defined in
                                    <a href="#exploration-directory-registration-expiry" data-matched-text="[[[#exploration-directory-registration-expiry]]]" class="sec-ref"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a>.
                                </p>

                                <p>
                                    The following example is a merge patch document to update only the
                                    <code>base</code> and registration <code>expires</code> fields of a TD:
                                </p>
                                    <aside class="example" id="example-patch-enriched-td"><div class="marker">
    <a class="self-link" href="#example-patch-enriched-td">Example<bdi> 7</bdi></a><span class="example-title">: Example merge patch document</span>
  </div>
                                        <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"base"</span>: <span class="hljs-string">"http://192.168.0.2/"</span>,
    <span class="hljs-attr">"registration"</span>: {
        <span class="hljs-attr">"expires"</span>: <span class="hljs-string">"2021-01-20T17:02:00Z"</span>
    }
}</code></pre> 
                                        This is a valid way of extending the absolute expiry only if the stored
                                        TD has no <code>ttl</code> (relative expiry).
                                        For more details, refer to <a href="#exploration-directory-registration-expiry" data-matched-text="[[[#exploration-directory-registration-expiry]]]" class="sec-ref"><bdi class="secno">7.3.1.2 </bdi>Registration Expiry</a>.                   
                                    </aside>
                            </li>
                        </ul>

                    </section>

                    <section id="exploration-directory-api-things-deletion" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-4-deletion"><bdi class="secno">7.3.2.1.4 </bdi>Deletion</h6><a class="self-link" href="#exploration-directory-api-things-deletion" aria-label="Permalink for Section 7.3.2.1.4"></a></div>
                        
                        <p>
                            <span class="rfc2119-assertion" id="tdd-things-delete">
                                A delete operation <em class="rfc2119">MUST</em> be done using an HTTP <code>DELETE</code> request
                                at <code>/things/{id}</code>, where <code>id</code> is the identifier of the existing TD.</span>
                            <span class="rfc2119-assertion" id="tdd-things-delete-resp">
                                A successful response <em class="rfc2119">MUST</em> have 204 (No Content) status.</span>
                            The retrieve operation is specified as <code>deleteThing</code> property in
                            <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                        </p>

                    </section>

                    <section id="exploration-directory-api-things-listing" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-5-listing"><bdi class="secno">7.3.2.1.5 </bdi>Listing</h6><a class="self-link" href="#exploration-directory-api-things-listing" aria-label="Permalink for Section 7.3.2.1.5"></a></div>
                        
            <p class="at-risk">The sorting mechanism described in this
            section is at risk.</p>
                        <p>
                            The listing endpoint provides different ways to query the collection of full TD objects
                            from the directory.
                        </p>
                        <p>
                            In many scenarios, retrieving parts instead of full TD objects is preferred because
                            only a subset of elements are needed (e.g. <code>id</code> and <code>href</code> of a property for all TDs)
                            and to save networking resources. The Search API allows querying parts of TD objects;
                            see <a href="#exploration-directory-api-search" data-matched-text="[[[#exploration-directory-api-search]]]" class="sec-ref"><bdi class="secno">7.3.2.3 </bdi>Search API</a>.
                        </p>
                        
                            
                        <p>
                            <span class="rfc2119-assertion" id="tdd-things-list-method">
                                The directory <em class="rfc2119">MUST</em> allow retrieval of existing TDs using HTTP <code>GET</code> requests
                                at the <code>/things</code> endpoint.</span>
                        
                            <span class="rfc2119-assertion" id="tdd-things-list-resp">
                                A successful response <em class="rfc2119">MUST</em> have 200 (OK) status and an array of TDs in the body.</span>
                            <span class="rfc2119-assertion" id="tdd-things-list-resp-content-type">
                                A successful response with JSON serialization <em class="rfc2119">MUST</em> contain either <code>application/json</code>
                                or <code>application/ld+json</code> in the Content-Type header.</span>
                            Here <code>application/ld+json</code> is preferred as it is 
                            more specific and implies <code>application/json</code>.
                            Note that the default serialization is JSON with JSON-LD syntax,
                            and alternative serializations can be negotiated; see <a href="#exploration-directory-api-things" data-matched-text="[[[#exploration-directory-api-things]]]" class="sec-ref"><bdi class="secno">7.3.2.1 </bdi>Things API</a>.
                        </p>

                        <p>
                            There may be scenarios in which clients need to retrieve the collection
                            in small subsets of TDs. 
                            While the Search API (<a href="#exploration-directory-api-search" data-matched-text="[[[#exploration-directory-api-search]]]" class="sec-ref"><bdi class="secno">7.3.2.3 </bdi>Search API</a>)
                            does offer the ability to query a specific range, it may not be optimal,
                            nor developer-friendly.
                            
                            <span class="rfc2119-assertion" id="tdd-things-list-pagination">
                                The server <em class="rfc2119">MAY</em> support pagination to return the collection
                                in small subsets.</span>
                            The pagination must be based on the following rules:
                            </p>
                            <ul>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-limit">
                                        When the <code>limit</code> query parameter is set to a positive integer,
                                        the server <em class="rfc2119">MAY</em> respond with a subset of TDs totalling
                                        to less than or equal to the requested number.</span>
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-header-nextlink">
                                        When there are more TDs after a returned subset of the collection,
                                        the response <em class="rfc2119">MUST</em> contain a <code>next</code> Link header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>]
                                        with the URL of the next subset.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-header-nextlink-attr">
                                        The <code>next</code> link <em class="rfc2119">MUST</em> include all arguments needed to produce the same set of
                                        data and its ordering, in particular the same <code>limit</code> argument
                                        given on the initial request as well as a zero-based <code>offset</code> argument anchored
                                        at the beginning of the next subset.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-header-nextlink-base">
                                        The link <em class="rfc2119">MUST</em> be absolute or relative to directory API's base URL.</span>
                                    Moreover, it may include additional arguments that are necessary for
                                    ordering or session management.
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-header-canonicallink">
                                        All paged responses <em class="rfc2119">MUST</em> contain a <code>canonical</code> Link header [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title="Web Linking">RFC8288</a></cite>]
                                        pointing to the collection and include an <code>etag</code> parameter to represent
                                        the current state of the collection.</span>
                                    The link may be absolute or relative to directory API's base URL.
                                    The <code>etag</code> value could be a revision number, timestamp, or UUID Version 4,
                                    set whenever the TD collection changes in a way that affects the
                                    ordering of the TDs. 
                                    The clients may rely on the <code>etag</code> value to know whether the collection
                                    remains consistent across paginated retrieval of the collection.
                                    For example, creation or deletion of TDs or update of TD fields used for
                                    ordering may shift the calculated paging window.
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-order-default">
                                        By default, the collection <em class="rfc2119">MUST</em> be sorted using UTF-8 lexicographical order
                                        by the unique identifier of TDs.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-order">
                                        The server <em class="rfc2119">MAY</em> support sorting by other TD attributes using
                                        query arguments: <code>sort_by</code> to select a field (e.g. <code>created</code>)
                                        and <code>sort_order</code> to choose the order
                                        (i.e. <code>asc</code> or <code>desc</code> for ascending and descending ordering).</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-orderable">
                                        A server <em class="rfc2119">MUST</em> reject requests to sort on fields that do not have 
                                        values that are orderable basic types.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-order-unsupported">
                                        If the server does not support custom sorting,
                                        it <em class="rfc2119">MUST</em> reject the request.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-order-nextlink">
                                        If sorting attributes are accepted, they <em class="rfc2119">MUST</em> be added consistently to all <code>next</code> links.</span>
                                    <span class="rfc2119-assertion" id="tdd-things-list-pagination-order-utf-8">
                                        Sorting order <em class="rfc2119">MUST</em> always be defined using lexicographical ordering on
                                        a UTF-8 encoding of the relevant fields.</span>
                                </li>
                            </ul>
                            <p>
                                This above specification follows a subset of Linked Data Paging [<cite><a class="bibref" data-link-type="biblio" href="#bib-ldp-paging" title="Linked Data Platform Paging 1.0">LDP-Paging</a></cite>]
                                to allow optional pagination of the JSON-LD array.
                                Additional parts of Linked Data Paging may be implemented for examples
                                to honour client's query preference or to add other link relations for semantic
                                annotation and alternative navigation links.
                            </p>
                            <p>                            
                            The following example provides a walk-through of the paginated
                            retrieval of TDs:
                            </p>
                            <aside class="example" id="example-pagination"><div class="marker">
    <a class="self-link" href="#example-pagination">Example<bdi> 8</bdi></a><span class="example-title">: Query all TDs with page size 10.</span>
  </div>
                                The client requests the list with a <code>limit</code> of 10:
                                <pre aria-busy="false"><code class="hljs">GET /things?limit=10 HTTP/1.1   
Host: tdd.example.com</code></pre>
                                Response:
                                <pre aria-busy="false"><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/ld+json
<span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;/things?offset=10&amp;limit=10&gt;; rel="next"
<span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;/things&gt;; rel="canonical"; etag="v1"

<span class="css"><span class="hljs-selector-attr">[{ TD }, ...9 other TDs... ]</span></span></code></pre>
                                The response includes two Link headers with relative URLs:
                                <code>next</code> link to query the remaining TDs,
                                <code>canonical</code> link referencing the full collection with <code>etag</code> value indicating
                                the state of that collection.
                                <br>
                                The response body is an array of 10 TDs.
                                
                                <br><br>
                                The presence of the <code>next</code> link implies that subsequent pages should be
                                queried for the remaining TDs.
                                The client requests the next page via the <code>next</code> link:
                                <pre aria-busy="false"><code class="hljs">GET /things?offset=10&amp;limit=10 HTTP/1.1   
Host: tdd.example.com</code></pre>

                                Response:
                                <pre aria-busy="false"><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/ld+json
<span class="hljs-attribute">Link</span><span class="hljs-punctuation">: </span>&lt;/things&gt;; rel="canonical"; etag="v1"

<span class="css"><span class="hljs-selector-attr">[{ TD }, { TD }]</span></span></code></pre>
                                The server response has the remaining two TDs. There is no <code>next</code> link,
                                because this is the last page. The <code>etag</code> value has not changed implying
                                that the collection has remained consistent between the two requests.
                                <br><br>
                                The client has retrieved the whole collection, containing 12 TDs.
                            </aside>

			<p>
				<span class="rfc2119-assertion" id="tdd-things-list-pagination-collection">
					As an alternative to an array of TDs as the body of the response, the server <em class="rfc2119">MAY</em>
					send a more verbose payload allowing server-side information, such as pagination
					information, to be included in addition to the actual data.</span>
			</p>

			<p>
				The alternative pagination format is derived from
				<a href="https://www.hydra-cg.com/spec/latest/core/#advanced-concepts">
				Hydra Advanced Concepts</a>, more concretely the
				<a href="https://www.hydra-cg.com/spec/latest/core/#example-20-a-hydra-partialcollectionview-splits-a-collection-into-multiple-views">
				Partial Collection View</a>. Adapted to our purposes and using the <i>members</i> field to accomodate the array
				of TDs, it looks as follows for the listing endpoint:
			</p>
				<aside class="example" id="example-alternative-payload"><div class="marker">
    <a class="self-link" href="#example-alternative-payload">Example<bdi> 9</bdi></a><span class="example-title">: Alternative payload format including pagination information</span>
  </div>
					<pre aria-busy="false"><code class="hljs javascript">{
	<span class="hljs-string">"@context"</span>: <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>,
	<span class="hljs-string">"@type"</span>: <span class="hljs-string">"ThingCollection"</span>,
	<span class="hljs-string">"total"</span>: <span class="hljs-number">12</span>,
	<span class="hljs-string">"members"</span>: [
		{ TD },
		<span class="hljs-number">9</span> other TDs...
	],
	<span class="hljs-string">"@id"</span>: <span class="hljs-string">"/things?offset=0&amp;limit=10&amp;format=collection"</span>,
	<span class="hljs-string">"next"</span>: <span class="hljs-string">"/things?offset=10&amp;limit=10&amp;format=collection"</span>
}</code></pre>                    
				</aside>

			<p>
				To tell the server which format to send, the additional query parameter <code>?format=array|collection</code>
				can be added to the request. <code>?format=array</code> is the default parameter, does not have to be provided
				explicitly, and yields to a server response of the pure array of TDs. <code>?format=collection</code>
				should yield to a server response with the format as described in <a href="#example-alternative-payload" data-matched-text="[[[#example-alternative-payload]]]" class="box-ref">Example<bdi> 9</bdi></a>.
			</p>

                        <p>    
                            The listing operation is specified as <code>things</code> property in 
                            <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                        </p>
                        
                    </section>

                    <section id="exploration-directory-api-things-validation" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-1-6-validation"><bdi class="secno">7.3.2.1.6 </bdi>Validation</h6><a class="self-link" href="#exploration-directory-api-things-validation" aria-label="Permalink for Section 7.3.2.1.6"></a></div>
                        
                        <p>
                           <span class="rfc2119-assertion" id="tdd-validation-syntactic">
                                The syntactic validation of TD objects before storage is <em class="rfc2119">RECOMMENDED</em> to
                                prevent common erroneous submissions.</span>
    
                            <span class="rfc2119-assertion" id="tdd-validation-jsonschema">
				The server <em class="rfc2119">SHOULD</em> use at least 
				<a href="https://www.w3.org/TR/wot-thing-description11/#minimal-validation-serialization-json">Minimal Validation</a> 
				as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>]
                                to validate TDs, including use of the
				<a href="https://www.w3.org/TR/wot-thing-description/#json-schema-for-validation">WoT Thing Description (1.0) JSON Schema</a> or
                                <a href="https://www.w3.org/TR/wot-thing-description11/#json-schema-for-validation">WoT Thing Description 1.1 JSON Schema</a>,
				and the JSON schema defined in <a href="#tdd-extensions-jsonschema" data-matched-text="[[[#tdd-extensions-jsonschema]]]" class="sec-ref"><bdi class="secno">A. </bdi>JSON Schema for WoT Discovery TD-extensions</a> for <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-6">Enriched TDs</a>,
				as appropriate based on the value of the <code>@context</code>.</span>
                        </p>
                        <p>
                            Additional forms of validation can be added to support various use cases.
                            For example, a use case may require stateful validation of the input TDs to ensure that
                            the <code>version</code> value is initialized and updated according to pre-defined rules.
                        </p>
                        <p>
                            <span class="rfc2119-assertion" id="tdd-validation-result">
                                If the server fails to validate the TD object, it <em class="rfc2119">MUST</em> inform the client
                                with necessary details to identify and resolve the errors.</span>
    
                            <span class="rfc2119-assertion" id="tdd-validation-response">
                                The validation error <em class="rfc2119">MUST</em> be described as Problem Details [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7807" title="Problem Details for HTTP APIs">RFC7807</a></cite>]
                                with an extension field called <code>validationErrors</code>, set to an array of objects
                                with <code>field</code> and <code>description</code> fields.</span>
                            This is necessary to represent the error in a machine-readable way. 
                            <span class="rfc2119-assertion" id="tdd-validation-response-utf-8">
                                All validation error responses described using Problem Details <em class="rfc2119">MUST</em> be encoded using UTF-8.</span>
                            <span class="rfc2119-assertion" id="tdd-validation-response-lang">
                                Validation error responses <em class="rfc2119">MAY</em> report details in different languages using
                                proactive negotiation, if the <code>Accept-Language</code> header field has been
                                set in the HTTP request [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7231" title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">RFC7231</a></cite>].</span>
                        </p>
                        <p>
                        <a href="#example-validation-error" data-matched-text="[[[#example-validation-error]]]" class="box-ref">Example<bdi> 10</bdi></a> is an example error response with two validation errors.
                        </p>
                        <aside class="example" id="example-validation-error"><div class="marker">
    <a class="self-link" href="#example-validation-error">Example<bdi> 10</bdi></a><span class="example-title">: Example validation error response</span>
  </div>
                            <pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Bad Request"</span>,
    <span class="hljs-attr">"status"</span>: <span class="hljs-number">400</span>,
    <span class="hljs-attr">"detail"</span>: <span class="hljs-string">"The input did not pass the JSON Schema validation"</span>,
    <span class="hljs-attr">"instance"</span>: <span class="hljs-string">"/errors/30585584-cce2-4d04-8079-67b33ffdafbc"</span>,
    <span class="hljs-attr">"validationErrors"</span>: [
        {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"(root)"</span>,
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"security is required"</span>
        },
        {
            <span class="hljs-attr">"field"</span>: <span class="hljs-string">"properties.status.forms.0.href"</span>,
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid type. Expected: string, given: integer"</span>
        }
    ]
}</code></pre>

                        </aside>
                    </section>

                </section>
                <section id="exploration-directory-api-notification" class="normative"><div class="header-wrapper"><h5 id="x7-3-2-2-events-api"><bdi class="secno">7.3.2.2 </bdi>Events API</h5><a class="self-link" href="#exploration-directory-api-notification" aria-label="Permalink for Section 7.3.2.2"></a></div>
                    
                    <p>
                        The Notification API is to notify clients about the changes
                        to <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-43">TDs</a> maintained within the directory.
                        <span class="rfc2119-assertion" id="tdd-notification">
                            Directories <em class="rfc2119">MAY</em> implement the Notification API.</span>
                    </p>
                    <p>
                        
                        <span class="rfc2119-assertion" id="tdd-notification-sse">
                            The Notification API <em class="rfc2119">MUST</em> follow the Server-Sent Events (SSE) [<cite><a class="bibref" data-link-type="biblio" href="#bib-eventsource" title="Server-Sent Events">EVENTSOURCE</a></cite>]
                            specifications to serve events to clients
                            at <code>/events</code> endpoint.</span>
                        In particular, the server responds to successful requests with 200 (OK) status
                        and <code>text/event-stream</code> Content Type.
                        Re-connecting clients may continue from
                        the last event by providing the last event ID as <code>Last-Event-ID</code> header value.
                        <span class="rfc2119-assertion" id="tdd-notification-event-id">
                            The server <em class="rfc2119">SHOULD</em> provide an event ID as the <code>id</code> field in each event
                            and respond to re-connecting clients by delivering all missed events.</span>
                    </p>
                    <p>
                        The rest of this section describes the implementation details on top of the SSE protocol.
                        Realizing the notification functionality using other protocols such as
                        MQTT are possible and may be formalized in future versions of this specification.
                    </p>

                    <dl>
                        <dt>Event Types</dt>
                        <dd>
                            <span class="rfc2119-assertion" id="tdd-notification-event-types">
                                The server <em class="rfc2119">MUST</em> produce events attributed to the lifecycle of 
                                the Thing Descriptions within the directory using 
                                <code>thing_created</code>, <code>thing_updated</code>, and <code>thing_deleted</code> event types.</span>
                        </dd>

                        <dt>Event Filtering</dt>
                        <dd>
                            The API enables server-side filtering of events to reduce resource consumption
                            by delivering only the events required by clients.
                            Client libraries may offer additional filtering capabilities on
                            the client-side.

                            <p>
                                <span class="rfc2119-assertion" id="tdd-notification-filter-type">
                                    The server <em class="rfc2119">MUST</em> support event filtering based on the 
                                    event type given by the client upon subscription.</span>
                            </p>
                            <p>
                                For example, given the URI Template <code>/events{/type}</code>:
                            </p>
                                <ul>
                                    <li>
                                        <code>/events/thing_created</code> instructs the server to only deliver events of
                                        type <code>thing_created</code>
                                    </li>
                                    <li>
                                        <code>/events</code> instructs the server to deliver all events
                                    </li>
                                </ul>
                           <p>
                                The clients need to subscribe separately to receive a subset of
                                the events (e.g. only <code>thing_created</code> and <code>thing_deleted</code>) from the server. 
                                When using HTTP/2, multiple subscriptions on the same domain (HTTP streams) 
                                get multiplexed on a single connection.
                            </p>


                        </dd>
                        <dt>Event Data</dt>
                        <dd><p>
            </p><p class="at-risk">The <code>diff</code> query parameter 
            and mechanism described in this
            section is at risk.</p>
                            <span class="rfc2119-assertion" id="tdd-notification-data">
                                The event data <em class="rfc2119">MUST</em> contain the JSON serialization of the event object.</span>
                            The event data object is a <a href="#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-partial-thing-description-2">Partial TD</a> or the whole <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-44">TD</a> object
                            depending on the request:
                            <p></p>
                            <ul>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-td-id">
                                        The event data object <em class="rfc2119">MUST</em> at least include the identifier of the
                                        TD created, updated, or deleted at that event in <a href="#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-partial-thing-description-3">Partial TD</a> form.</span>

                                    <aside class="example" id="example-creation-and-deletion-sse-events-for-a-td"><div class="marker">
    <a class="self-link" href="#example-creation-and-deletion-sse-events-for-a-td">Example<bdi> 11</bdi></a><span class="example-title">: Creation and deletion SSE events for a TD</span>
  </div>
                                        <pre aria-busy="false"><code class="hljs css">event: thing_created
data: {<span class="hljs-string">"id"</span>: <span class="hljs-string">"urn:example:simple-td"</span>}
id: event_1

event: thing_deleted
data: {<span class="hljs-string">"id"</span>: <span class="hljs-string">"urn:example:simple-td"</span>}
id: event_2</code></pre>
                                    </aside>
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-create-full">
                                        When <code>diff</code> query parameter is set to <code>true</code> and the event has <code>thing_created</code> type,
                                        the server <em class="rfc2119">MAY</em> return the whole TD object as event data.</span>
                                    
                                    <aside class="example" id="example-create-event-full"><div class="marker">
    <a class="self-link" href="#example-create-event-full">Example<bdi> 12</bdi></a><span class="example-title">: Full creation SSE event for a TD</span>
  </div>
                                        <pre aria-busy="false"><code class="hljs css">event: thing_created
data: {
data:     <span class="hljs-string">"@context"</span>: [
data:         <span class="hljs-string">"https://www.w3.org/2019/wot/td/v1"</span>,
data:         <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
data:     ],
data:     <span class="hljs-string">"description"</span>: <span class="hljs-string">"This is a new TD"</span>,
data:     <span class="hljs-string">"id"</span>: <span class="hljs-string">"urn:example:simple-td"</span>,
data:     <span class="hljs-string">"security"</span>: <span class="hljs-string">"basic_sc"</span>,
data:     <span class="hljs-string">"securityDefinitions"</span>: {
data:         <span class="hljs-string">"basic_sc"</span>: {
data:             <span class="hljs-string">"scheme"</span>: <span class="hljs-string">"basic"</span>
data:         }
data:     },
data:     <span class="hljs-string">"registration"</span>: {
data:         <span class="hljs-string">"created"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>,
data:         <span class="hljs-string">"modified"</span>: <span class="hljs-string">"2021-01-19T17:02:00Z"</span>
data:     },
data:     <span class="hljs-string">"title"</span>: <span class="hljs-string">"Simple TD"</span>
data: }
id: event_1</code></pre>
                                        <div class="issue" id="issue-container-number-148-5"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="6"><a href="https://github.com/w3c/wot-discovery/issues/148"><span class="issue-number">Issue 148</span></a><span class="issue-label">: Discovery context and namespace under w3.org/ns <a class="respec-gh-label" href="https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22resolve+by+PR%22" style="background-color: rgb(245, 73, 223); color: rgb(0, 0, 0);" aria-label="GitHub label: resolve by PR">resolve by PR</a></span></div><div class="">
                                            The context URIs are tentative and subject to change.
                                        </div></div>
                                    </aside>
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-update-diff">
                                        When <code>diff</code> query parameter is set to <code>true</code> and the event has <code>thing_updated</code> type,
                                        the server <em class="rfc2119">MAY</em> inform the client about the updated parts following the
                                        JSON Merge Patch [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7396" title="JSON Merge Patch">RFC7396</a></cite>] format.</span>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-update-id">
                                        A <code>thing_updated</code> event data that is based on JSON Merge Patch [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7396" title="JSON Merge Patch">RFC7396</a></cite>]
                                        <em class="rfc2119">MUST</em> always include the identifier of the TD regardless of whether it
                                        is changed.</span>

                                    <p>
                                        The following example shows the event triggered on update of the TD from <a href="#example-create-event-full" data-matched-text="[[[#example-create-event-full]]]" class="box-ref">Example<bdi> 12</bdi></a>:
                                        </p><aside class="example" id="example-update-event-full"><div class="marker">
    <a class="self-link" href="#example-update-event-full">Example<bdi> 13</bdi></a><span class="example-title">: Full update SSE event for a TD with removed description and changed title</span>
  </div>
                                            <pre aria-busy="false"><code class="hljs css">event: thing_updated
data: {
data:     <span class="hljs-string">"description"</span>: null,
data:     <span class="hljs-string">"id"</span>: <span class="hljs-string">"urn:example:simple-td"</span>,
data:     <span class="hljs-string">"title"</span>: <span class="hljs-string">"Updated TD"</span>
data: }
id: event_3</code></pre>
                                        </aside>
                                    <p></p>
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-delete-diff">
                                        The <code>diff</code> query parameter <em class="rfc2119">MUST</em> be ignored for <code>thing_deleted</code> events.</span>
                                    In other words, the server shall not include additional properties in
                                    the payload of <code>thing_deleted</code> events when <code>diff</code> is set to <code>true</code>. 
                                </li>
                                <li>
                                    <span class="rfc2119-assertion" id="tdd-notification-data-diff-unsupported">
                                        When a server which does not support the <code>diff</code> query parameter 
                                        is requested with such query parameter, it <em class="rfc2119">MUST</em>
                                        reject the request.
                                    </span>
                                    This is to inform the clients about the lack of such functionality at the
                                    connection time to avoid runtime exceptions caused by missing
                                    event data attributes.
                                </li>
                            </ul>
                        </dd>
                    </dl>
                    <p>
                        The Notification API is specified as three event affordances in
                        <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>, namely:
                        <code>thingCreated</code>, <code>thingUpdated</code>, and <code>thingDeleted</code>.
                    </p>

                    <div class="note" id="issue-container-generatedID-1"><div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="6"><span>Editor's note</span><span class="issue-label">: SSE Authorization Header</span></div><p class="">
                        Some early SSE implementations (including HTML5 EventSource) do not allow
                        setting custom headers in the initial HTTP request. Authorization header 
                        is required in few OAuth2 flows and passing it as a query parameter is
                        <a href="https://tools.ietf.org/html/rfc6750#section-2.3">not advised</a>.

                        There are polyfills for browsers and modern libraries which allow 
                        setting Authorization header.
                    </p></div>
                    

                </section>
                <section id="exploration-directory-api-search" class="normative"><div class="header-wrapper"><h5 id="x7-3-2-3-search-api"><bdi class="secno">7.3.2.3 </bdi>Search API</h5><a class="self-link" href="#exploration-directory-api-search" aria-label="Permalink for Section 7.3.2.3"></a></div>
                    
                    
                    <div class="note" id="issue-container-generatedID-2"><div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="6"><span>Editor's note</span><span class="issue-label">: Search API Overview</span></div><p class="">
                        Sub-API to search a directory, e.g. issue a query.
                        There are different forms and levels of query possible, for example,
                        syntactic (JSONPath, XPath) vs. semantic (SPARQL), 
                        and the more advanced query types may not be 
                        supported by all directories.   
                        So this API will have further subsections,
                        some of which will be optional.
                        Search also includes a sub-API for managing listing the contents (e.g. returned by
                        a query) including handling pagination, etc.
                        Note that one special form of query will be able to return everything.
                        Results may be subject to the requestor's authorization.
                        <br>
                        To discuss further:
                        Federated queries to other TDDs, Spatial and network-limited queries, Links
                    </p></div>
                    This specification describes three search APIs: syntactic search with JSONPath [<cite><a class="bibref" data-link-type="biblio" href="#bib-jsonpath" title="JSONPath: Query expressions for JSON">JSONPATH</a></cite>],
                    syntactic search with XPath [<cite><a class="bibref" data-link-type="biblio" href="#bib-xpath-31" title="XML Path Language (XPath) 3.1">xpath-31</a></cite>], and semantic search with SPARQL [<cite><a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title="SPARQL 1.1 Overview">sparql11-overview</a></cite>].
                    <span class="rfc2119-assertion" id="tdd-search-sparql">
                        The Directory <em class="rfc2119">MAY</em> implement semantic search with SPARQL.</span>
                    JSONPath and XPath are informative and subject to change.
                    <p>
                        <span class="rfc2119-assertion" id="tdd-search-large-tdds">
                            It is <em class="rfc2119">RECOMMENDED</em> that directories implement a search API
                            to efficiently serve <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-45">TDs</a> based on client-specific queries.</span>
                    </p>

                    <section id="jsonpath-semantic" class="informative"><div class="header-wrapper"><h6 id="x7-3-2-3-1-syntactic-search-jsonpath"><bdi class="secno">7.3.2.3.1 </bdi>Syntactic search: JSONPath</h6><a class="self-link" href="#jsonpath-semantic" aria-label="Permalink for Section 7.3.2.3.1"></a></div><p><em>This section is non-normative.</em></p>
                        

                        Support for JSONPath Search API is optional.
                        If implemented, the JSONPath API must allow searching TDs using an HTTP <code>GET</code> request
                        at <code>/search/jsonpath?query={query}</code> endpoint, where <code>query</code> is the JSONPath expression.
                        The request must contain a valid JSONPath [<cite><a class="bibref" data-link-type="biblio" href="#bib-jsonpath" title="JSONPath: Query expressions for JSON">JSONPATH</a></cite>] as searching parameter.
                        A successful response must have 200 (OK) status, contain
                        <code>application/json</code> in the Content-Type header, and
                        a set of complete TDs or a set of TD fragments in the body.
                        The syntactic search with JSONPath is specified as <code>searchJSONPath</code> action in
                        <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.

                    </section>
                    <section id="xpath-semantic" class="informative"><div class="header-wrapper"><h6 id="x7-3-2-3-2-syntactic-search-xpath"><bdi class="secno">7.3.2.3.2 </bdi>Syntactic search: XPath</h6><a class="self-link" href="#xpath-semantic" aria-label="Permalink for Section 7.3.2.3.2"></a></div><p><em>This section is non-normative.</em></p>
                        
                        Support for XPath Search API is optional.
                        If implemented, the XPath query API must allow searching TDs using an
                        HTTP <code>GET</code> request
                        at <code>/search/xpath?query={query}</code> endpoint, where <code>query</code> is the XPath expression.
                        The request must contain a valid XPath 3.1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-xpath-31" title="XML Path Language (XPath) 3.1">xpath-31</a></cite>] as search parameter.
                        A successful response must have 200 (OK) status, contain
                        <code>application/json</code> in the Content-Type header, and
                        the query response in JSON serialization in the body.  The data schema for the response is defined implicitly by the query and the XPath specification.
                        
                        The syntactic search with XPath is specified as <code>searchXPath</code> action in
                        <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                    
                    </section>
                    <section id="search-semantic" class="normative"><div class="header-wrapper"><h6 id="x7-3-2-3-3-semantic-search-sparql"><bdi class="secno">7.3.2.3.3 </bdi>Semantic search: SPARQL</h6><a class="self-link" href="#search-semantic" aria-label="Permalink for Section 7.3.2.3.3"></a></div>
                        
                        Support for SPARQL Search API is optional.
                        <span class="rfc2119-assertion" id="tdd-search-sparql-version">
                            If implemented, the SPARQL search API <em class="rfc2119">MUST</em> allow searching TDs using
                            the SPARQL 1.1 protocol [<cite><a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title="SPARQL 1.1 Overview">sparql11-overview</a></cite>].</span>
                        <span class="rfc2119-assertion" id="tdd-search-sparql-method-get">
                            The SPARQL API <em class="rfc2119">MUST</em> accept queries using HTTP <code>GET</code> requests
                            at <code>/search/sparql?query={query}</code> endpoint, where <code>query</code> is the SPARQL expression.</span>
                        <span class="rfc2119-assertion" id="tdd-search-sparql-method-post">
                            The support for SPARQL search using HTTP <code>POST</code> method
                            at <code>/search/sparql</code> endpoint is <em class="rfc2119">OPTIONAL</em>.</span>
                        <span class="rfc2119-assertion" id="tdd-search-sparql-resp-select-ask">
                            A successful request with a query <code>SELECT</code> or <code>ASK</code> <em class="rfc2119">MUST</em> return a response 200 (OK) status, and contain <code>application/json</code> by default in the Content-Type header.</span>
			            <span class="rfc2119-assertion" id="tdd-search-sparql-resp-describe-construct">
                            A successful request with a query <code>CONSTRUCT</code> and <code>DESCRIBE</code> <em class="rfc2119">MUST</em> return a response 200 (OK) status, and contain <code>application/ld+json</code> by default in the Content-Type header.</span>
                        <span class="rfc2119-assertion" id="tdd-search-sparql-error">
                            A request with any query different from <code>SELECT</code>, <code>ASK</code>, <code>CONSTRUCT</code> or <code>DESCRIBE</code> <em class="rfc2119">MUST</em> return a response 400 (Bad Request).</span>
                        The semantic search with SPARQL is specified as <code>searchSPARQL</code> action in
                        <a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</a>.
                        
                        <span class="rfc2119-assertion" id="tdd-search-sparql-federation">
                            A WoT Thing Description Directory <em class="rfc2119">MAY</em> implement federation in its SPARQL query API.</span>
                        <span class="rfc2119-assertion" id="tdd-search-sparql-federation-version">
                            If implemented, the SPARQL API <em class="rfc2119">MUST</em> implement the
                            SPARQL 1.1 Federated Query standard [<cite><a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title="SPARQL 1.1 Overview">sparql11-overview</a></cite>].</span>
                    </section>
                </section>

                <section id="directory-api-spec"><div class="header-wrapper"><h5 id="x7-3-2-4-api-specification-thing-model"><bdi class="secno">7.3.2.4 </bdi>API Specification (Thing Model)</h5><a class="self-link" href="#directory-api-spec" aria-label="Permalink for Section 7.3.2.4"></a></div>
                    
                    <p>
                    A template for the API of Thing Description Directories is given here
                    as a <a href="#dfn-thing-model" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-model-1">Thing Model</a>.
                    The Thing Model is normative (except where noted) but should not be considered 
                    as the sole reference to implement or interact with a Thing Description Directory.
                    Please refer also to the specifications given 
                    in <a href="#exploration-directory-api" data-matched-text="[[[#exploration-directory-api]]]" class="sec-ref"><bdi class="secno">7.3.2 </bdi>Directory Service API</a>.
                    </p>
                    <p>
                    The <code>searchJSONPath</code> and <code>searchXPath</code> affordances 
                    given in this Thing Model
                    are not normative and are provided for information only.
                    </p>
<pre class="advisement" aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class="hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"@type"</span>: [
        <span class="hljs-string">"tm:ThingModel"</span>,
        <span class="hljs-string">"ThingDirectory"</span>
    ],
    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description Directory (TDD) Thing Model"</span>,
    <span class="hljs-attr">"version"</span>: {
        <span class="hljs-attr">"model"</span>: <span class="hljs-string">"1.0.0-beta.3"</span>
    },
    <span class="hljs-attr">"base"</span>: <span class="hljs-string">"{{DIRECTORY_BASE_URL}}"</span>,
    <span class="hljs-attr">"tm:optional"</span>: [
        <span class="hljs-string">"/actions/createThing"</span>,
        <span class="hljs-string">"/actions/createAnonymousThing"</span>,
        <span class="hljs-string">"/actions/retrieveThing"</span>,
        <span class="hljs-string">"/actions/updateThing"</span>,
        <span class="hljs-string">"/actions/partiallyUpdateThing"</span>,
        <span class="hljs-string">"/actions/deleteThing"</span>,
        <span class="hljs-string">"/actions/searchJSONPath"</span>,
        <span class="hljs-string">"/actions/searchXPath"</span>,
        <span class="hljs-string">"/actions/searchSPARQL"</span>,
        <span class="hljs-string">"/events/thingCreated"</span>,
        <span class="hljs-string">"/events/thingUpdated"</span>,
        <span class="hljs-string">"/events/thingDeleted"</span>
    ],
    <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"things"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Retrieve all Thing Descriptions"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"offset"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Number of TDs to skip before the page"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span>,
                    <span class="hljs-attr">"default"</span>: <span class="hljs-number">0</span>
                },
                <span class="hljs-attr">"limit"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Number of TDs in a page"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span>
                },
                <span class="hljs-attr">"format"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Payload format"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"enum"</span>: [
                        <span class="hljs-string">"array"</span>,
                        <span class="hljs-string">"collection"</span>
                    ],
                    <span class="hljs-attr">"default"</span>: <span class="hljs-string">"array"</span>
                },
                <span class="hljs-attr">"sort_by"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Comparator TD attribute for collection sorting"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"default"</span>: <span class="hljs-string">"id"</span>
                },
                <span class="hljs-attr">"sort_order"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Sorting order"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"enum"</span>: [
                        <span class="hljs-string">"asc"</span>,
                        <span class="hljs-string">"desc"</span>
                    ],
                    <span class="hljs-attr">"default"</span>: <span class="hljs-string">"asc"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things{?offset,limit,format,sort_by,sort_order}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/ld+json"</span>,
                        <span class="hljs-attr">"htv:headers"</span>: [
                            {
                                <span class="hljs-attr">"htv:fieldName"</span>: <span class="hljs-string">"Link"</span>
                            }
                        ]
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid query arguments"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        }
    },
    <span class="hljs-attr">"actions"</span>: {
        <span class="hljs-attr">"createThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Create a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingID"</span>,
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description ID"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"format"</span>: <span class="hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"input"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema is implied by the content type"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things/{id}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"PUT"</span>,
                    <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">201</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid serialization or TD"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"createAnonymousThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Create an anonymous Thing Description"</span>,
            <span class="hljs-attr">"input"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema is implied by the content type"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"POST"</span>,
                    <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response including the system-generated URI"</span>,
                        <span class="hljs-attr">"htv:headers"</span>: [
                            {
                                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"System-generated URI"</span>,
                                <span class="hljs-attr">"htv:fieldName"</span>: <span class="hljs-string">"Location"</span>
                            }
                        ],
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">201</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid serialization or TD"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"retrieveThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Retrieve a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingID"</span>,
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description ID"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"format"</span>: <span class="hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"output"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema is implied by the content type"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"safe"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"idempotent"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things/{id}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/td+json"</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"TD with the given id not found"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"updateThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Update a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingID"</span>,
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description ID"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"format"</span>: <span class="hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"input"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema is implied by the content type"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things/{id}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"PUT"</span>,
                    <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/td+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">204</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid serialization or TD"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"partiallyUpdateThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Partially update a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingID"</span>,
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description ID"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"format"</span>: <span class="hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"input"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema is implied by the content type"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things/{id}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"PATCH"</span>,
                    <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/merge-patch+json"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">204</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Invalid serialization or TD"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        },
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"TD with the given id not found"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"deleteThing"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Delete a Thing Description"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"id"</span>: {
                    <span class="hljs-attr">"@type"</span>: <span class="hljs-string">"ThingID"</span>,
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Thing Description ID"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
                    <span class="hljs-attr">"format"</span>: <span class="hljs-string">"iri-reference"</span>
                }
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/things/{id}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"DELETE"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">204</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"TD with the given id not found"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"searchJSONPath"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSONPath syntactic search.  This affordance is not normative and is provided for information only."</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"A valid JSONPath expression"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"output"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema depends on the given query"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"safe"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"idempotent"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/search/jsonpath?query={query}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/json"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"searchXPath"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"XPath syntactic search.  This affordance is not normative and is provided for information only."</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"A valid XPath expression"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"output"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema depends on the given query"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"safe"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"idempotent"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/search/xpath?query={query}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/json"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"XPath expression not provided or contains syntax errors"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
        <span class="hljs-attr">"searchSPARQL"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"SPARQL semantic search"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"query"</span>: {
                    <span class="hljs-attr">"title"</span>: <span class="hljs-string">"A valid SPARQL 1.1. query"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>
                }
            },
            <span class="hljs-attr">"output"</span>: {
                <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The schema depends on the given query"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"safe"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"idempotent"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/search/sparql?query={query}"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"GET"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/json"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"SPARQL query not provided or contains syntax errors"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                },
                {
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/search/sparql"</span>,
                    <span class="hljs-attr">"htv:methodName"</span>: <span class="hljs-string">"POST"</span>,
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Success response"</span>,
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/json"</span>,
                        <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">200</span>
                    },
                    <span class="hljs-attr">"additionalResponses"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"SPARQL query not provided or contains syntax errors"</span>,
                            <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"application/problem+json"</span>,
                            <span class="hljs-attr">"htv:statusCodeValue"</span>: <span class="hljs-number">400</span>
                        }
                    ]
                }
            ]
        }
    },
    <span class="hljs-attr">"events"</span>: {
        <span class="hljs-attr">"thingCreated"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Registration of Thing Descriptions inside the directory"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"diff"</span>: {
                    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Receive the full created TD as event data"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"boolean"</span>
                }
            },
            <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Partial/Full TD"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"op"</span>: <span class="hljs-string">"subscribeevent"</span>,
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/events/thing_created{?diff}"</span>,
                    <span class="hljs-attr">"subprotocol"</span>: <span class="hljs-string">"sse"</span>,
                    <span class="hljs-attr">"htv:headers"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"ID of the last event for reconnection"</span>,
                            <span class="hljs-attr">"htv:fieldName"</span>: <span class="hljs-string">"Last-Event-ID"</span>
                        }
                    ],
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        },
        <span class="hljs-attr">"thingUpdated"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Updates to Thing Descriptions within the directory"</span>,
            <span class="hljs-attr">"uriVariables"</span>: {
                <span class="hljs-attr">"diff"</span>: {
                    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Include TD changes inside event data"</span>,
                    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"boolean"</span>
                }
            },
            <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Partial TD"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
                <span class="hljs-attr">"contentMediaType"</span>: <span class="hljs-string">"application/merge-patch+json"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"op"</span>: <span class="hljs-string">"subscribeevent"</span>,
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/events/thing_updated{?diff}"</span>,
                    <span class="hljs-attr">"subprotocol"</span>: <span class="hljs-string">"sse"</span>,
                    <span class="hljs-attr">"htv:headers"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"ID of the last event for reconnection"</span>,
                            <span class="hljs-attr">"htv:fieldName"</span>: <span class="hljs-string">"Last-Event-ID"</span>
                        }
                    ],
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        },
        <span class="hljs-attr">"thingDeleted"</span>: {
            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Deletion of Thing Descriptions from the directory"</span>,
            <span class="hljs-attr">"data"</span>: {
                <span class="hljs-attr">"title"</span>: <span class="hljs-string">"Partial TD"</span>,
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>
            },
            <span class="hljs-attr">"forms"</span>: [
                {
                    <span class="hljs-attr">"op"</span>: <span class="hljs-string">"subscribeevent"</span>,
                    <span class="hljs-attr">"href"</span>: <span class="hljs-string">"/events/thing_deleted"</span>,
                    <span class="hljs-attr">"subprotocol"</span>: <span class="hljs-string">"sse"</span>,
                    <span class="hljs-attr">"htv:headers"</span>: [
                        {
                            <span class="hljs-attr">"description"</span>: <span class="hljs-string">"ID of the last event for reconnection"</span>,
                            <span class="hljs-attr">"htv:fieldName"</span>: <span class="hljs-string">"Last-Event-ID"</span>
                        }
                    ],
                    <span class="hljs-attr">"response"</span>: {
                        <span class="hljs-attr">"contentType"</span>: <span class="hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        }
    }
}</code></pre>           



                    <div class="note" id="issue-container-generatedID-3"><div role="heading" class="ednote-title marker" id="h-ednote-3" aria-level="6"><span>Editor's note</span><span class="issue-label">: Context URIs</span></div><p class="">
                        The context URIs are tentative and subject to change. 
                    </p></div>
                </section>
            </section>
	    
        </section>
    </section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x8-security-considerations"><bdi class="secno">8. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 8."></a></div>
        
        <p class="at-risk">Several assertions in the following are at risk, as indicated
        by yellow highlighting.  These represent best practices but at the
        time of CR transition have insufficient implementation experience.
        These will be converted to informative statements if sufficient
        implementation experience is not obtained by time of PR transition.
        </p>
	<p>
            Security is a cross-cutting issue that needs to be considered
            in all WoT building blocks and WoT implementations. 
	    This chapter summarizes some general issues and guidelines to help
            preserve the security of concrete WoT discovery implementations.
            For a more detailed and complete analysis of both security and
            privacy issues, see the <em>WoT Security and Privacy Guidelines</em>
            specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-security" title="Web of Things (WoT) Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
	    WoT Thing and WoT TDDs are also web services and should be
	    implemented using best practices for web services.
	    In addition to the specific security considerations below,
	    the security risks and mitigations discussed in
	    guides such as the OWASP Top 10 [<cite><a class="bibref" data-link-type="biblio" href="#bib-owasp-top-10" title="OWASP Top Ten">OWASP-Top-10</a></cite>] should be
	    evaluated, and if applicable, addressed.
        </p>
        <section id="security-consideration-dos"><div class="header-wrapper"><h3 id="x8-1-denial-of-service"><bdi class="secno">8.1 </bdi>Denial of Service</h3><a class="self-link" href="#security-consideration-dos" aria-label="Permalink for Section 8.1"></a></div>
            
            <p>
                Certain functions of the directory service,
                in particular search queries,
                may require significant resources to execute and this fact
                can be used to launch denial of service (DoS) attacks against
                WoT Thing Description Directory services.
		In such an attack a WoT Directory would be overloaded
		by requests from the attacker and unable to service other
		requests.
	    </p>
                <dl>
                    <dt>Mitigations:</dt><dd>
                    <ul>
                    <li>
	            <span class="rfc2119-assertion" id="sec-tdd-throttle-queries">
                    A WoT Thing Description Directory implementation <em class="rfc2119">SHOULD</em>
                    limit the number of queries per unit time from the same requestor.</span>
		    </li>
                    <li>
	            <span class="rfc2119-assertion" id="sec-tdd-limit-query-complexity">
                    A WoT Thing Description Directory implementation <em class="rfc2119">SHOULD</em>
		            limit the complexity of queries (for example, the total length of the query 
                    expression or its depth).</span>
		    </li>
                    <li>
	            <span class="rfc2119-assertion" id="sec-tdd-query-watchdog">
                    A WoT Thing Description Directory implementation <em class="rfc2119">SHOULD</em>
	                use a watchdog timer to abort queries that take more than
                    a certain maximum (implementation-configurable) amount of time.</span>
		    </li> 
                    </ul>
                    </dd>
                </dl>
	</section>
        <section id="security-consideration-amp-ddos"><div class="header-wrapper"><h3 id="x8-2-amplification-and-distributed-denial-of-service"><bdi class="secno">8.2 </bdi>Amplification and Distributed Denial of Service</h3><a class="self-link" href="#security-consideration-amp-ddos" aria-label="Permalink for Section 8.2"></a></div>
            
            <p>
	    It may also be possible to use elements of WoT Discovery
	    mechanisms to launch distributed denial of service (DDoS) attacks
	    against other targets.  In such an attack the WoT Discovery
	    service itself is not the target.  Instead, an aspect of
	    the WoT Discovery service would be
	    exploited to generate amplified network traffic that overloads a third
	    party, the actual target.
	    Such an attack has two requirements: first, the ability
	    to redirect traffic to a third party, and second, 
	    an intermediary service
	    that can be exploited to amplify network traffic
	    from the attacker.
	    Redirection
	    of network traffic is possible in some protocols, such as 
	    unsecured CoAP, by modifying source information in headers.
	    Amplification is possible by taking advantage of three 
	    multiplicative factors: the ratio of request to response payload
	    sizes, use of "observe" in protocols like CoAP  
	    (which can give multiple results for one request), and use of
	    multicast (which can allow multiple servers to respond to one 
	    request). 
	    Services which do not support authentication
	    are ideal intermediaries for such an indirect attack.
	    Unfortunately, the Introduction mechanisms for WoT Discovery
	    are meant to provide open access mechanisms to initiate discovery
	    and might be exploited for this purpose.
            </p>
            <dl>
                <dt>Mitigations:</dt>
                <dd>
		<ul>
		<li>
	        <span class="rfc2119-assertion" id="sec-tdd-intro-no-observe">
                Open implementations of Introduction mechanisms <em class="rfc2119">SHOULD NOT</em>
		support observe or similar extended result subprotocols.</span>
		</li>
		<li>
	        <span class="rfc2119-assertion" id="sec-tdd-intro-no-multicast">
		Open implementations of Introduction mechanisms <em class="rfc2119">SHOULD NOT</em> respond to multicast
		requests unless this is absolutely required by the protocol.</span>
	        <span class="rfc2119-assertion" id="sec-tdd-intro-if-multicast-required">
		If support for multicast is required,
		in the case of CoAP, the recommendations made in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9175" title="Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing">RFC9175</a></cite>] <em class="rfc2119">SHOULD</em> be
		applied.</span>
		Note however that in the case of discovery the number of servers that
		might respond to a multicast request will generally not be known in
		advance, in which case the mitigations proposed in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9175" title="Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing">RFC9175</a></cite>] may
		not be effective.
		</li>
		<li>
		Limit the size of responses to the minimum.  
	        <span class="rfc2119-assertion" id="sec-tdd-intro-limit-response-size">
		The total size of responses to an Introduction on the public internet (outside
    of a protected local network) <em class="rfc2119">SHOULD</em>
		be less than 3x the size of the total size of request, and this should 
		include any error responses.</span>
		This is consistent with DDOS mitigations in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9000" title="QUIC: A UDP-Based Multiplexed and Secure Transport">RFC9000</a></cite>] (QUIC) and HTTP/3.
		Here "total size" includes any headers required by the protocol itself,
    as well as padding in the request to allow for a larger response.
		</li>
		<li>
	        <span class="rfc2119-assertion" id="sec-tdd-intro-throttling">
		Introductions <em class="rfc2119">SHOULD</em> rate-limit responses to any particular
		request source.</span>
		</li>
		<li>
	        <span class="rfc2119-assertion" id="sec-tdd-intro-no-ext">
		Introduction mechanisms on a segmented network behind a firewall
		(e.g. a LAN) <em class="rfc2119">SHOULD NOT</em> respond to requests that are (apparently) from outside that LAN.</span>
		</li>
	        </ul>
		Of particular concern are Introduction mechanisms that can
		return multiple results, such as CoRE-RD and DID.
		It may be necessary to use authentication/authorization on such
		Introduction mechanisms
		as well if the other mitigations above are not sufficient.
		A recommended alternative is to move multiple results from such
		Introductions into a WoT TDD, which can then be protected
		by appropriate authentication and authorization measures.
		Then the open Introduction mechanism only has to return one
		result, the URL of the TDD.
		Introduction mechanisms that are visible on the open internet
		should be especially careful to implement the above mitigations,
		and perhaps avoid Introduction
		mechanisms that can return multiple URLs completely.
                </dd>
            </dl>
        </section>
        <section id="security-consideration-lan-self-discovery"><div class="header-wrapper"><h3 id="x8-3-self-discovery-on-lans"><bdi class="secno">8.3 </bdi>Self-Discovery on LANs</h3><a class="self-link" href="#security-consideration-lan-self-discovery" aria-label="Permalink for Section 8.3"></a></div>
        
            <p>
            On a LAN, 
	    certificates and browsers may not be able to property set up TLS for 
	    HTTPS because browsers expect
            certificates pointing to a publicly-visible URL.
            Using HTTP is common practice inside LANs but in combination with 
	    self-description it means that WoT Things
            would be essentially be making TDs visible to everyone
	    with access to the private LAN.  Even if security mechanisms
	    such as HTTP passwords were used, these are not effective (they
	    can be easily discovered by a traffic analyser) without
	    transport security.
            </p>
            <dl>
                <dt>Mitigations:</dt>
                <dd>
		<p>
	        <span class="rfc2119-assertion" id="sec-self-psk">
                PSK (pre-shared keys) <em class="rfc2119">SHOULD</em> be used if possible on LANs, 
		meaning one of the ciphersuites in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4279" title="Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)">RFC4279</a></cite>].</span>
                This does require that Things are assigned PSKs in a common security domain, 
		which is typically done by following an onboarding process.  
		Unfortunately, specific onboarding processes 
		are currently out of scope of the WoT specifications.
		</p>
		<p>
		An alternative is to depend on local network security (i.e. WEP).
		This is not the best solution from a security or privacy point of
		view but may be acceptable in some contexts.  Note however that
		all users with access to the network would in turn have access to 
		all TDs via self-description.  
	        <span class="rfc2119-assertion" id="sec-self-segment">
		If Things cannot be individually secured with transport security and 
		authentication and authorization,
		a separate network <em class="rfc2119">SHOULD</em> be set up, i.e. with an alternative SSID, and used only
		for IoT devices.</span>
		Using a segmented network reduces the need for distributing the password
                to this network to those who need access to the set of IoT devices connected to it.
		</p>
		<p>
		Another alternative is to use a reverse proxy service based in the cloud.
		Secure setup can
		be accomplished if the IoT device has access to the cloud, since
		the proxy server can have a public URL and the initial connection
		can use HTTPS, then open a secure tunnel over a websocket.  The proxy can in turn
		re-expose a secure endpoint, and possible add authentication.
		The disadvantages of this approach including depending on an external
		cloud service and the need to expose an external access point (which is
		itself a security risk).  The first disadvantage can be addressed by hosting
		the proxy service locally 
		and exposing a public URL using e.g. dynamic DNS if the
		local server is connected through an ISP.
	        <span class="rfc2119-assertion" id="sec-self-proxy">
		If Things cannot be individually secured with transport security and 
		authentication and authorization,
                then they <em class="rfc2119">MAY</em> be made available for general access via a proxy
		that can provide suitable access controls.</span>
                </p></dd>
            </dl>
        </section>
    </section>
    <section id="privacy-considerations"><div class="header-wrapper"><h2 id="x9-privacy-considerations"><bdi class="secno">9. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 9."></a></div>
        
        <p class="at-risk">Several assertions in the following are at risk, as indicated
        by yellow highlighting.  These represent best practices but at the
        time of CR transition have insufficient implementation experience.
        These will be converted to informative statements if sufficient
        implementation experience is not obtained by time of PR transition.
        </p>
        <p>
            Privacy is a cross-cutting issue that needs to be considered
            in all WoT building blocks and WoT implementations. 
	    This chapter summarizes some general issues and guidelines to help
            preserve the privacy of concrete WoT discovery implementations.
            For a more detailed and complete analysis of both security and
            privacy issues, see the <em>WoT Security and Privacy Guidelines</em>
            specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-security" title="Web of Things (WoT) Security and Privacy Guidelines">WOT-SECURITY</a></cite>].
        </p>
        <p>
            The WoT discovery architecture is designed to avoid a dependence on the 
            privacy of existing discovery schemes by using a two-phase approach and
            allowing for the enforcement of authorization before metadata release.  
	    However several privacy risks still exist.  
	    These are listed below along with possible mitigations.
            The level of risk to privacy in particular depends on the use case and whether
            there is a risk that information related to a person might be distributed in
            a fashion inconsistent with the privacy desires of that person. 
            For privacy we distinguish the following broad classes of use case scenarios:
        </p>
        <dl>
            <dt>Institutional</dt>
            <dd>Both the Things producing metadata and 
            the Consumers of that metadata are owned and controlled by an institution or 
            representatives of an institution.  Example: Automation in a factory where
            a control system is accessing the state of an assembly line in order to
            evaluate quality.
            </dd>
            <dt>Service</dt><dd>The Things producing metadata  
            are owned and controlled by an institution or representatives of an institution
            while the consumers are individuals.  Example: driver of an electric vehicle 
            accessing the TD for a charge station in order to check status of a charge.
            </dd>
            <dt>Personal</dt><dd>Both the Things producing metadata and 
            the Consumers of that metadata are owned and controlled by the same individual.
            Example: A smart home control system for charging an electric car from
            home-attached solar panels, both home and car owned by the same person.
            </dd>
            <dt>Personal Peer-to-Peer</dt><dd>The Things producing metadata and 
            the Consumers of that metadata are owned and controlled by different individuals.
            Example: A smart home control system for charging a guest's electric car from
            home-attached solar panels.
            </dd>
            <dt>Institutional Peer-to-Peer</dt><dd>The Things producing metadata and 
            the Consumers of that metadata are owned and controlled by different institutions.
            Example: A utility provides and manages power delivered to a factory, and
            the factory provides an interface for the utility to negotiate on-demand power
            usage reductions.
            </dd>
            <dt>Client</dt><dd>The Things producing metadata  
            are owned and controlled by an individual
            while the consumers are an institution or representatives of an institution.
            Example: A personal electric vehicle exposes an interface to a public charging station 
            so that the charging station can evaluate the charge status of the vehicle.
            </dd>
        </dl>
        <p>
            All of these in fact carry privacy risks.  Even in the case of factory
            automation, there is the chance that data about employee performance would
            be captured and would have to be managed appropriately.
        </p>
        <p>
            In the following we make frequent reference to "tracking".  This term covers
            multiple privacy risks, including location tracking and behavioral profiling.
            In general, the definition of "profiling" given in Article 4 of the 
            GDPR [<cite><a class="bibref" data-link-type="biblio" href="#bib-gdpr-defs" title="General Data Protection Regulation (GDPR) Article 4 - Definitions">GDPR-Defs</a></cite>] is to be considered equivalent to "tracking" as used in this document.
        </p>
        <p>
            With these definitions and categories established, we will now discuss some specific
            privacy risks and potential mitigations.
        </p>
        <section id="privacy-consideration-location-tracking"><div class="header-wrapper"><h3 id="x9-1-location-tracking-and-profiling"><bdi class="secno">9.1 </bdi>Location Tracking and Profiling</h3><a class="self-link" href="#privacy-consideration-location-tracking" aria-label="Permalink for Section 9.1"></a></div>
            
            <p>
                A discovery service may potentially allow the approximate location of a person to be determined without
                their consent.  This risk occurs in some specific circumstances which can be avoided or
                mitigated.  It is also similar to the risk posed by other network services such as DHCP and DNS.
            </p>
            <p>
                For this risk to occur, there first has to be an IoT device that can be reliably associated
                with a person's location, such as a necessary medical device or a vehicle.  
                Note that the risk only applies to personal use cases, not institutional ones.
                Secondly, the
                device has to be configured to register automatically with the nearest directory service.
                In this case, the location of the device can be inferred from the network range of the directory
                service and the location of the person inferred from the location of the device.
            </p>
            <p>
                There are a few variants of this: 
                </p>
                <ul>
                <li>The TD or Thing could report actual location information so no inferencing by network range is needed;</li>
                <li>A directory could support actual search by location;</li>
                <li>Absence of a TD in a directory could reveal negative location information.
		For example, if a TD
                    times out and is removed from a directory, that means the device has not been present for
                    a while, which could be used to infer that a person is NOT in a particular location, e.g. not at
                    home.</li>
                </ul>
            <p>
            Location tracking is not the only profiling risk.
            In general, "profiling" includes any mechanism used to evaluate
            information about a person, including economic status, health,
            preferences, interests, reliability, and behavior.
            Some of the metadata in a TD can be used to infer information
            of this kind if the described Thing can be associated with a person.
            Some of the mitigations below are also applicable to this more
            general definition of profiling.
            </p>
            <p>
                Some of these risks are shared by similar services.  For example, DCHP automatically responds to 
                requests for IP addresses on a local network, and devices typically provide an identifier (a MAC
                address) as part of this process, and the DHCP server maintains a registry. In theory, someone with
                access to the DHCP server in, say, a cafe, could use this information to track someone's phone and
                infer their location.
            </p>
            <dl>
                <dt>Mitigations:</dt>
                <dd>
                There are a few options to mitigate these risks:
                <ul>
                <li>
	        <span class="rfc2119-assertion" id="priv-loc-disable-public-directories">
		To avoid location tracking and other forms of profiling, 
    a WoT Thing associated with a person <em class="rfc2119">MAY</em> 
		disable registration with public directories.</span>
		Registration would still be possible with 
                personal directories, for example, a home gateway, but a user could disable registration at other
                locations.  This has the disadvantage that functionality is lost: personal devices cannot be
                discovered in public locations.  This could be addressed by having internet-accessible private
                discovery services. For example, the user's home gateway could provide an internet-accessible service, but with
                access control limiting use to authorized users.</li>
		<li>
	        <span class="rfc2119-assertion" id="priv-loc-anonymous-tds">
		To avoid location tracking and other forms of profiling,
    a WoT Thing associated with a person <em class="rfc2119">SHOULD</em> use anonymous TDs
    when registering with a public directories.</span>
		In some cases, it may be possible to use
		anonymous TDs and omit explicit IDs from TDs submitted to
		a TDD.  In this case the TDD will generate a local ID valid
		only in that TDD.  This does, however, complicate update since the client needs to
		remember the local ID assigned by the TDD.  
		Anonymous TDs also do not prevent tracking by other means, such as 
		fingerprinting.
		</li>
                <li>
	        <span class="rfc2119-assertion" id="priv-loc-gen-ids">
		To avoid location tracking and other forms of profiling, 
    a WoT Thing associated with a person <em class="rfc2119">MAY</em> 
		periodically generate new IDs.</span>
		Using fixed IDs makes it exceptionally easy to track devices.  This problem
                also occurs in DHCP with MAC address and there is a similar partial mitigation: 
                generate new random IDs periodically.
                There are however, a few issues.  First of all, other identification information in the TD needs to be 
                hidden.  For example, client IDs issued by CSPs for API security should be omitted from TDs if 
                they cannot be easily changed.  Second, if the device generates a new ID, the user may still need to 
                know the current ID to find the device via discovery.  This can be accomplished however by generating new
                IDs using a deterministic cryptographic generator that is a function of the current time.
                However, note that regenerating IDs alone does not make tracking impossible since a TD might be fingerprinted.
                Also, updating an ID might be observable to the owner of the directory service, who could track
                and record the updated ID.  Even if the TD is deleted and reinserted the association could be 
                inferred.  This is however exactly parallel to the situation with DHCP and rotation of MAC addresses.
                In general, however, generating new IDs at least for each service or person to which a TD is supplied
                makes it harder to connect registration events at different locations and times.
It is also prudent to generate new identifiers upon major changes in configuration,
such as unregistering from a local network or hub and registering with a new one (which typically indicates
a change in ownership).
	        There is a related issue with long-lived IP addresses which might need to be updated periodically
		to mitigate tracking.  In the context of ipv6 [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8981" title="Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6">RFC8981</a></cite>] discusses this.
          Finally, there is a problem with devices that require immutable identifiers,
          e.g. medical devices in such jurisdictions.  
          This is discussed in [<cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title="Web of Things (WoT) Thing Description 1.1">wot-thing-description11</a></cite>], but in summary the
          problem can be avoided if such immutable identifiers are made available
          only as protected properties, e.g. via affordances requiring authentication,
          not in the TD, and the TD identifier itself (if used) is
          independent of the immutable identifier, and so can be made mutable.
                </li>
                <li>
	        <span class="rfc2119-assertion" id="priv-loc-priv-dir-access">
		To reduce the risk of negative location inferencing, access to 
                private directories <em class="rfc2119">SHOULD</em> be limited by using access controls.</span>
		If an attacker cannot access the service,
                they cannot retrieve information to infer location.  
		Access rights provided to guests (e.g. for Peer-to-Peer Personal scenarios)
                should be appropriately time-limited.
                Use of long time-to-live values may be appropriate in other cases.  
		In addition, TDs should be updated in a 
                directory only when they change.  
		For example, the TD for a car may only be updated when new car firmware is available
                providing new services, and the time-to-live might be set at one month (covering most absences).
                </li>
                <li>
	        <span class="rfc2119-assertion" id="priv-loc-explicit-care">
		When explicit location information is available, whether stored in a TD or available in a property,
                additional care <em class="rfc2119">SHOULD</em> be taken to only share the TD and/or access to the device with trusted partners,
                including directories.</span>
	        <span class="rfc2119-assertion" id="priv-loc-explicit-strip">
		If the TD must be shared with a public directory, the location information <em class="rfc2119">MAY</em> be
                stripped.</span>
                </li></ul>
                </dd>
            </dl>
        </section>
        <section id="privacy-consideration-query-tracking"><div class="header-wrapper"><h3 id="x9-2-query-tracking"><bdi class="secno">9.2 </bdi>Query Tracking</h3><a class="self-link" href="#privacy-consideration-query-tracking" aria-label="Permalink for Section 9.2"></a></div>
            
            <p>
            A directory service could potentially record and track queries by an individual,
            identifying that individual by their authenticated identity provided.
	    Then the set of queries associated with an individual could be used to 
	    profile that individual, and specific queries may also reveal personal information
	    about an individual.
            </p>
            <dl>
                <dt>Mitigations:</dt>
                <dd><p>
	        <span class="rfc2119-assertion" id="priv-query-anon">
                When accessing a public directory, like any other public web service,
                users and implementations <em class="rfc2119">SHOULD</em> use an anonymous identity provider.</span>
                In particular, OAuth2 can provide tokens which don't identify specific individuals,
                they just assert access rights proven elsewhere.
                </p></dd>
            </dl>
        </section>

    </section>

    <section id="performance-considerations" class="informative"><div class="header-wrapper"><h2 id="x10-performance-considerations"><bdi class="secno">10. </bdi>Performance Considerations</h2><a class="self-link" href="#performance-considerations" aria-label="Permalink for Section 10."></a></div><p><em>This section is non-normative.</em></p>
        
        
        <section id="perf-incremental-transfer"><div class="header-wrapper"><h3 id="x10-1-incremental-transfer"><bdi class="secno">10.1 </bdi>Incremental Transfer</h3><a class="self-link" href="#perf-incremental-transfer" aria-label="Permalink for Section 10.1"></a></div>
            
	    <p>
            <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-46">TD</a> objects are not constrained in size. They may become 
            expensive to process and transfer individually or collectively.
            A single TD or a list of TDs could be too large for a constrained device,
            serving its own TD to consumers, submitting it to a directory,
            or consuming other TDs.

            To meet such requirements,
            servers should support incremental transfer of payloads 
            using protocol-specific mechanisms:
	    </p>
            <ul>
                <li>
		
                HTTP/1.1 servers should support <code>chunked</code> 
                <a href="https://tools.ietf.org/html/rfc7230#section-3.3.1">Transfer-Encoding</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7230" title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">RFC7230</a></cite>]
                to receive and server data incrementally.
		
                </li>
                <li>
		
                HTTP/2 servers should handle the data incrementally using 
                <a href="https://tools.ietf.org/html/rfc7540#section-4">HTTP Frames</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7540" title="Hypertext Transfer Protocol Version 2 (HTTP/2)">RFC7540</a></cite>].
                The HTTP/1.1 chunked transfer encoding is not supported in HTTP/2.
                
                </li>
                <li>
        
                CoAP servers must suppoert block-wise transfer [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7959" title="Block-Wise Transfers in the Constrained Application Protocol (CoAP)">RFC7959</a></cite>] when relying
                on an unreliable transport protocol like UDP and should support it when
                using a reliable transport protocol like TCP or WebSockets [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8323" title="CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets">RFC8323</a></cite>].
               
                </li>
            </ul>
            <p> 
            Most HTTP servers and clients automatically process the data that is transferred 
            in chunks.
            Memory-constrained clients should consider consuming the
            received data incrementally, instead of trying to load a whole
            object in memory for de-serialization. 
	    </p>
        </section>
    </section>

    <section id="iana-considerations" class="normative"><div class="header-wrapper"><h2 id="x11-iana-considerations"><bdi class="secno">11. </bdi>IANA Considerations</h2><a class="self-link" href="#iana-considerations" aria-label="Permalink for Section 11."></a></div>
        
        <section id="well-known-uri-suffix"><div class="header-wrapper"><h3 id="x11-1-well-known-uri-registration"><bdi class="secno">11.1 </bdi>Well-Known URI Registration</h3><a class="self-link" href="#well-known-uri-suffix" aria-label="Permalink for Section 11.1"></a></div>
            
            <p>
                IANA will be asked to allocate the following value into the Well-Known URI
                defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title="Well-Known Uniform Resource Identifiers (URIs)">RFC8615</a></cite>].
            </p>
            <ul>
                <li>URI suffix: <code>wot</code></li>
            </ul>
        </section>
        <section id="service-name"><div class="header-wrapper"><h3 id="x11-2-service-name-registration"><bdi class="secno">11.2 </bdi>Service Name Registration</h3><a class="self-link" href="#service-name" aria-label="Permalink for Section 11.2"></a></div>
            
            <p>
                IANA will be asked to allocate the following value into Service Name and Transport Protocol Port Number Registry
                defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6335" title="Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry">RFC6335</a></cite>].
            </p>
            <ul>
                <li>Service Name: <code>wot</code></li>
                <li>Transport Protocol: TCP, UDP</li>
                <li>Description: Service name to search for the Thing Description of a Thing or a Thing Description Directory in the <abbr title="World Wide Web Consortium">W3C</abbr> Web of Things</li>
                <li>Port Number: N/A</li>
                <li>Assignment notes: We use <code>_directory</code> subtype for a Thing Description Directory.</li>
            </ul>
        </section>
        <section id="core-resource-type"><div class="header-wrapper"><h3 id="x11-3-core-resource-types-registration"><bdi class="secno">11.3 </bdi>CoRE Resource Types Registration</h3><a class="self-link" href="#core-resource-type" aria-label="Permalink for Section 11.3"></a></div>
            
            <p>
                IANA will be asked to allocate the following values into the Resource Type (<code>rt=</code>)
                Link Target Attribute Values sub-registry of the Constrained Restful Environments (CoRE)
                Parameters registry defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6690" title="Constrained RESTful Environments (CoRE) Link Format">RFC6690</a></cite>].
            </p>
            <table class="def">
                <thead>
                    <tr>
                        <th>Value</th>
                        <th>Description</th>
                        <th>Reference</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>wot.thing</code></td>
                        <td>Thing Description of a Thing</td>
                        <td><a href="#introduction-core-rd-sec" data-matched-text="[[[#introduction-core-rd-sec]]]" class="sec-ref"><bdi class="secno">6.4 </bdi>CoRE Link Format and CoRE Resource Directory</a></td>
                    </tr>
                    <tr>
                        <td><code>wot.directory</code></td>
                        <td>Thing Description of a <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-21">Thing Description Directory</a></td>
                        <td><a href="#introduction-core-rd-sec" data-matched-text="[[[#introduction-core-rd-sec]]]" class="sec-ref"><bdi class="secno">6.4 </bdi>CoRE Link Format and CoRE Resource Directory</a></td>
                    </tr>
                </tbody>
            </table>

        </section>
    </section>
    <section id="other-name-considerations" class="normative"><div class="header-wrapper"><h2 id="x12-other-name-registration-considerations"><bdi class="secno">12. </bdi>Other Name Registration Considerations</h2><a class="self-link" href="#other-name-considerations" aria-label="Permalink for Section 12."></a></div>
        
        <section id="did-service-name"><div class="header-wrapper"><h3 id="x12-1-did-service-name-registration"><bdi class="secno">12.1 </bdi>DID Service Name Registration</h3><a class="self-link" href="#did-service-name" aria-label="Permalink for Section 12.1"></a></div>
            
            <p>
                The following values will be allocated for the Service Type 
                used in DID Documents.
            </p>
            <table class="def">
                <thead>
                    <tr>
                        <th>Value</th>
                        <th>Description</th>
                        <th>Reference</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>WotThing</code></td>
                        <td>Thing Description of a Thing</td>
                        <td><a href="#introduction-did-sec" data-matched-text="[[[#introduction-did-sec]]]" class="sec-ref"><bdi class="secno">6.5 </bdi>DID Documents</a></td>
                    </tr>
                    <tr>
                        <td><code>WotDirectory</code></td>
                        <td>Thing Description of a <a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-thing-description-directory-22">Thing Description Directory</a></td>
                        <td><a href="#introduction-did-sec" data-matched-text="[[[#introduction-did-sec]]]" class="sec-ref"><bdi class="secno">6.5 </bdi>DID Documents</a></td>
                    </tr>
                </tbody>
            </table>

        </section>
    </section>

    <section id="tdd-extensions-jsonschema" class="appendix"><div class="header-wrapper"><h2 id="a-json-schema-for-wot-discovery-td-extensions"><bdi class="secno">A. </bdi>JSON Schema for WoT Discovery TD-extensions</h2><a class="self-link" href="#tdd-extensions-jsonschema" aria-label="Permalink for Appendix A."></a></div>
        
        The following JSON Schema specifies the extensions used in <a href="#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-enriched-thing-description-7">Enriched TDs</a>.
        It can be used for validating <a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-47">TDs</a> by a <a href="#dfn-wot-tdd" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-wot-tdd-1">TDD</a>
        as prescribed in <a href="#exploration-directory-api-things-validation" data-matched-text="[[[#exploration-directory-api-things-validation]]]" class="sec-ref"><bdi class="secno">7.3.2.1.6 </bdi>Validation</a>.
<pre class="advisement" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"title"</span>: <span class="hljs-string">"WoT Discovery TD-extensions Schema - 21 May 2021"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"JSON Schema for validating TD instances with WoT Discovery extensions"</span>,
  <span class="hljs-attr">"$schema "</span>: <span class="hljs-string">"http://json-schema.org/draft/2019-09/schema#"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
  <span class="hljs-attr">"properties"</span>: {
    <span class="hljs-attr">"registration"</span>: {
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"object"</span>,
      <span class="hljs-attr">"properties"</span>: {
        <span class="hljs-attr">"created"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>
        },
        <span class="hljs-attr">"expires"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>
        },
        <span class="hljs-attr">"retrieved"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>
        },
        <span class="hljs-attr">"modified"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"string"</span>,
          <span class="hljs-attr">"format"</span>: <span class="hljs-string">"date-time"</span>
        },
        <span class="hljs-attr">"ttl"</span>: {
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"number"</span>
        }
      }
    }
  }
}</code></pre>

    </section>
    
    <section id="changes" class="appendix"><div class="header-wrapper"><h2 id="b-recent-specification-changes"><bdi class="secno">B. </bdi>Recent Specification Changes</h2><a class="self-link" href="#changes" aria-label="Permalink for Appendix B."></a></div>
      
      <section id="changes-from-10-august-2022-working-draft"><div class="header-wrapper"><h3 id="changes-from-third-draft"><bdi class="secno">B.1 </bdi>Changes from 10 August 2022 Working Draft</h3><a class="self-link" href="#changes-from-third-draft" aria-label="Permalink for Appendix B.1"></a></div>
      <ul>
      <li>Clarify 3x rule for DDoS migitation to allow padding in request, and require it only outside of protected local networks.</li>
      <li>Define content types to be used for CoAP servers, paralleling TD servers.</li>
      <li>Update DID service names and refine DID assertions and add examples to clarify use for Introductions.</li>
      <li>Update DNS-SD section to include explicit scheme in TXT field.</li>
      <li>Replace reference to draft CoRE-RD with final specification published as RFC9176.</li>
      </ul>
      </section><section id="changes-from-2-june-2021-working-draft"><div class="header-wrapper"><h3 id="changes-from-second-draft"><bdi class="secno">B.2 </bdi>Changes from 2 June 2021 Working Draft</h3><a class="self-link" href="#changes-from-second-draft" aria-label="Permalink for Appendix B.2"></a></div>
      <ul>
      <li>Use <code>wot</code> for well-known URI service name.</li>
      <li>Refer to TD and Architecture specs for general constraints on secure transport.</li>
      <li>Define requirements for CoAP-based TD Servers.</li>
      <li>Introduction of TD Server exploration, with self-description as a special case.</li>
      <li>Elaboration of class diagram to clarify that not all Directories need to be self-describing.</li>
      <li>Clarify and consolidate error codes and ontology.</li>
      <li>Add assertions for UTF-8 supporting internationalization.</li>
      <li>Update overview figure showing introduction and exploration mechanisms.</li>
      <li>Add Discoverer section defining requirements for discovery clients.</li>
      <li>Use Thing Model instead of a Thing Description example for Directory API.</li>
      <li>Refactor Directory Service API (td-&gt;thing, split anonymous create action, retrieve one and search as actions, listing as things property, split events)</li>
      <li>Add amplification DDOS security consideration.</li>
      <li>Split Security and Privacy Considerations into separate sections.</li>
      <li>Define status of search mechanisms: JSON Path, XPath, and SPARQL.</li>
      <li>Pagination as array and pagination as collection.</li> 
      <li>Updates to events API.</li>
      <li>TD expiry management.</li>
      <li>HEAD method support.</li>
      </ul>
      </section><section id="changes-from-24-november-2020-first-public-working-draft"><div class="header-wrapper"><h3 id="changes-from-first-draft"><bdi class="secno">B.3 </bdi>Changes from 24 November 2020 First Public Working Draft</h3><a class="self-link" href="#changes-from-first-draft" aria-label="Permalink for Appendix B.3"></a></div>
      <ul>
      <li>Update name of directory service to "Thing Description Directory" with acronym TDD, 
      to avoid confusion with the acronym TD used for Thing Descriptions.
      </li>
      <li>Elaboration of complete API for registration of a Thing Description with a 
      Thing Description Directory, 
      including support for creation, update, retrieval, deletion, and listing.
      </li>
      <li>Add recommendation that TDs be validated before storage in a directory.
      Note: this corresponds to work under way in the TD spec to precisely define
      appropriate levels of automatic validation for different contexts, including
      directory registration.
      </li>
      <li>Addition of Security and Privacy Considerations 
      regarding Denial of Service and Location Tracking.
      </li>
      <li>Addition of IANA Considerations regarding CoRE Resource Types.
      </li>
      <li>Definition of Enriched TD to support embedded metadata in TDs returned by a TDD.
      </li>
      <li>Updates to description of exploration to avoid unnecessary dependence 
      on HTTP (in the future, other protocols may be supported).
      </li>
      <li>Use of "resource type" instead of "endpoint type" when describing entry in CoRE RD.
      </li>
      <li>Addition of ontology for TDDs that include the type <code>DirectoryDescription</code>
      identifying TDs of directories and 
      a type <code>LinkDescription</code> to identify a TD that is just a link to another 
      TD (useful for referring to remote directories in order to support federation).
      </li>
      <li>Add section for self-description exploration mechanism. 
      This supports the use case where a Thing hosts its own TD and peer-to-peer Thing
      communication.
      </li>
      <li>Addition of diagram showing the directory information model.
      </li>
      <li>Removal of reference to Issue 16, citing CRUD interface requirements.
      Replaced with CRUDL (CRUD + Listing) interface requirement.
      </li>
      <li><em class="rfc2119">MAY</em> assertion added to explicitly permit implementation of SPARQL federation, 
      and a requirement that if implemented, it needs to follow the SPARQL 1.1 specification.
      </li>
      <li>Updates to references: more recent versions of CoRE RD, DID Core, Eventsource, JSON-LD, 
      and JSON Path specifications. 
      Use of datatracker service (and URLs) to reference IETF RFCs. 
      Addition of normative references to RFC7396 and RFC7540.
      </li>
      </ul>
    </section></section>

    <section id="acknowledgements" class="appendix normative"><div class="header-wrapper"><h2 id="c-acknowledgments"><bdi class="secno">C. </bdi>Acknowledgments</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Appendix C."></a></div>
        

        <p>
            Many thanks to the <abbr title="World Wide Web Consortium">W3C</abbr> staff and all other active Participants of the <abbr title="World Wide Web Consortium">W3C</abbr> Web
            of Things Interest Group (WoT IG) and Working Group (WoT WG) for their
            support, technical input and suggestions that led to improvements to
            this document.
        </p>
    </section>


<section id="references" class="appendix"><div class="header-wrapper"><h2 id="d-references"><bdi class="secno">D. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix D."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="d-1-normative-references"><bdi class="secno">D.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix D.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-did-core">[DID-CORE]</dt><dd>
      <a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 19 July 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
    </dd><dt id="bib-eventsource">[EVENTSOURCE]</dt><dd>
      <a href="https://www.w3.org/TR/eventsource/"><cite>Server-Sent Events</cite></a>. Ian Hickson.  W3C. 28 January 2021. W3C Recommendation. URL: <a href="https://www.w3.org/TR/eventsource/">https://www.w3.org/TR/eventsource/</a>
    </dd><dt id="bib-gdpr-defs">[GDPR-Defs]</dt><dd>
      <a href="https://gdpr-info.eu/art-4-gdpr/"><cite>General Data Protection Regulation (GDPR) Article 4 - Definitions</cite></a>.  European Union (EU) and the European Economic Area (EEA). URL: <a href="https://gdpr-info.eu/art-4-gdpr/">https://gdpr-info.eu/art-4-gdpr/</a>
    </dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin; Dave Longley.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
    </dd><dt id="bib-owasp-top-10">[OWASP-Top-10]</dt><dd>
      <a href="https://owasp.org/www-project-top-ten/"><cite>OWASP Top Ten</cite></a>.  OWASP. URL: <a href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a>
    </dd><dt id="bib-rfc1738">[RFC1738]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc1738"><cite>Uniform Resource Locators (URL)</cite></a>. T. Berners-Lee; L. Masinter; M. McCahill.  IETF. December 1994. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc1738">https://www.rfc-editor.org/rfc/rfc1738</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3339">[RFC3339]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3339"><cite>Date and Time on the Internet: Timestamps</cite></a>. G. Klyne; C. Newman.  IETF. July 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3339">https://www.rfc-editor.org/rfc/rfc3339</a>
    </dd><dt id="bib-rfc4122">[RFC4122]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc4122"><cite>A Universally Unique IDentifier (UUID) URN Namespace</cite></a>. P. Leach; M. Mealling; R. Salz.  IETF. July 2005. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4122">https://www.rfc-editor.org/rfc/rfc4122</a>
    </dd><dt id="bib-rfc4279">[RFC4279]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc4279"><cite>Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</cite></a>. P. Eronen, Ed.; H. Tschofenig, Ed..  IETF. December 2005. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4279">https://www.rfc-editor.org/rfc/rfc4279</a>
    </dd><dt id="bib-rfc6335">[RFC6335]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6335"><cite>Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry</cite></a>. M. Cotton; L. Eggert; J. Touch; M. Westerlund; S. Cheshire.  IETF. August 2011. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc6335">https://www.rfc-editor.org/rfc/rfc6335</a>
    </dd><dt id="bib-rfc6690">[RFC6690]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6690"><cite>Constrained RESTful Environments (CoRE) Link Format</cite></a>. Z. Shelby.  IETF. August 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>
    </dd><dt id="bib-rfc6762">[RFC6762]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6762"><cite>Multicast DNS</cite></a>. S. Cheshire; M. Krochmal.  IETF. February 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>
    </dd><dt id="bib-rfc6763">[RFC6763]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6763"><cite>DNS-Based Service Discovery</cite></a>. S. Cheshire; M. Krochmal.  IETF. February 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6763">https://www.rfc-editor.org/rfc/rfc6763</a>
    </dd><dt id="bib-rfc7231">[RFC7231]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..  IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
    </dd><dt id="bib-rfc7396">[RFC7396]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7396"><cite>JSON Merge Patch</cite></a>. P. Hoffman; J. Snell.  IETF. October 2014. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7396">https://www.rfc-editor.org/rfc/rfc7396</a>
    </dd><dt id="bib-rfc7595">[RFC7595]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7595"><cite>Guidelines and Registration Procedures for URI Schemes</cite></a>. D. Thaler, Ed.; T. Hansen; T. Hardie.  IETF. June 2015. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc7595">https://www.rfc-editor.org/rfc/rfc7595</a>
    </dd><dt id="bib-rfc7807">[RFC7807]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7807"><cite>Problem Details for HTTP APIs</cite></a>. M. Nottingham; E. Wilde.  IETF. March 2016. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7807">https://www.rfc-editor.org/rfc/rfc7807</a>
    </dd><dt id="bib-rfc7959">[RFC7959]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7959"><cite>Block-Wise Transfers in the Constrained Application Protocol (CoAP)</cite></a>. C. Bormann; Z. Shelby, Ed..  IETF. August 2016. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7959">https://www.rfc-editor.org/rfc/rfc7959</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8288">[RFC8288]</dt><dd>
      <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. M. Nottingham.  IETF. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
    </dd><dt id="bib-rfc8615">[RFC8615]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8615"><cite>Well-Known Uniform Resource Identifiers (URIs)</cite></a>. M. Nottingham.  IETF. May 2019. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8615">https://www.rfc-editor.org/rfc/rfc8615</a>
    </dd><dt id="bib-rfc8981">[RFC8981]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8981"><cite>Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6</cite></a>. F. Gont; S. Krishnan; T. Narten; R. Draves.  IETF. February 2021. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8981">https://www.rfc-editor.org/rfc/rfc8981</a>
    </dd><dt id="bib-rfc9000">[RFC9000]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9000"><cite>QUIC: A UDP-Based Multiplexed and Secure Transport</cite></a>. J. Iyengar, Ed.; M. Thomson, Ed..  IETF. May 2021. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>
    </dd><dt id="bib-rfc9175">[RFC9175]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9175"><cite>Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing</cite></a>. C. Amsüss; J. Preuß Mattsson; G. Selander.  IETF. February 2022. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9175">https://www.rfc-editor.org/rfc/rfc9175</a>
    </dd><dt id="bib-rfc9176">[RFC9176]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9176"><cite>Constrained RESTful Environments (CoRE) Resource Directory</cite></a>. C. Amsüss, Ed.; Z. Shelby; M. Koster; C. Bormann; P. van der Stok.  IETF. April 2022. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9176">https://www.rfc-editor.org/rfc/rfc9176</a>
    </dd><dt id="bib-sparql11-overview">[SPARQL11-OVERVIEW]</dt><dd>
      <a href="https://www.w3.org/TR/sparql11-overview/"><cite>SPARQL 1.1 Overview</cite></a>. The W3C SPARQL Working Group.  W3C. 21 March 2013. W3C Recommendation. URL: <a href="https://www.w3.org/TR/sparql11-overview/">https://www.w3.org/TR/sparql11-overview/</a>
    </dd><dt id="bib-wot-architecture11">[wot-architecture11]</dt><dd>
      <a href="https://www.w3.org/TR/wot-architecture11/"><cite>Web of Things (WoT) Architecture 1.1</cite></a>. Michael Lagally; Ryuichi Matsukura; Kunihiko Toumura.  W3C. 7 September 2022. W3C Working Draft. URL: <a href="https://www.w3.org/TR/wot-architecture11/">https://www.w3.org/TR/wot-architecture11/</a>
    </dd><dt id="bib-wot-thing-description11">[wot-thing-description11]</dt><dd>
      <a href="https://www.w3.org/TR/wot-thing-description11/"><cite>Web of Things (WoT) Thing Description 1.1</cite></a>. Sebastian Käbisch; Takuki Kamiya; Michael McCool; Victor Charpenay.  W3C. 3 August 2022. W3C Working Draft. URL: <a href="https://www.w3.org/TR/wot-thing-description11/">https://www.w3.org/TR/wot-thing-description11/</a>
    </dd><dt id="bib-wot-usecases">[wot-usecases]</dt><dd>
      <a href="https://w3c.github.io/wot-usecases/"><cite>Web of Things (WoT): Use Cases</cite></a>. Michael Lagally; Michael McCool; Ryuichi Matsukura; Tomoaki Mizushima.  W3C. 15 October 2020. Editor's Draft. URL: <a href="https://w3c.github.io/wot-usecases/">https://w3c.github.io/wot-usecases/</a>
    </dd><dt id="bib-xpath-31">[xpath-31]</dt><dd>
      <a href="https://www.w3.org/TR/xpath-31/"><cite>XML Path Language (XPath) 3.1</cite></a>. Jonathan Robie; Michael Dyck; Josh Spiegel.  W3C. 21 March 2017. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xpath-31/">https://www.w3.org/TR/xpath-31/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="d-2-informative-references"><bdi class="secno">D.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix D.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-jsonpath">[JSONPATH]</dt><dd>
      <a href="https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base"><cite>JSONPath: Query expressions for JSON</cite></a>. Stefan Gössner; Glyn Normington; Carsten Bormann.  IETF. DRAFT. URL: <a href="https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base">https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base</a>
    </dd><dt id="bib-ldp-paging">[LDP-Paging]</dt><dd>
      <a href="https://www.w3.org/TR/ldp-paging/"><cite>Linked Data Platform Paging 1.0</cite></a>. Steve Speicher; John Arwe; Ashok Malhotra.  W3C. 30 June 2015. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/ldp-paging/">https://www.w3.org/TR/ldp-paging/</a>
    </dd><dt id="bib-rest-iot">[REST-IOT]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06"><cite>RESTful Design for Internet of Things Systems</cite></a>. Ari Keranen; Matthias Kovatsch; Klaus Hartke.  IETF. 11 May 2020. URL: <a href="https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06">https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06</a>
    </dd><dt id="bib-rfc7230">[RFC7230]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7230.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. R. Fielding, Ed.; J. Reschke, Ed..  IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
    </dd><dt id="bib-rfc7540">[RFC7540]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7540.html"><cite>Hypertext Transfer Protocol Version 2 (HTTP/2)</cite></a>. M. Belshe; R. Peon; M. Thomson, Ed..  IETF. May 2015. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7540.html">https://httpwg.org/specs/rfc7540.html</a>
    </dd><dt id="bib-rfc8323">[RFC8323]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8323"><cite>CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets</cite></a>. C. Bormann; S. Lemay; H. Tschofenig; K. Hartke; B. Silverajan; B. Raymor, Ed..  IETF. February 2018. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8323">https://www.rfc-editor.org/rfc/rfc8323</a>
    </dd><dt id="bib-wot-security">[WOT-SECURITY]</dt><dd>
      <a href="https://www.w3.org/TR/wot-security/"><cite>Web of Things (WoT) Security and Privacy Guidelines</cite></a>. Elena Reshetova; Michael McCool.  W3C. 6 November 2019. W3C Working Group Note. URL: <a href="https://www.w3.org/TR/wot-security/">https://www.w3.org/TR/wot-security/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing" aria-label="Links in this document to definition: Thing">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-thing" aria-label="Permalink for definition: Thing. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-thing-1" title="§ 6.4 CoRE Link Format and CoRE Resource Directory">§ 6.4 CoRE Link Format and CoRE Resource Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-thing-2" title="§ 6.5 DID Documents">§ 6.5 DID Documents</a> <a href="#ref-for-dfn-thing-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-thing-4" title="§ 7.2 Thing Description Server">§ 7.2 Thing Description Server</a> 
  </li><li>
    <a href="#ref-for-dfn-thing-5" title="§ 7.3 Thing Description Directory">§ 7.3 Thing Description Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-thing-6" title="§ 7.3.2.1.1 Creation">§ 7.3.2.1.1 Creation</a> <a href="#ref-for-dfn-thing-7" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing-description" aria-label="Links in this document to definition: Thing Description">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-thing-description" aria-label="Permalink for definition: Thing Description. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-thing-description-1" title="§ 4. Architecture">§ 4. Architecture</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-td" aria-label="Links in this document to definition: TD">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-td" aria-label="Permalink for definition: TD. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-td-1" title="§ 6.5 DID Documents">§ 6.5 DID Documents</a> <a href="#ref-for-dfn-td-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-td-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-4" title="§ 7.1 Overview">§ 7.1 Overview</a> <a href="#ref-for-dfn-td-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-6" title="§ 7.1.1.2 ThingLink">§ 7.1.1.2 ThingLink</a> <a href="#ref-for-dfn-td-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-td-8" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-9" title="§ 7.2 Thing Description Server">§ 7.2 Thing Description Server</a> <a href="#ref-for-dfn-td-10" title="Reference 2">(2)</a> <a href="#ref-for-dfn-td-11" title="Reference 3">(3)</a> <a href="#ref-for-dfn-td-12" title="Reference 4">(4)</a> <a href="#ref-for-dfn-td-13" title="Reference 5">(5)</a> <a href="#ref-for-dfn-td-14" title="Reference 6">(6)</a> <a href="#ref-for-dfn-td-15" title="Reference 7">(7)</a> <a href="#ref-for-dfn-td-16" title="Reference 8">(8)</a> <a href="#ref-for-dfn-td-17" title="Reference 9">(9)</a> <a href="#ref-for-dfn-td-18" title="Reference 10">(10)</a> <a href="#ref-for-dfn-td-19" title="Reference 11">(11)</a> <a href="#ref-for-dfn-td-20" title="Reference 12">(12)</a> <a href="#ref-for-dfn-td-21" title="Reference 13">(13)</a> <a href="#ref-for-dfn-td-22" title="Reference 14">(14)</a> <a href="#ref-for-dfn-td-23" title="Reference 15">(15)</a> <a href="#ref-for-dfn-td-24" title="Reference 16">(16)</a> <a href="#ref-for-dfn-td-25" title="Reference 17">(17)</a> <a href="#ref-for-dfn-td-26" title="Reference 18">(18)</a> <a href="#ref-for-dfn-td-27" title="Reference 19">(19)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-28" title="§ 7.3.1 Information Model">§ 7.3.1 Information Model</a> <a href="#ref-for-dfn-td-29" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-30" title="§ 7.3.1.1 Registration Information">§ 7.3.1.1 Registration Information</a> <a href="#ref-for-dfn-td-31" title="Reference 2">(2)</a> <a href="#ref-for-dfn-td-32" title="Reference 3">(3)</a> <a href="#ref-for-dfn-td-33" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-34" title="§ 7.3.1.2 Registration Expiry">§ 7.3.1.2 Registration Expiry</a> <a href="#ref-for-dfn-td-35" title="Reference 2">(2)</a> <a href="#ref-for-dfn-td-36" title="Reference 3">(3)</a> <a href="#ref-for-dfn-td-37" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-38" title="§ 7.3.2.1 Things API">§ 7.3.2.1 Things API</a> <a href="#ref-for-dfn-td-39" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-40" title="§ 7.3.2.1.1 Creation">§ 7.3.2.1.1 Creation</a> <a href="#ref-for-dfn-td-41" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-42" title="§ 7.3.2.1.3 Update">§ 7.3.2.1.3 Update</a> 
  </li><li>
    <a href="#ref-for-dfn-td-43" title="§ 7.3.2.2 Events API">§ 7.3.2.2 Events API</a> <a href="#ref-for-dfn-td-44" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-td-45" title="§ 7.3.2.3 Search API">§ 7.3.2.3 Search API</a> 
  </li><li>
    <a href="#ref-for-dfn-td-46" title="§ 10.1 Incremental Transfer">§ 10.1 Incremental Transfer</a> 
  </li><li>
    <a href="#ref-for-dfn-td-47" title="§ A. JSON Schema for WoT Discovery TD-extensions">§ A. JSON Schema for WoT Discovery TD-extensions</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing-model" aria-label="Links in this document to definition: Thing Model">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-thing-model" aria-label="Permalink for definition: Thing Model. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-thing-model-1" title="§ 7.3.2.4 API Specification (Thing Model)">§ 7.3.2.4 API Specification (Thing Model)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-tm" aria-label="Links in this document to definition: TM">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-tm" aria-label="Permalink for definition: TM. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-property" aria-label="Links in this document to definition: Property">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-property" aria-label="Permalink for definition: Property. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-action" aria-label="Links in this document to definition: Action">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-action" aria-label="Permalink for definition: Action. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-event" aria-label="Links in this document to definition: Event">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-event" aria-label="Permalink for definition: Event. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-anonymous-thing-description" aria-label="Links in this document to definition: Anonymous TD">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-anonymous-thing-description" aria-label="Permalink for definition: Anonymous TD. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-anonymous-thing-description-1" title="§ 7.3.1.3 Anonymous TD Identifiers">§ 7.3.1.3 Anonymous TD Identifiers</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-anonymous-thing-description-2" title="§ 7.3.2.1.1 Creation">§ 7.3.2.1.1 Creation</a> <a href="#ref-for-dfn-wot-anonymous-thing-description-3" title="Reference 2">(2)</a> <a href="#ref-for-dfn-wot-anonymous-thing-description-4" title="Reference 3">(3)</a> <a href="#ref-for-dfn-wot-anonymous-thing-description-5" title="Reference 4">(4)</a> <a href="#ref-for-dfn-wot-anonymous-thing-description-6" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-anonymous-thing-description-7" title="§ 7.3.2.1.2 Retrieval">§ 7.3.2.1.2 Retrieval</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-discoverer" aria-label="Links in this document to definition: Discoverer">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-discoverer" aria-label="Permalink for definition: Discoverer. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-discoverer-1" title="§ 5. Discoverer Process">§ 5. Discoverer Process</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-discoverer-2" title="§ 7.3.2.1.1 Creation">§ 7.3.2.1.1 Creation</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-discovery" aria-label="Links in this document to definition: Discovery">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-discovery" aria-label="Permalink for definition: Discovery. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-exploration" aria-label="Links in this document to definition: Exploration">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-exploration" aria-label="Permalink for definition: Exploration. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-introduction" aria-label="Links in this document to definition: Introduction">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-introduction" aria-label="Permalink for definition: Introduction. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-thing-description-server" aria-label="Links in this document to definition: Thing Description Server">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-thing-description-server" aria-label="Permalink for definition: Thing Description Server. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-td-server" aria-label="Links in this document to definition: TD Server">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-td-server" aria-label="Permalink for definition: TD Server. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-td-server-1" title="§ 7.1 Overview">§ 7.1 Overview</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-thing-description-directory" aria-label="Links in this document to definition: Thing Description Directory">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-thing-description-directory" aria-label="Permalink for definition: Thing Description Directory. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-thing-description-directory-1" title="§ 6. Introduction Mechanisms">§ 6. Introduction Mechanisms</a> <a href="#ref-for-dfn-wot-thing-description-directory-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-3" title="§ 6.1 Direct">§ 6.1 Direct</a> <a href="#ref-for-dfn-wot-thing-description-directory-4" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-5" title="§ 6.2 Well-Known URIs">§ 6.2 Well-Known URIs</a> <a href="#ref-for-dfn-wot-thing-description-directory-6" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-7" title="§ 6.3 DNS-Based Service Discovery">§ 6.3 DNS-Based Service Discovery</a> <a href="#ref-for-dfn-wot-thing-description-directory-8" title="Reference 2">(2)</a> <a href="#ref-for-dfn-wot-thing-description-directory-9" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-10" title="§ 6.4 CoRE Link Format and CoRE Resource Directory">§ 6.4 CoRE Link Format and CoRE Resource Directory</a> <a href="#ref-for-dfn-wot-thing-description-directory-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-wot-thing-description-directory-12" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-13" title="§ 6.5 DID Documents">§ 6.5 DID Documents</a> <a href="#ref-for-dfn-wot-thing-description-directory-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-wot-thing-description-directory-15" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-16" title="§ 7.1 Overview">§ 7.1 Overview</a> <a href="#ref-for-dfn-wot-thing-description-directory-17" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-18" title="§ 7.3 Thing Description Directory">§ 7.3 Thing Description Directory</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-19" title="§ 7.3.1 Information Model">§ 7.3.1 Information Model</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-20" title="§ 7.3.1.1 Registration Information">§ 7.3.1.1 Registration Information</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-21" title="§ 11.3 CoRE Resource Types Registration">§ 11.3 CoRE Resource Types Registration</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-thing-description-directory-22" title="§ 12.1 DID Service Name Registration">§ 12.1 DID Service Name Registration</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-tdd" aria-label="Links in this document to definition: TDD">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-tdd" aria-label="Permalink for definition: TDD. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-tdd-1" title="§ A. JSON Schema for WoT Discovery TD-extensions">§ A. JSON Schema for WoT Discovery TD-extensions</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-partial-thing-description" aria-label="Links in this document to definition: Partial TD">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-partial-thing-description" aria-label="Permalink for definition: Partial TD. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-partial-thing-description-1" title="§ 7.3.2.1.3 Update">§ 7.3.2.1.3 Update</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-partial-thing-description-2" title="§ 7.3.2.2 Events API">§ 7.3.2.2 Events API</a> <a href="#ref-for-dfn-wot-partial-thing-description-3" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-enriched-thing-description" aria-label="Links in this document to definition: Enriched TD">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-wot-enriched-thing-description" aria-label="Permalink for definition: Enriched TD. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-wot-enriched-thing-description-1" title="§ 7.3.1 Information Model">§ 7.3.1 Information Model</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-enriched-thing-description-2" title="§ 7.3.1.1 Registration Information">§ 7.3.1.1 Registration Information</a> <a href="#ref-for-dfn-wot-enriched-thing-description-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-enriched-thing-description-4" title="§ 7.3.2.1.2 Retrieval">§ 7.3.2.1.2 Retrieval</a> <a href="#ref-for-dfn-wot-enriched-thing-description-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-enriched-thing-description-6" title="§ 7.3.2.1.6 Validation">§ 7.3.2.1.6 Validation</a> 
  </li><li>
    <a href="#ref-for-dfn-wot-enriched-thing-description-7" title="§ A. JSON Schema for WoT Discovery TD-extensions">§ A. JSON Schema for WoT Discovery TD-extensions</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>