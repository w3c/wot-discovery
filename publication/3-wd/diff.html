<!DOCTYPE html>
<html lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xml:lang=
"en-US">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux version 5.7.27" />
<meta charset="utf-8" />
<meta name="generator" content="ReSpec 32.1.10" />
<meta name="viewport" content=
"width=device-width, initial-scale=1, shrink-to-fit=no" />
<style>
<![CDATA[
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
]]>
</style>

<style>
<![CDATA[
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
]]>
</style>

<style>
<![CDATA[
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
]]>
</style>
<title>Web of Things (WoT) Discovery</title>

<style type="text/css">
/*<![CDATA[*/

a[href].internalDFN {
        color: inherit;
        border-bottom: 1px solid #99c;
        text-decoration: none;
}
img.wot-diagram {
    max-width: 90%;
    height: auto;
}
.rfc2119-assertion {
  background-color: rgb(230,230,230)
}

/*]]>*/
</style>

<style id="respec-mainstyle">
<![CDATA[
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
]]>
</style>
<meta name="description" content=
"The W3C Web of Things (WoT) is intended to enable interoperability across IoT platforms and application domains. One key mechanism for accomplishing this goal is the definition and use of metadata describing the interactions an IoT device or service makes available over the network at a suitable level of abstraction. The WoT Thing Description specification satisfies this objective." />
<link rel="canonical" href=
"https://www.w3.org/TR/wot-discovery/" />
<script type="application/ld+json">
<![CDATA[
{
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en-US",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/wot-discovery/",
  "type": [
    "TechArticle",
    "w3p:WD"
  ],
  "name": "Web of Things (WoT) Discovery",
  "inLanguage": "en-US",
  "license": "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document",
  "datePublished": "2022-07-18",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/wot-discovery/issues/",
  "alternativeHeadline": "",
  "isBasedOn": "https://www.w3.org/TR/2021/WD-wot-discovery-20210602/",
  "description": "The W3C Web of Things (WoT) is intended to enable\n           interoperability across IoT platforms and application\n           domains.  One key mechanism for accomplishing this goal\n           is the definition and use of metadata describing the\n           interactions an IoT device or service makes available\n           over the network at a suitable level of abstraction.  \n           The WoT Thing Description specification satisfies this objective.",
  "editor": [
    {
      "type": "Person",
      "name": "Andrea Cimmino",
      "worksFor": {
        "name": "Universidad Politécnica de Madrid",
        "url": "https://www.upm.es/"
      }
    },
    {
      "type": "Person",
      "name": "Michael McCool",
      "worksFor": {
        "name": "Intel Corp.",
        "url": "https://www.intel.com/"
      }
    },
    {
      "type": "Person",
      "name": "Farshid Tavakolizadeh",
      "worksFor": {
        "name": "Invited Expert"
      }
    },
    {
      "type": "Person",
      "name": "Kunihiko Toumura",
      "worksFor": {
        "name": "Hitachi, Ltd.",
        "url": "https://www.hitachi.com/"
      }
    }
  ],
  "contributor": [],
  "citation": [
    {
      "id": "https://www.w3.org/TR/wot-architecture11/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Architecture 1.1",
      "url": "https://www.w3.org/TR/wot-architecture11/",
      "creator": [
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Toru Kawaguchi"
        },
        {
          "name": "Kunihiko Toumura"
        },
        {
          "name": "Kazuo Kajimoto"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-thing-description11/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Thing Description 1.1",
      "url": "https://www.w3.org/TR/wot-thing-description11/",
      "creator": [
        {
          "name": "Sebastian Käbisch"
        },
        {
          "name": "Takuki Kamiya"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Victor Charpenay"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/sparql11-overview/",
      "type": "TechArticle",
      "name": "SPARQL 1.1 Overview",
      "url": "https://www.w3.org/TR/sparql11-overview/",
      "creator": [
        {
          "name": "The W3C SPARQL Working Group"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://w3c.github.io/wot-usecases/",
      "type": "TechArticle",
      "name": "Web of Things (WoT): Use Cases",
      "url": "https://w3c.github.io/wot-usecases/",
      "creator": [
        {
          "name": "Michael Lagally"
        },
        {
          "name": "Michael McCool"
        },
        {
          "name": "Ryuichi Matsukura"
        },
        {
          "name": "Tomoaki Mizushima"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8615",
      "type": "TechArticle",
      "name": "Well-Known Uniform Resource Identifiers (URIs)",
      "url": "https://www.rfc-editor.org/rfc/rfc8615",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6763",
      "type": "TechArticle",
      "name": "DNS-Based Service Discovery",
      "url": "https://www.rfc-editor.org/rfc/rfc6763",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6762",
      "type": "TechArticle",
      "name": "Multicast DNS",
      "url": "https://www.rfc-editor.org/rfc/rfc6762",
      "creator": [
        {
          "name": "S. Cheshire"
        },
        {
          "name": "M. Krochmal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2782",
      "type": "TechArticle",
      "name": "A DNS RR for specifying the location of services (DNS SRV)",
      "url": "https://www.rfc-editor.org/rfc/rfc2782",
      "creator": [
        {
          "name": "A. Gulbrandsen"
        },
        {
          "name": "P. Vixie"
        },
        {
          "name": "L. Esibov"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6690",
      "type": "TechArticle",
      "name": "Constrained RESTful Environments (CoRE) Link Format",
      "url": "https://www.rfc-editor.org/rfc/rfc6690",
      "creator": [
        {
          "name": "Z. Shelby"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "type": "TechArticle",
      "name": "CoRE Resource Directory",
      "url": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "creator": [
        {
          "name": "Christian Amsüss"
        },
        {
          "name": "Zach Shelby"
        },
        {
          "name": "Michael Koster"
        },
        {
          "name": "Carsten Bormann"
        },
        {
          "name": "Peter van der Stok"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/did-core/",
      "type": "TechArticle",
      "name": "Decentralized Identifiers (DIDs) v1.0",
      "url": "https://www.w3.org/TR/did-core/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Amy Guy"
        },
        {
          "name": "Markus Sabadello"
        },
        {
          "name": "Drummond Reed"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1",
      "url": "https://www.w3.org/TR/json-ld11/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Pierre-Antoine Champin"
        },
        {
          "name": "Dave Longley"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7959",
      "type": "TechArticle",
      "name": "Block-Wise Transfers in the Constrained Application Protocol (CoAP)",
      "url": "https://www.rfc-editor.org/rfc/rfc7959",
      "creator": [
        {
          "name": "C. Bormann"
        },
        {
          "name": "Z. Shelby, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc4122",
      "type": "TechArticle",
      "name": "A Universally Unique IDentifier (UUID) URN Namespace",
      "url": "https://www.rfc-editor.org/rfc/rfc4122",
      "creator": [
        {
          "name": "P. Leach"
        },
        {
          "name": "M. Mealling"
        },
        {
          "name": "R. Salz"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7807",
      "type": "TechArticle",
      "name": "Problem Details for HTTP APIs",
      "url": "https://www.rfc-editor.org/rfc/rfc7807",
      "creator": [
        {
          "name": "M. Nottingham"
        },
        {
          "name": "E. Wilde"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7231.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content",
      "url": "https://httpwg.org/specs/rfc7231.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc7396",
      "type": "TechArticle",
      "name": "JSON Merge Patch",
      "url": "https://www.rfc-editor.org/rfc/rfc7396",
      "creator": [
        {
          "name": "P. Hoffman"
        },
        {
          "name": "J. Snell"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc8288.html",
      "type": "TechArticle",
      "name": "Web Linking",
      "url": "https://httpwg.org/specs/rfc8288.html",
      "creator": [
        {
          "name": "M. Nottingham"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/eventsource/",
      "type": "TechArticle",
      "name": "Server-Sent Events",
      "url": "https://www.w3.org/TR/eventsource/",
      "creator": [
        {
          "name": "Ian Hickson"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/xpath-31/",
      "type": "TechArticle",
      "name": "XML Path Language (XPath) 3.1",
      "url": "https://www.w3.org/TR/xpath-31/",
      "creator": [
        {
          "name": "Jonathan Robie"
        },
        {
          "name": "Michael Dyck"
        },
        {
          "name": "Josh Spiegel"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://owasp.org/www-project-top-ten/",
      "type": "TechArticle",
      "name": "OWASP Top Ten",
      "url": "https://owasp.org/www-project-top-ten/",
      "publisher": {
        "name": "OWASP"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9175",
      "type": "TechArticle",
      "name": "Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing",
      "url": "https://www.rfc-editor.org/rfc/rfc9175",
      "creator": [
        {
          "name": "C. Amsüss"
        },
        {
          "name": "J. Preuß Mattsson"
        },
        {
          "name": "G. Selander"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9000",
      "type": "TechArticle",
      "name": "QUIC: A UDP-Based Multiplexed and Secure Transport",
      "url": "https://www.rfc-editor.org/rfc/rfc9000",
      "creator": [
        {
          "name": "J. Iyengar, Ed."
        },
        {
          "name": "M. Thomson, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc4279",
      "type": "TechArticle",
      "name": "Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)",
      "url": "https://www.rfc-editor.org/rfc/rfc4279",
      "creator": [
        {
          "name": "P. Eronen, Ed."
        },
        {
          "name": "H. Tschofenig, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://gdpr-info.eu/art-4-gdpr/",
      "type": "TechArticle",
      "name": "General Data Protection Regulation (GDPR) Article 4 - Definitions",
      "url": "https://gdpr-info.eu/art-4-gdpr/",
      "publisher": {
        "name": "European Union (EU) and the European Economic Area (EEA)"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8981",
      "type": "TechArticle",
      "name": "Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6",
      "url": "https://www.rfc-editor.org/rfc/rfc8981",
      "creator": [
        {
          "name": "F. Gont"
        },
        {
          "name": "S. Krishnan"
        },
        {
          "name": "T. Narten"
        },
        {
          "name": "R. Draves"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc6335",
      "type": "TechArticle",
      "name": "Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry",
      "url": "https://www.rfc-editor.org/rfc/rfc6335",
      "creator": [
        {
          "name": "M. Cotton"
        },
        {
          "name": "L. Eggert"
        },
        {
          "name": "J. Touch"
        },
        {
          "name": "M. Westerlund"
        },
        {
          "name": "S. Cheshire"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://www.rfc-editor.org/rfc/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://www.rfc-editor.org/rfc/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8552",
      "type": "TechArticle",
      "name": "Scoped Interpretation of DNS Resource Records through \"Underscored\" Naming of Attribute Leaves",
      "url": "https://www.rfc-editor.org/rfc/rfc8552",
      "creator": [
        {
          "name": "D. Crocker"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "type": "TechArticle",
      "name": "RESTful Design for Internet of Things Systems",
      "url": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "creator": [
        {
          "name": "Ari Keranen"
        },
        {
          "name": "Matthias Kovatsch"
        },
        {
          "name": "Klaus Hartke"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/ldp-paging/",
      "type": "TechArticle",
      "name": "Linked Data Platform Paging 1.0",
      "url": "https://www.w3.org/TR/ldp-paging/",
      "creator": [
        {
          "name": "Steve Speicher"
        },
        {
          "name": "John Arwe"
        },
        {
          "name": "Ashok Malhotra"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "type": "TechArticle",
      "name": "JSONPath: Query expressions for JSON",
      "url": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "creator": [
        {
          "name": "Stefan Gössner"
        },
        {
          "name": "Glyn Normington"
        },
        {
          "name": "Carsten Bormann"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/wot-security/",
      "type": "TechArticle",
      "name": "Web of Things (WoT) Security and Privacy Guidelines",
      "url": "https://www.w3.org/TR/wot-security/",
      "creator": [
        {
          "name": "Elena Reshetova"
        },
        {
          "name": "Michael McCool"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7230.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing",
      "url": "https://httpwg.org/specs/rfc7230.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7540.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol Version 2 (HTTP/2)",
      "url": "https://httpwg.org/specs/rfc7540.html",
      "creator": [
        {
          "name": "M. Belshe"
        },
        {
          "name": "R. Peon"
        },
        {
          "name": "M. Thomson, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8323",
      "type": "TechArticle",
      "name": "CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets",
      "url": "https://www.rfc-editor.org/rfc/rfc8323",
      "creator": [
        {
          "name": "C. Bormann"
        },
        {
          "name": "S. Lemay"
        },
        {
          "name": "H. Tschofenig"
        },
        {
          "name": "K. Hartke"
        },
        {
          "name": "B. Silverajan"
        },
        {
          "name": "B. Raymor, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    }
  ]
}
]]>
</script>
<style>
<![CDATA[
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
]]>
</style>

<style>
<![CDATA[
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
]]>
</style>

<script id="initialUserConfig" type="application/json">
<![CDATA[
{
  "lint": {
    "check-punctuation": true,
    "local-refs-exist": true,
    "no-http-props": true,
    "no-headingless-sections": true,
    "no-unused-dfns": false
  },
  "doJsonLd": true,
  "specStatus": "WD",
  "implementationReportURI": "https://w3c.github.io/wot-discovery/testing/report.html",
  "shortName": "wot-discovery",
  "copyrightStart": 2017,
  "group": "wg/wot",
  "wgPublicList": "public-wot-wg",
  "github": {
    "repoURL": "https://github.com/w3c/wot-discovery",
    "branch": "main"
  },
  "previousPublishDate": "2021-06-02",
  "previousMaturity": "FPWD",
  "editors": [
    {
      "name": "Andrea Cimmino",
      "w3cid": "115672",
      "company": "Universidad Politécnica de Madrid",
      "companyURL": "https://www.upm.es/"
    },
    {
      "name": "Michael McCool",
      "w3cid": "93137",
      "company": "Intel Corp.",
      "companyURL": "https://www.intel.com/"
    },
    {
      "name": "Farshid Tavakolizadeh",
      "w3cid": "122520",
      "company": "Invited Expert"
    },
    {
      "name": "Kunihiko Toumura",
      "w3cid": "83488",
      "company": "Hitachi, Ltd.",
      "companyURL": "https://www.hitachi.com/"
    }
  ],
  "formerEditors": [
    {
      "name": "Farshid Tavakolizadeh",
      "w3cid": "122520",
      "company": "Fraunhofer-Gesellschaft",
      "companyURL": "https://www.fraunhofer.de/",
      "retiredDate": "2021-09-30"
    }
  ],
  "otherLinks": [
    {
      "key": "Contributors",
      "data": [
        {
          "value": "In the GitHub repository",
          "href": "https://github.com/w3c/wot-discovery/graphs/contributors"
        }
      ]
    }
  ],
  "localBiblio": {
    "GDPR-Defs": {
      "title": "General Data Protection Regulation (GDPR) Article 4 - Definitions",
      "href": "https://gdpr-info.eu/art-4-gdpr/",
      "publisher": "European Union (EU) and the European Economic Area (EEA)",
      "id": "gdpr-defs"
    },
    "OWASP-Top-10": {
      "title": "OWASP Top Ten",
      "href": "https://owasp.org/www-project-top-ten/",
      "publisher": "OWASP",
      "id": "owasp-top-10"
    },
    "REST-IOT": {
      "title": "RESTful Design for Internet of Things Systems",
      "href": "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06",
      "authors": [
        "Ari Keranen",
        "Matthias Kovatsch",
        "Klaus Hartke"
      ],
      "publisher": "IETF",
      "date": "11 May 2020",
      "id": "rest-iot"
    },
    "CoRE-RD": {
      "title": "CoRE Resource Directory",
      "href": "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26",
      "authors": [
        "Christian Amsüss",
        "Zach Shelby",
        "Michael Koster",
        "Carsten Bormann",
        "Peter van der Stok"
      ],
      "publisher": "IETF",
      "date": "2 November 2020",
      "id": "core-rd"
    },
    "JSONPATH": {
      "title": "JSONPath: Query expressions for JSON",
      "href": "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base",
      "authors": [
        "Stefan Gössner",
        "Glyn Normington",
        "Carsten Bormann"
      ],
      "publisher": "IETF",
      "status": "DRAFT",
      "id": "jsonpath"
    },
    "wot-usecases": {
      "title": "Web of Things (WoT): Use Cases",
      "href": "https://w3c.github.io/wot-usecases/",
      "authors": [
        "Michael Lagally",
        "Michael McCool",
        "Ryuichi Matsukura",
        "Tomoaki Mizushima"
      ],
      "publisher": "W3C",
      "date": "15 October 2020",
      "status": "Editor's Draft",
      "id": "wot-usecases"
    }
  },
  "publishISODate": "2022-07-18T00:00:00.000Z",
  "generatedSubtitle": "W3C Working Draft 18 July 2022"
}
]]>
</script>
<link rel="stylesheet" href=
"https://www.w3.org/StyleSheets/TR/2021/W3C-WD" />
<style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>
<body class="h-entry toc-inline">
<div class="head">
<p class="logos">
<a class="logo" href= "https://www.w3.org/">
<img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width= "72" />
</a>
</p>
<h1 id="title" class="title">
Web
of
Things
(WoT)
Discovery
</h1>
<p id="w3c-state">
<a href= "https://www.w3.org/standards/types#WD">
W3C
Working
Draft
<del class="diff-old">2
June
2021
</del>
</a>
<time class="dt-published" datetime="2022-07-18">
<ins class="diff-chg">18
July
2022
</ins>
</time>
</p>
<details open="">
<summary>
<ins class="diff-chg">More
details
about
this
document
</ins></summary>
<dl>
<dt>
This
version:
</dt>
<dd>
<del class="diff-old">https://www.w3.org/TR/2021/WD-wot-discovery-20210602/
</del>
<a class="u-url" href= "https://www.w3.org/TR/2022/WD-wot-discovery-20220718/">
<ins class="diff-chg">https://www.w3.org/TR/2022/WD-wot-discovery-20220718/
</ins>
</a>
</dd>
<dt>
Latest
published
version:
</dt>
<dd>
<a href= "https://www.w3.org/TR/wot-discovery/">
https://www.w3.org/TR/wot-discovery/
</a>
</dd>
<dt>
Latest
editor's
draft:
</dt>
<dd>
<a href= "https://w3c.github.io/wot-discovery/">
https://w3c.github.io/wot-discovery/
</a>
</dd>
<dt>
<del class="diff-old">Previous
version:
</del>
<ins class="diff-chg">History:
</ins>
</dt>
<dd>
<del class="diff-old">https://www.w3.org/TR/2020/WD-wot-discovery-20201124/
</del>
<a href= "https://www.w3.org/standards/history/wot-discovery">
<ins class="diff-chg">https://www.w3.org/standards/history/wot-discovery
</ins></a></dd><dd><a href= "https://github.com/w3c/wot-discovery/commits/main"><ins class="diff-chg">
Commit
history
</ins></a></dd><dt><ins class="diff-chg">
Implementation
report:
</ins></dt><dd><a href= "https://w3c.github.io/wot-discovery/testing/report.html"><ins class="diff-chg">
https://w3c.github.io/wot-discovery/testing/report.html
</ins>
</a>
</dd>
<dt>
Editors:
</dt>
<dd class="editor p-author h-card vcard" data-editor-id="115672">
<span class="p-name fn">
Andrea
Cimmino
</span>
(
<a class= "p-org org h-org" href="https://www.upm.es/">
Universidad
Politécnica
de
Madrid
</a>
)
</dd>
<dd class="editor p-author h-card vcard" data-editor-id="93137">
<span class="p-name fn">
Michael
McCool
</span>
(
<a class= "p-org org h-org" href="https://www.intel.com/">
Intel
Corp.
</a>
)
</dd>
<dd class="editor p-author h-card vcard" data-editor-id="122520">
<span class="p-name fn">
Farshid
Tavakolizadeh
</span>
(
<del class="diff-old">Fraunhofer-Gesellschaft
</del>
<span class= "p-org org h-org">
<ins class="diff-chg">Invited
Expert
</ins></span>
)
</dd>
<dd class="editor p-author h-card vcard" data-editor-id="83488">
<span class="p-name fn">
Kunihiko
Toumura
</span>
(
<a class= "p-org org h-org" href="https://www.hitachi.com/">
Hitachi,
Ltd.
</a>
)
</dd>
<dt>
<del class="diff-old">Participate:
</del>
<ins class="diff-chg">Former
editor:
</ins></dt><dd class="editor p-author h-card vcard" data-editor-id="122520"><span class="p-name fn"><ins class="diff-chg">
Farshid
Tavakolizadeh
</ins></span><ins class="diff-chg">
(
</ins><a class= "p-org org h-org" href= "https://www.fraunhofer.de/"><ins class="diff-chg">
Fraunhofer-Gesellschaft
</ins></a><ins class="diff-chg">
)
-
Until
</ins><time datetime="2021-09-30"><ins class="diff-chg">
30
September
2021
</ins></time></dd><dt><ins class="diff-chg">
Feedback:
</ins>
</dt>
<dd>
<a href="https://github.com/w3c/wot-discovery/">
GitHub
w3c/wot-discovery
</a>
<del class="diff-old">File
an
</del>
<ins class="diff-chg">(
</ins><a href= "https://github.com/w3c/wot-discovery/pulls/"><ins class="diff-chg">
pull
requests
</ins></a>,<a href= "https://github.com/w3c/wot-discovery/issues/new/choose"><ins class="diff-chg">
new
</ins>
issue
</a>,
<a href= "https://github.com/w3c/wot-discovery/issues/">
<ins class="diff-new">open
issues
</ins>
</a>
<ins class="diff-chg">)
</ins>
</dd>
<dd>
<del class="diff-old">Commit
history
</del>
<a href= "mailto:public-wot-wg@w3.org?subject=%5Bwot-discovery%5D%20YOUR%20TOPIC%20HERE">
<ins class="diff-chg">public-wot-wg@w3.org
</ins>
</a>
<ins class="diff-new">with
subject
line
</ins><kbd><ins class="diff-new">
[wot-discovery]
</ins><em><ins class="diff-new">
…
message
topic
…
</ins></em>
<del class="diff-old">Pull
requests
</del>
</kbd>
<ins class="diff-chg">(
</ins><a rel="discussion" href= "https://lists.w3.org/Archives/Public/public-wot-wg"><ins class="diff-chg">
archives
</ins>
</a>
<ins class="diff-chg">)
</ins>
</dd>
<dt>
Contributors
</dt>
<dd>
<a href= "https://github.com/w3c/wot-discovery/graphs/contributors">
In
the
GitHub
repository
</a>
</dd>
</dl>
</details>
<p class="copyright">
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">
Copyright
</a>
©
<del class="diff-old">2017-2021
</del>
<ins class="diff-chg">2017-2022
</ins>
<a href="https://www.w3.org/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
</a>
<sup>
®
</sup>
(
<a href= "https://www.csail.mit.edu/">
<abbr title= "Massachusetts Institute of Technology">
MIT
</abbr>
</a>,
<a href= "https://www.ercim.eu/">
<abbr title= "European Research Consortium for Informatics and Mathematics">
ERCIM
</abbr>
</a>,
<a href="https://www.keio.ac.jp/">
Keio
</a>,
<a href= "https://ev.buaa.edu.cn/">
Beihang
</a>
).
W3C
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
liability
</a>,
<a href= "https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
trademark
</a>
and
<a rel="license" href= "https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" title="W3C Software and Document Notice and License">
permissive
document
license
</a>
rules
apply.
</p>
<hr title="Separator for header" />
</div>
<section id="abstract" class="introductory">
<h2>
Abstract
</h2>
<p>
The
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Web
of
Things
(WoT)
is
intended
to
enable
interoperability
across
IoT
platforms
and
application
domains.
One
key
mechanism
for
accomplishing
this
goal
is
the
definition
and
use
of
metadata
describing
the
interactions
an
IoT
device
or
service
makes
available
over
the
network
at
a
suitable
level
of
abstraction.
The
WoT
Thing
Description
specification
satisfies
this
objective.
</p>
<p>
However,
in
order
to
use
a
Thing
its
Thing
Description
first
has
to
be
obtained.
The
<em>
WoT
Discovery
</em>
process
described
in
this
document
addresses
this
problem.
WoT
Discovery
needs
to
support
the
distribution
of
WoT
Thing
Descriptions
in
a
variety
of
use
cases.
This
includes
ad-hoc
and
engineered
systems;
during
development
and
at
runtime;
and
on
both
local
and
global
networks.
The
process
also
needs
to
work
with
existing
discovery
mechanisms,
be
secure,
protect
private
information,
and
be
able
to
efficiently
handle
updates
to
WoT
Thing
Descriptions
and
the
dynamic
and
diverse
nature
of
the
IoT
ecosystem.
</p>
<p>
The
WoT
Discovery
process
is
divided
into
two
phases,
Introduction,
and
Exploration.
The
Introduction
phase
leverages
existing
discovery
mechanisms
but
does
not
directly
expose
metadata;
they
are
simply
used
to
discover
Exploration
services,
which
provide
metadata
but
only
after
secure
authentication
and
authorization.
This
document
normatively
defines
two
Exploration
<del class="diff-old">services,
one
</del>
<ins class="diff-chg">services:
</ins>
for
<del class="diff-old">WoT
Thing
self-description
with
</del>
<ins class="diff-chg">distributing
</ins>
a
single
WoT
Thing
Description
<ins class="diff-new">from
a
regular
web
service,
including
as
a
special
case
self-description;
</ins>
and
a
searchable
WoT
Thing
Description
Directory
service
for
collections
of
Thing
Descriptions.
A
variety
of
Introduction
services
are
also
described
and
where
necessary
normative
definitions
are
given
to
support
them.
</p>
</section>
<section id="sotd" class="introductory">
<h2>
Status
of
This
Document
</h2>
<p>
<em>
This
section
describes
the
status
of
this
document
at
the
time
of
its
publication.
<del class="diff-old">Other
documents
may
supersede
this
document.
</del>
A
list
of
current
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
publications
and
the
latest
revision
of
this
technical
report
can
be
found
in
the
<a href= "https://www.w3.org/TR/">
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
technical
reports
index
</a>
at
https://www.w3.org/TR/.
</em>
</p>
<p>
This
<ins class="diff-new">is
the
second
Working
Draft
published
for
this
document,
and
is
expected
to
be
the
final
draft
before
CR
transition.
</ins></p><p><ins class="diff-new">
This
</ins>
document
was
published
by
the
<a href= "https://www.w3.org/groups/wg/wot">
Web
of
Things
Working
Group
</a>
as
<del class="diff-old">an
Editor's
Draft.
GitHub
Issues
are
preferred
for
discussion
of
this
specification.
Alternatively,
you
can
send
comments
to
our
mailing
list.
Please
send
them
to
public-wot-wg@w3.org
(
subscribe
,
archives
).
</del>
<ins class="diff-chg">a
Working
Draft
using
the
</ins><a href= "https://www.w3.org/2021/Process-20211102/#recs-and-notes"><ins class="diff-chg">
Recommendation
track
</ins></a>.
</p>
<p>
Publication
as
a
Working
Draft
does
not
imply
endorsement
by
<del class="diff-old">the
</del>
<abbr title="World Wide Web Consortium">
W3C
</abbr>
<del class="diff-old">Membership.
</del>
<ins class="diff-chg">and
its
Members.
</ins>
</p>
<p>
This
is
a
draft
document
and
may
be
updated,
replaced
or
obsoleted
by
other
documents
at
any
time.
It
is
inappropriate
to
cite
this
document
as
other
than
work
in
progress.
</p>
<p>
This
document
was
produced
by
a
group
operating
under
the
<a href="https://www.w3.org/Consortium/Patent-Policy-20170801/">
1
August
2017
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
maintains
a
<a rel= "disclosure" href="https://www.w3.org/groups/wg/wot/ipr">
public
list
of
any
patent
disclosures
</a>
made
in
connection
with
the
deliverables
of
the
group;
that
page
also
includes
instructions
for
disclosing
a
patent.
An
individual
who
has
actual
knowledge
of
a
patent
which
the
individual
believes
contains
<a href= "https://www.w3.org/Consortium/Patent-Policy-20170801/#def-essential">
Essential
Claim(s)
</a>
must
disclose
the
information
in
accordance
with
<a href= "https://www.w3.org/Consortium/Patent-Policy-20170801/#sec-Disclosure">
section
6
of
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
</p>
<p>
This
document
is
governed
by
the
<del class="diff-old">15
September
2020
</del>
<a id="w3c_process_revision" href="https://www.w3.org/2021/Process-20211102/">
<ins class="diff-chg">2
November
2021
</ins>
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Process
Document
</a>.
</p>
</section>
<nav id="toc">
<h2 class="introductory" id="table-of-contents">
Table
of
Contents
</h2>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#abstract">
<ins class="diff-new">Abstract
</ins></a></li><li class="tocline"><a class="tocxref" href="#sotd"><ins class="diff-new">
Status
of
This
Document
</ins></a></li><li class="tocline">
<a class="tocxref" href= "#introduction">
<bdi class="secno">
1.
</bdi>
Introduction
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#conformance">
<bdi class="secno">
2.
</bdi>
Conformance
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#terminology">
<bdi class="secno">
3.
</bdi>
Terminology
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#architecture">
<bdi class="secno">
4.
</bdi>
Architecture
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#discoverer-process">
<bdi class="secno">
5.
</bdi>
<ins class="diff-new">Discoverer
Process
</ins></a></li><li class="tocline"><a class="tocxref" href= "#introduction-mech"><bdi class="secno"><ins class="diff-new">
6.
</ins></bdi>
Introduction
Mechanisms
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#introduction-direct">
<bdi class="secno">
<del class="diff-old">5.1
</del>
<ins class="diff-chg">6.1
</ins>
</bdi>
Direct
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#introduction-well-known">
<bdi class="secno">
<del class="diff-old">5.2
</del>
<ins class="diff-chg">6.2
</ins>
</bdi>
Well-Known
URIs
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#introduction-dns-sd-sec">
<bdi class="secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">6.3
</ins>
</bdi>
DNS-Based
Service
Discovery
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#introduction-core-rd-sec">
<bdi class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</bdi>
CoRE
Link
Format
and
CoRE
Resource
Directory
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#introduction-did-sec">
<bdi class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">6.5
</ins>
</bdi>
DID
Documents
</a>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-mech">
<bdi class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">7.
</ins>
</bdi>
Exploration
Mechanisms
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#exploration-overview">
<bdi class="secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.1
</ins>
</bdi>
<del class="diff-old">Self-description
</del>
<ins class="diff-chg">Overview
</ins></a><ol class="toc"><li class="tocline"><a class="tocxref" href= "#exploration-ontology"><bdi class="secno"><ins class="diff-chg">
7.1.1
</ins></bdi><ins class="diff-chg">
Ontology
</ins></a><ol class="toc"><li class="tocline"><a class="tocxref" href= "#exploration-td-type-thingdirectory"><bdi class= "secno"><ins class="diff-chg">
7.1.1.1
</ins></bdi><code><ins class="diff-chg">
ThingDirectory
</ins></code></a></li><li class="tocline"><a class="tocxref" href= "#exploration-td-type-thinglink"><bdi class="secno"><ins class="diff-chg">
7.1.1.2
</ins></bdi><code><ins class="diff-chg">
ThingLink
</ins></code></a></li></ol></li><li class="tocline"><a class="tocxref" href= "#exploration-secboot"><bdi class="secno"><ins class="diff-chg">
7.1.2
</ins></bdi><ins class="diff-chg">
Security
Bootstrapping
</ins></a></li></ol></li><li class="tocline"><a class="tocxref" href= "#exploration-server"><bdi class="secno"><ins class="diff-chg">
7.2
</ins></bdi><ins class="diff-chg">
Thing
Description
Server
</ins>
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory">
<bdi class="secno">
<del class="diff-old">6.2
</del>
<ins class="diff-chg">7.3
</ins>
</bdi>
<ins class="diff-new">Thing
Description
</ins>
Directory
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-info">
<bdi class="secno">
<del class="diff-old">6.2.1
</del>
<ins class="diff-chg">7.3.1
</ins>
</bdi>
Information
Model
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-registration-info">
<bdi class= "secno">
<ins class="diff-new">7.3.1.1
</ins></bdi><ins class="diff-new">
Registration
Information
</ins></a></li><li class="tocline"><a class="tocxref" href= "#exploration-directory-registration-expiry"><bdi class= "secno"><ins class="diff-new">
7.3.1.2
</ins></bdi><ins class="diff-new">
Registration
Expiry
</ins></a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-anonymous-td">
<bdi class= "secno">
<ins class="diff-new">7.3.1.3
</ins></bdi><ins class="diff-new">
Anonymous
TD
Identifiers
</ins></a></li></ol></li><li class="tocline">
<a class="tocxref" href= "#exploration-directory-api">
<bdi class="secno">
<del class="diff-old">6.2.2
</del>
<ins class="diff-chg">7.3.2
</ins>
</bdi>
Directory
Service
API
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things">
<bdi class= "secno">
<del class="diff-old">6.2.2.1
</del>
<ins class="diff-chg">7.3.2.1
</ins>
</bdi>
<del class="diff-old">Registration
</del>
<ins class="diff-chg">Things
API
</ins>
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-creation">
<bdi class= "secno">
<del class="diff-old">6.2.2.1.1
</del>
<ins class="diff-chg">7.3.2.1.1
</ins>
</bdi>
Creation
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-retrieval">
<bdi class= "secno">
<del class="diff-old">6.2.2.1.2
</del>
<ins class="diff-chg">7.3.2.1.2
</ins>
</bdi>
Retrieval
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-update">
<bdi class= "secno">
<del class="diff-old">6.2.2.1.3
</del>
<ins class="diff-chg">7.3.2.1.3
</ins>
</bdi>
Update
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-deletion">
<bdi class= "secno">
<del class="diff-old">6.2.2.1.4
</del>
<ins class="diff-chg">7.3.2.1.4
</ins>
</bdi>
Deletion
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-listing">
<bdi class= "secno">
<del class="diff-old">6.2.2.1.5
</del>
<ins class="diff-chg">7.3.2.1.5
</ins>
</bdi>
Listing
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-things-validation">
<del class="diff-old">6.2.2.1.6
</del>
<bdi class= "secno">
<ins class="diff-chg">7.3.2.1.6
</ins>
</bdi>
Validation
</a>
</li>
</ol>
</li>
<li class="tocline">
<del class="diff-old">6.2.2.2
Management
</del>
<a class="tocxref" href= "#exploration-directory-api-notification">
<bdi class= "secno">
<del class="diff-old">6.2.2.3
</del>
<ins class="diff-chg">7.3.2.2
</ins>
</bdi>
<del class="diff-old">Notification
</del>
<ins class="diff-chg">Events
API
</ins>
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#exploration-directory-api-search">
<bdi class= "secno">
<del class="diff-old">6.2.2.4
</del>
<ins class="diff-chg">7.3.2.3
</ins>
</bdi>
Search
<ins class="diff-new">API
</ins>
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#jsonpath-semantic">
<bdi class="secno">
<del class="diff-old">6.2.2.4.1
</del>
<ins class="diff-chg">7.3.2.3.1
</ins>
</bdi>
Syntactic
search:
JSONPath
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#xpath-semantic">
<bdi class="secno">
<del class="diff-old">6.2.2.4.2
</del>
<ins class="diff-chg">7.3.2.3.2
</ins>
</bdi>
Syntactic
search:
XPath
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#search-semantic">
<bdi class="secno">
<del class="diff-old">6.2.2.4.3
</del>
<ins class="diff-chg">7.3.2.3.3
</ins>
</bdi>
Semantic
search:
SPARQL
</a>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#directory-api-spec">
<bdi class="secno">
<del class="diff-old">6.2.3
</del>
<ins class="diff-chg">7.3.2.4
</ins>
</bdi>
<del class="diff-old">Security
and
Privacy
</del>
<ins class="diff-chg">API
Specification
(Thing
Model)
</ins>
</a>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#security-considerations">
<bdi class="secno">
<del class="diff-old">7.
</del>
<ins class="diff-chg">8.
</ins>
</bdi>
Security
<del class="diff-old">and
Privacy
</del>
Considerations
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#security-consideration-dos">
<bdi class="secno">
<del class="diff-old">7.1
</del>
<ins class="diff-chg">8.1
</ins>
</bdi>
Denial
of
Service
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#security-consideration-amp-ddos">
<bdi class="secno">
<ins class="diff-chg">8.2
</ins></bdi><ins class="diff-chg">
Amplification
and
Distributed
Denial
of
Service
</ins></a></li><li class="tocline"><a class="tocxref" href= "#security-consideration-lan-self-discovery">
<bdi class= "secno">
<del class="diff-old">7.2
</del>
<ins class="diff-chg">8.3
</ins></bdi><ins class="diff-chg">
Self-Discovery
on
LANs
</ins></a></li></ol></li><li class="tocline"><a class="tocxref" href= "#privacy-considerations"><bdi class="secno"><ins class="diff-chg">
9.
</ins></bdi><ins class="diff-chg">
Privacy
Considerations
</ins></a><ol class="toc"><li class="tocline"><a class="tocxref" href= "#privacy-consideration-location-tracking"><bdi class= "secno"><ins class="diff-chg">
9.1
</ins>
</bdi>
Location
Tracking
<ins class="diff-new">and
Profiling
</ins></a></li><li class="tocline"><a class="tocxref" href= "#privacy-consideration-query-tracking"><bdi class= "secno"><ins class="diff-new">
9.2
</ins></bdi><ins class="diff-new">
Query
Tracking
</ins></a></li></ol></li><li class="tocline"><a class="tocxref" href= "#performance-considerations"><bdi class="secno"><ins class="diff-new">
10.
</ins></bdi><ins class="diff-new">
Performance
Considerations
</ins></a><ol class="toc"><li class="tocline"><a class="tocxref" href= "#perf-incremental-transfer"><bdi class="secno"><ins class="diff-new">
10.1
</ins></bdi><ins class="diff-new">
Incremental
Transfer
</ins>
</a>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#iana-considerations">
<bdi class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">11.
</ins>
</bdi>
IANA
Considerations
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#well-known-uri-suffix">
<bdi class="secno">
<ins class="diff-new">11.1
</ins></bdi><ins class="diff-new">
Well-Known
URI
Registration
</ins></a></li><li class="tocline"><a class="tocxref" href= "#service-name"><bdi class="secno"><ins class="diff-new">
11.2
</ins></bdi><ins class="diff-new">
Service
Name
Registration
</ins></a></li><li class="tocline">
<a class="tocxref" href= "#core-resource-type">
<bdi class="secno">
<del class="diff-old">8.1
</del>
<ins class="diff-chg">11.3
</ins>
</bdi>
CoRE
Resource
Types
Registration
</a>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#tdd-extensions-jsonschema">
<bdi class="secno">
<ins class="diff-new">A.
</ins></bdi><ins class="diff-new">
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins></a></li><li class="tocline">
<a class="tocxref" href="#changes">
<bdi class= "secno">
<del class="diff-old">A.
</del>
<ins class="diff-chg">B.
</ins>
</bdi>
Recent
Specification
Changes
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#changes-from-second-draft">
<bdi class="secno">
<ins class="diff-new">B.1
</ins></bdi><ins class="diff-new">
Changes
from
2
June
2021
Working
Draft
</ins></a></li><li class="tocline">
<a class="tocxref" href= "#changes-from-first-draft">
<bdi class="secno">
<del class="diff-old">A.1
</del>
<ins class="diff-chg">B.2
</ins>
</bdi>
Changes
from
<ins class="diff-new">24
November
2020
</ins>
First
<ins class="diff-new">Public
Working
</ins>
Draft
</a>
</li>
</ol>
</li>
<li class="tocline">
<a class="tocxref" href= "#acknowledgements">
<bdi class="secno">
<del class="diff-old">B.
</del>
<ins class="diff-chg">C.
</ins>
</bdi>
Acknowledgments
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#references">
<bdi class="secno">
<del class="diff-old">C.
</del>
<ins class="diff-chg">D.
</ins>
</bdi>
References
</a>
<ol class="toc">
<li class="tocline">
<a class="tocxref" href= "#normative-references">
<bdi class="secno">
<del class="diff-old">C.1
</del>
<ins class="diff-chg">D.1
</ins>
</bdi>
Normative
references
</a>
</li>
<li class="tocline">
<a class="tocxref" href= "#informative-references">
<bdi class="secno">
<del class="diff-old">C.2
</del>
<ins class="diff-chg">D.2
</ins>
</bdi>
Informative
references
</a>
</li>
</ol>
</li>
</ol>
</nav>
<section id="introduction">
<div class="header-wrapper">
<h2 id="x1-introduction">
<bdi class="secno">
1.
</bdi>
Introduction
</h2>
<a class="self-link" href="#introduction" aria-label= "Permalink for Section 1.">
</a>
</div>
<p>
The
Web
of
Things
(WoT)
defines
an
architecture
that
supports
the
integration
and
use
of
web
technologies
with
IoT
devices.
The
WoT
Architecture
[
<cite>
<del class="diff-old">wot-architecture
</del>
<a class="bibref" data-link-type="biblio" href="#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1">
<ins class="diff-chg">wot-architecture11
</ins>
</a>
</cite>
]
document
defines
the
basic
concepts
and
patterns
of
usage
supported.
However,
the
WoT
Thing
Description
[
<cite>
<del class="diff-old">wot-thing-description
</del>
<a class= "bibref" data-link-type="biblio" href= "#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1">
<ins class="diff-chg">wot-thing-description11
</ins>
</a>
</cite>
]
is
a
key
specification
for
WoT
Discovery
since
it
is
the
purpose
of
WoT
Discovery
to
make
WoT
Thing
Descriptions
available.
Specifically,
WoT
Discovery
has
to
allow
authenticated
and
authorized
entities
(and
only
those
entities)
to
find
WoT
Thing
Descriptions
satisfying
a
set
of
criteria,
such
as
being
near
a
certain
location,
or
having
certain
semantics,
or
containing
certain
interactions.
Conversely,
in
order
to
support
security
and
privacy
objectives,
the
WoT
Discovery
process
must
not
leak
information
to
unauthorized
entities.
This
includes
leaking
information
that
a
given
entity
is
requesting
certain
information,
not
just
the
information
distributed
in
the
Thing
Descriptions
themselves.
</p>
<p>
There
are
already
a
number
of
discovery
mechanisms
defined,
so
we
have
to
establish
why
we
are
proposing
a
new
one.
First,
many
existing
discovery
mechanisms
have
relatively
weak
security
and
privacy
protections.
One
of
our
objectives
is
to
establish
a
mechanism
that
not
only
uses
best
practices
to
protect
metadata,
but
that
can
be
upgraded
to
support
future
best
practices
as
needed.
Second,
we
are
using
discovery
in
a
broad
sense
to
include
both
local
and
non-local
mechanisms.
While
a
local
mechanism
might
use
a
broadcast
protocol,
non-local
mechanisms
might
go
beyond
the
current
network
segment
where
broadcast
is
not
scalable,
and
so
a
different
approach,
such
as
a
search
service,
is
needed.
Our
approach
is
to
use
existing
mechanisms
as
needed
to
bootstrap
into
a
more
general
and
secure
metadata
distribution
system.
Third,
the
metadata
we
are
distributing,
the
WoT
Thing
Description,
is
highly
structured
and
includes
rich
data
such
as
data
schemas
and
semantic
annotations.
Existing
discovery
mechanisms
based
on
a
list
of
simple
key-value
pairs
are
not
appropriate.
At
the
same
time,
use
of
existing
standards
for
semantic
data
query,
such
as
SPARQL
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-sparql11-overview" title= "SPARQL 1.1 Overview">
SPARQL11-OVERVIEW
</a>
</cite>
],
while
potentially
suitable
for
some
advanced
use
cases,
might
require
too
much
effort
for
many
anticipated
IoT
applications.
Therefore
in
order
to
address
more
basic
applications,
we
also
define
some
simpler
query
mechanisms.
</p>
<p>
After
defining
some
basic
terminology,
we
will
summarize
the
basic
use
cases
and
requirements
for
WoT
Discovery.
These
are
a
subset
of
the
more
detailed
and
exhaustive
use
cases
and
requirements
presented
in
the
WoT
Use
Cases
[
<cite>
<a class= "bibref" data-link-type="biblio" href="#bib-wot-usecases" title= "Web of Things (WoT): Use Cases">
wot-usecases
</a>
</cite>
]
and
WoT
Architecture
[
<cite>
<del class="diff-old">wot-architecture
</del>
<a class="bibref" data-link-type="biblio" href= "#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1">
<ins class="diff-chg">wot-architecture11
</ins>
</a>
</cite>
]
documents.
Then
we
will
describe
the
basic
architecture
of
the
WoT
Discovery
process,
which
uses
a
two-phase
Introduction/Exploration
approach.
The
basic
goal
of
this
architecture
is
to
be
able
to
use
existing
discovery
standards
to
bootstrap
access
to
protected
discovery
services,
but
to
distribute
detailed
metadata
only
to
authorized
users,
and
to
also
protect
those
making
queries
from
eavesdroppers
as
much
as
possible.
We
then
describe
details
of
specific
Introduction
and
Exploration
mechanisms.
In
particular,
we
define
in
detail
a
normative
API
for
a
WoT
Thing
Description
Directory
(WoT
TDD)
service
that
provides
a
search
mechanism
for
collections
of
WoT
Thing
Descriptions
that
can
be
dynamically
registered
by
Things
or
entities
acting
on
their
behalf.
The
WoT
Discovery
mechanism
however
also
supports
<del class="diff-old">self-description
by
individual
Things
and
one
issue
we
address
is
how
to
distinguish
between
these
two
approaches.
</del>
<ins class="diff-chg">distribution
of
single
TDs
from
regular
web
services,
with
a
special
case
of
this
being
self-description.
</ins>
Finally,
we
discuss
some
security
and
privacy
considerations,
including
a
set
of
potential
risks
and
mitigations.
</p>
</section>
<section id="conformance">
<div class="header-wrapper">
<h2 id="x2-conformance">
<bdi class="secno">
2.
</bdi>
Conformance
</h2>
<a class="self-link" href="#conformance" aria-label= "Permalink for Section 2.">
</a>
</div>
<p>
As
well
as
sections
marked
as
non-normative,
all
authoring
guidelines,
diagrams,
examples,
and
notes
in
this
specification
are
non-normative.
Everything
else
in
this
specification
is
normative.
</p>
<p>
The
key
words
<em class="rfc2119">
MAY
</em>,
<em class= "rfc2119">
MUST
</em>,
<em class="rfc2119">
OPTIONAL
</em>,
<em class= "rfc2119">
RECOMMENDED
</em>,
<em class="rfc2119">
<ins class="diff-new">SHOULD
</ins></em>,
and
<em class="rfc2119">
SHOULD
<ins class="diff-new">NOT
</ins>
</em>
in
this
document
are
to
be
interpreted
as
described
in
<a href= "https://datatracker.ietf.org/doc/html/bcp14">
BCP
14
</a>
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc2119" title= "Key words for use in RFCs to Indicate Requirement Levels">
RFC2119
</a>
</cite>
]
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc8174" title= "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">
RFC8174
</a>
</cite>
]
when,
and
only
when,
they
appear
in
all
capitals,
as
shown
here.
</p>
</section>
<section id="terminology" class="informative">
<div class="header-wrapper">
<h2 id="x3-terminology">
<bdi class="secno">
3.
</bdi>
Terminology
</h2>
<a class="self-link" href="#terminology" aria-label= "Permalink for Section 3.">
</a>
</div>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
The
fundamental
WoT
terminology
such
as
<dfn class="lint-ignore" id="dfn-thing" tabindex="0" aria-haspopup="dialog" data-dfn-type= "dfn">
Thing
</dfn>,
<dfn class="lint-ignore" data-plurals= "thing descriptions" id="dfn-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
Thing
Description
</dfn>
(
<dfn data-plurals="tds" id="dfn-td" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn">
TD
</dfn>
),
<dfn class="lint-ignore" id="dfn-thing-model" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
<ins class="diff-chg">Thing
Model
</ins></dfn><ins class="diff-chg">
(
</ins><dfn id="dfn-tm" tabindex= "0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-chg">
TM
</ins></dfn><ins class="diff-chg">
),
</ins><dfn class="lint-ignore" id="dfn-property" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
Property
</dfn>,
<dfn class="lint-ignore" id="dfn-action" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">
Action
</dfn>,
<dfn class="lint-ignore" id="dfn-event" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn">
Event
</dfn>,
<dfn class="lint-ignore" data-lt="WoT Anonymous Thing Description|Anonymous TD" data-plurals="anonymous tds" id= "dfn-wot-anonymous-thing-description" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn">
<ins class="diff-new">Anonymous
TD
</ins></dfn>,<dfn class= "lint-ignore" data-lt="WoT Discoverer|Discoverer" id= "dfn-wot-discoverer" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
Discoverer
</ins></dfn>,<dfn class="lint-ignore" data-lt="WoT Discovery|Discovery" id="dfn-wot-discovery" tabindex= "0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
Discovery
</ins></dfn>,<dfn class="lint-ignore" data-lt="WoT Exploration|Exploration" id= "dfn-wot-exploration" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
Exploration
</ins></dfn>,<dfn class="lint-ignore" data-lt="WoT Introduction|Introduction" id="dfn-wot-introduction" tabindex="0" aria-haspopup="dialog" data-dfn-type= "dfn"><ins class="diff-new">
Introduction
</ins></dfn>,<dfn class="lint-ignore" data-lt= "WoT Thing Description Server|Thing Description Server" id= "dfn-wot-thing-description-server" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn"><ins class="diff-new">
Thing
Description
Server
</ins></dfn><ins class="diff-new">
(
</ins><dfn class="lint-ignore" data-lt="WoT TD Server|TD Server" data-plurals="td servers" id="dfn-wot-td-server" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
TD
Server
</ins></dfn><ins class="diff-new">
),
</ins><dfn class="lint-ignore" data-lt= "WoT Thing Description Directory|Thing Description Directory" data-plurals="thing description directories" id= "dfn-wot-thing-description-directory" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn"><ins class="diff-new">
Thing
Description
Directory
</ins></dfn><ins class="diff-new">
(
</ins><dfn class="lint-ignore" data-lt="WoT TDD|TDD" id="dfn-wot-tdd" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
TDD
</ins></dfn><ins class="diff-new">
),
</ins><dfn class="lint-ignore" data-lt= "WoT Partial Thing Description|Partial TD" id= "dfn-wot-partial-thing-description" tabindex="0" aria-haspopup= "dialog" data-dfn-type="dfn"><ins class="diff-new">
Partial
TD
</ins></dfn>,<dfn class= "lint-ignore" data-lt="WoT Enriched Thing Description|Enriched TD" data-plurals="enriched tds" id="dfn-wot-enriched-thing-description" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn"><ins class="diff-new">
Enriched
TD
</ins>
</dfn>
are
defined
in
<a href= "https://www.w3.org/TR/wot-architecture11/#terminology">
Section
3
</a>
of
the
WoT
Architecture
<ins class="diff-new">1.1
</ins>
specification
[
<cite>
<del class="diff-old">WOT-ARCHITECTURE
</del>
<a class= "bibref" data-link-type="biblio" href="#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1">
<ins class="diff-chg">wot-architecture11
</ins>
</a>
</cite>
].
</p>
</section>
<section id="architecture" class="informative">
<div class="header-wrapper">
<h2 id="x4-architecture">
<bdi class="secno">
<ins class="diff-new">4.
</ins></bdi><ins class="diff-new">
Architecture
</ins></h2><a class="self-link" href="#architecture" aria-label= "Permalink for Section 4."></a></div>
<p>
<del class="diff-old">In
addition,
this
specification
introduces
the
following
definitions:
</del>
<del class="diff-old">Anonymous
TD
</del>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em>
<del class="diff-old">A
Thing
Description
without
an
identifier
(
id
attribute).
</del>
</p>
<p>
<del class="diff-old">Discovery
</del>
<a href="#discovery-overview" class="fig-ref" title= "Discovery architecture overview. A set of open Introduction mechanisms provides a set of URLs, which point at Exploration services that only provide metadata (TDs) after suitable authentication. Thing Links and Thing Description Directories provide additional flexibility but retrieving further results from these is at the discretion of the application.">
<ins class="diff-chg">Figure
</ins><bdi class="figno"><ins class="diff-chg">
1
</ins></bdi>
<del class="diff-old">In
</del>
</a>
<ins class="diff-chg">shows
an
overview
of
</ins>
the
WoT
<del class="diff-old">context,
</del>
<ins class="diff-chg">Discovery
process.
Discovery
uses
a
two-phase
architecture
to
resolve
</ins>
the
<del class="diff-old">process
of
finding
</del>
<ins class="diff-chg">competing
requirements
to
be
both
open
</ins>
and
<del class="diff-old">retrieving
Thing
</del>
<ins class="diff-chg">to
restrict
access
to
</ins>
metadata
<ins class="diff-new">to
authorized
entities.
In
the
first
phase,
one
or
more
of
a
set
of
relatively
open
"Introduction"
mechanisms
may
be
used
to
generate
a
set
of
candidate
URLs.
These
URLs
do
not
themselves
contain
metadata,
but
are
used
in
the
second
stage
to
reference
"Exploration"
services
that
can
actually
provide
metadata,
after
authentication,
</ins>
in
the
form
of
<a href= "#dfn-thing-description" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-description-1">
Thing
Descriptions
<del class="diff-old">for
Things
satisfying
some
criteria
of
interest.
Enriched
TD
</del>
</a>.
</p>
<figure id="discovery-overview">
<img src="images/overview.png" srcset="images/overview.svg" class="wot-diagram" alt= "Discovery process overview" />
<figcaption>
<ins class="diff-chg">Figure
</ins><bdi class="figno"><ins class="diff-chg">
1
</ins></bdi><span class= "fig-title"><ins class="diff-chg">
Discovery
architecture
overview.
</ins>
A
<ins class="diff-new">set
of
open
Introduction
mechanisms
provides
a
set
of
URLs,
which
point
at
Exploration
services
that
only
provide
metadata
(TDs)
after
suitable
authentication.
Thing
Links
and
</ins>
Thing
Description
<del class="diff-old">embedded
with
</del>
<ins class="diff-chg">Directories
provide
</ins>
additional
<del class="diff-old">attributes
for
bookkeeping
and
discovery.
Exploration
</del>
<ins class="diff-chg">flexibility
but
retrieving
further
results
from
these
is
at
the
discretion
of
the
application.
</ins></span>
<del class="diff-old">A
discovery
mechanism
</del>
</figcaption>
</figure>
<p>
<ins class="diff-chg">The
intention
is
</ins>
that
<del class="diff-old">provides
access
</del>
<ins class="diff-chg">Introduction
mechanisms
are
relatively
open
"first
contact"
mechanisms
</ins>
to
<del class="diff-old">detailed
metadata
in
</del>
<ins class="diff-chg">provide
a
starting
point
for
</ins>
the
<del class="diff-old">form
</del>
<ins class="diff-chg">rest
</ins>
of
<del class="diff-old">one
or
more
Thing
Descriptions.
Exploration
mechanisms
are
</del>
<ins class="diff-chg">the
Discovery
process.
In
this
document
we
specify
details
on
several
Introduction
mechanisms,
suitable
for
different
use
cases,
including
both
local
and
non-local
scenarios,
but
Introductions
can
</ins>
in
<del class="diff-old">general
protected
</del>
<ins class="diff-chg">fact
be
provided
</ins>
by
<del class="diff-old">security
</del>
<ins class="diff-chg">any
</ins>
mechanism
<ins class="diff-new">that
can
return
a
URL.
Introductions,
however,
do
not
include
any
security
or
privacy
controls
</ins>
and
<del class="diff-old">are
accessible
</del>
<ins class="diff-chg">so
should
not
provide
metadata
directly.
Instead,
the
URLs
provided
by
Introduction
mechanisms
reference
"Exploration"
services.
Exploration
services
actually
do
provide
metadata,
but
</ins>
only
<del class="diff-old">to
authorized
users.
</del>
<ins class="diff-chg">after
suitable
authentication
and
access
controls
have
been
applied.
</ins></p><p><ins class="diff-chg">
The
Discovery
process
can
produce
a
</ins><em><ins class="diff-chg">
set
</ins></em><ins class="diff-chg">
of
URLs
as
output
from
its
</ins>
Introduction
<del class="diff-old">A
"first
contact"
discovery
mechanism,
whose
result
</del>
<ins class="diff-chg">phase,
even
if
only
one
Introduction
mechanism
</ins>
is
<ins class="diff-new">used
(some
Introduction
mechanisms
can
themselves
return
multiple
URLs).
The
final
output
after
the
Exploration
phase
can
also
be
</ins>
a
<em>
<ins class="diff-new">set
</ins></em><ins class="diff-new">
of
Thing
Descriptions.
</ins></p><p><ins class="diff-new">
Each
</ins>
URL
<ins class="diff-new">provided
by
the
Introduction
phase
always
points
at
an
Exploration
service
endpoint
</ins>
that
<ins class="diff-new">will
return
a
single
Thing
Description.
In
the
simplest
case
this
URL
</ins>
references
an
<del class="diff-old">exploration
mechanism.
</del>
<ins class="diff-chg">ordinary
resource
provided
by
a
web
server
which
provides
the
Thing
Description
of
a
Thing
describing
an
IoT
endpoint
device.
As
a
special
case
of
this,
for
self-describing
Things
an
</ins>
Introduction
<del class="diff-old">mechanisms
themselves
should
not
</del>
<ins class="diff-chg">URL
might
point
</ins>
directly
<del class="diff-old">provide
metadata,
</del>
<ins class="diff-chg">at
an
endpoint
provided
by
a
Thing
serving
its
own
Thing
Description.
</ins></p><p><ins class="diff-chg">
In
general
Thing
Descriptions
might
be
provided
in
various
ways
</ins>
and
in
<del class="diff-old">general
are
</del>
<ins class="diff-chg">particular
may
not
be
self-describing.
For
example,
</ins></p><ul><li><ins class="diff-chg">
brownfield
devices
not
</ins>
designed
<ins class="diff-new">with
the
WoT
specification
in
mind
will
not
be
capable
of
serving
their
own
Thing
Descriptions;
</ins></li><li><ins class="diff-new">
battery-powered
devices
may
not
be
online
most
of
the
time;
and
</ins></li><li><ins class="diff-new">
some
devices
may
not
be
powerful
enough
</ins>
to
<ins class="diff-new">manage
and
serve
TDs
directly.
</ins></li></ul><p><ins class="diff-new">
The
Thing
Description
for
such
Things
should
</ins>
be
<del class="diff-old">open.
TDD
Short
</del>
<ins class="diff-chg">provided
by
separate
services.
</ins></p><p><ins class="diff-chg">
This
document
specifies
two
special
cases
that
allow
</ins>
for
<ins class="diff-new">more
flexibility:
</ins></p><ul><li><ins class="diff-new">
A
</ins>
Thing
Description
<del class="diff-old">Directory.
</del>
<ins class="diff-chg">referenced
by
an
Introduction
URL
may
describe
a
</ins><a href="#exploration-td-type-thingdirectory">
Thing
Description
Directory
</a>
<ins class="diff-chg">service.
</ins>
A
<del class="diff-old">directory
</del>
<ins class="diff-chg">Thing
Description
Directory
</ins>
service
<del class="diff-old">with
</del>
<ins class="diff-chg">(which
is
still
</ins>
a
<del class="diff-old">prescribed
API
that
allows
the
registration,
management,
and
search
of
</del>
<ins class="diff-chg">Thing)
maintains
</ins>
a
<ins class="diff-new">(possibly
dynamic)
</ins>
database
of
Thing
Descriptions.
<del class="diff-old">Note
</del>
<ins class="diff-chg">Thing
Description
Directories
</ins>
that
<del class="diff-old">the
acronym
should
</del>
<ins class="diff-chg">maintain
large
numbers
of
Thing
Descriptions
may
also
support
queries
that
can
</ins>
be
<del class="diff-old">TDD,
not
TD,
</del>
<ins class="diff-chg">used
</ins>
to
<del class="diff-old">avoid
confusion
with
</del>
<ins class="diff-chg">selectively
retrieve
</ins>
Thing
<del class="diff-old">Descriptions
(TDs).
Partial
TD
</del>
<ins class="diff-chg">Descriptions.
</ins></li><li><ins class="diff-chg">
The
second
special
case
is
a
</ins><a href= "#exploration-td-type-thinglink"><ins class="diff-chg">
Thing
Link
</ins></a>.
A
<del class="diff-old">data
model
partially
conformant
</del>
<ins class="diff-chg">Thing
Link
is
also
a
Thing
Description,
but
rather
than
describing
a
Thing
directly,
it
holds
a
link
</ins>
to
<ins class="diff-new">a
Thing
Description
hosted
elsewhere.
A
Thing
Description
Directory
can
also
store
Thing
Links
which
can
redirect
to
other
Thing
Description
Directories,
allowing
for
a
linked
directory
structure.
</ins></li></ul><p><ins class="diff-new">
It
is
</ins><em><ins class="diff-new">
not
</ins></em><ins class="diff-new">
mandatory
for
</ins>
the
<ins class="diff-new">Discovery
process
to
retrieve
the
contents
of
</ins>
Thing
Description
<del class="diff-old">schema
by
including
only
</del>
<ins class="diff-chg">Directories
and
return
them
as
part
of
the
results,
because
in
general
this
might
result
in
</ins>
a
<del class="diff-old">subset
</del>
<ins class="diff-chg">huge
set
</ins>
of
<ins class="diff-new">results.
Instead
</ins>
the
<del class="diff-old">attributes.
</del>
<ins class="diff-chg">application
should
scan
the
results
for
Thing
Description
Directory
TDs
and
decide
whether
to
retrieve
TDs
from
them,
possibly
selectively.
Likewise,
it
is
not
required
to
follow
Thing
Links
automatically;
instead
the
application
may
choose
to
follow
them
selectively.
</ins></p>
</section>
<section id="discoverer-process" class="normative">
<div class="header-wrapper">
<h2 id="x5-discoverer-process">
<bdi class="secno">
<del class="diff-old">4.
</del>
<ins class="diff-chg">5.
</ins>
</bdi>
<del class="diff-old">Architecture
</del>
<ins class="diff-chg">Discoverer
Process
</ins></h2><a class="self-link" href="#discoverer-process" aria-label= "Permalink for Section 5.">
</a>
</div>
<p>
<del class="diff-old">This
</del>
<ins class="diff-chg">In
this
</ins>
section
<del class="diff-old">is
non-normative.
Figure
1
</del>
<ins class="diff-chg">we
will
describe
the
WoT
Discovery
process
from
the
point
of
view
of
a
client,
and
what
it
means
to
say
that
a
client
supports
WoT
Discovery.
We
will
use
the
term
</ins><a href= "#dfn-wot-discoverer" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-discoverer-1"><ins class="diff-chg">
Discoverer
</ins>
</a>
<del class="diff-old">shows
</del>
<ins class="diff-chg">for
</ins>
an
<del class="diff-old">overview
</del>
<ins class="diff-chg">entity
that
is
a
client
</ins>
of
<del class="diff-old">discovery
</del>
<ins class="diff-chg">the
WoT
Discovery
</ins>
process.
<ins class="diff-chg">A
Discoverer
may
or
may
not
be
a
full
Consumer.
A
Discoverer
does
however
need
to
read
and
extract
information
from
special
TDs
for
Directories
and
Thing
Links
and
use
specific
affordances
and
links
provided
in
them.
Conversely,
a
Consumer
may
not
support
Discovery,
although
it
is
recommended
[
</ins><cite>
<del class="diff-old">Figure
1
</del>
<a class="bibref" data-link-type="biblio" href= "#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1">
<ins class="diff-chg">wot-architecture11
</ins></a></cite><ins class="diff-chg">
].
</ins></p><p><ins class="diff-chg">
The
WoT
</ins>
Discovery
process
<del class="diff-old">overview
</del>
<ins class="diff-chg">is
designed
so
that
nearly
any
client
that
can
fetch
a
single
TD
given
a
single
URI
can
be
said
to
support
WoT
Discovery.
Of
course,
Discoverers
may
support
more
powerful
Discovery
mechanisms,
but
some
of
these
have
additional
requirements.
Some
Introduction
mechanisms
can
return
multiple
URLs,
each
of
which
can
in
turn
be
used
to
fetch
at
least
one
TD.
So
even
without
a
TDD,
it
is
possible
to
discover
multiple
TDs.
</ins></p><p><ins class="diff-chg">
The
following
assertions
describe
the
specific
responsibilities
of
a
Discoverer:
</ins></p><ul><li><span class="rfc2119-assertion" id= "discoverer-must-support-intros"><ins class="diff-chg">
A
Discoverer
</ins><em class= "rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
support
at
least
one
Introduction
mechanism.
</ins>
</span>
<ins class="diff-new">The
simplest
Introduction
mechanism,
Direct,
simply
provides
a
single
URL
of
a
target
TD.
This
assertion
results
in
different
minimal
requirements
depending
on
which
Introduction
mechanism
is
selected
out
of
the
several
available.
For
example,
when
Direct
is
used
as
the
sole
Introduction
mechanism,
at
a
minimum
a
Discoverer
must
be
able
to
accept
a
single
URL
pointing
at
a
TD.
Note,
however,
that
this
TD
could
still
be
describing
a
Directory.
Another
option
would
be
for
a
Discoverer
to
implement,
as
its
sole
Introduction
mechanism,
an
"automatic"
Introduction
mechanism
such
as
DNS-SD,
possibly
in
combination
with
mDNS.
In
this
case
the
application
code
running
in
the
Discoverer
would
not
have
to
supply
any
additional
information
to
invoke
Discovery.
</ins></li><li>
<span class="rfc2119-assertion" id= "discoverer-must-support-fetching">
<ins class="diff-chg">A
Discoverer
</ins><em class= "rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
support
fetching
a
TD
from
at
least
one
URL
provided
as
part
of
the
Introduction
process.
</ins></span><ins class="diff-chg">
In
other
words,
not
only
must
a
Discoverer
accept
URLs
pointing
at
TDs,
it
must
be
able
to
fetch
that
TD,
for
example
by
using
a
GET
for
an
HTTP
URL.
It
is
permissible
to
split
the
implementation
of
a
Discoverer
into
two
components,
one
that
fetches/reads
a
TD
and
sets
up
a
configuration
during
installation
to
be
used
by
a
run-time
component
that
cannot
itself
read
TDs.
In
this
case,
however,
the
latter
component
is
not
by
itself
a
Discoverer.
</ins></li><li>
<del class="diff-old">Editor's
note
</del>
<span class="rfc2119-assertion" id= "discoverer-may-multiple-intro">
<ins class="diff-chg">A
Discoverer
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
support
multiple
invocations
of
the
same
Introduction
mechanism.
</ins>
</span>
<ins class="diff-new">If
multiple
invocations
of
a
single
Introduction
mechanism
is
supported,
or
if
multiple
Introduction
mechanisms
are
used,
then
the
Discoverer
needs
to
manage
a
set
of
Introduction
results.
Some
Introduction
mechanisms
themselves
return
a
set
of
results,
e.g.
CoRE-RD,
DID,
or
DNS-SD.
Some
mechanisms,
such
as
scanning
Bluetooth
beacons,
may
intrinsically
result
in
separate
multiple
"invocations".
However,
this
Discoverer
requirement
is
optional
to
support
an
important
special
case:
it
is
permissible
to
have
a
simple
Discoverer
that
only
supports
a
single
invocation
of
a
Direct
Introduction,
directly
specifying
a
single
TD
via
a
URL.
</ins></li><li>
<del class="diff-old">:
Discovery
Architecture
Overview
</del>
<span class="rfc2119-assertion" id="discoverer-merge-intros">
<ins class="diff-chg">A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
able
to
merge
URLs
resulting
from
multiple
Introduction
mechanisms,
multiple
results
from
a
single
Introduction
mechanism,
and
multiple
Introduction
invocations
into
a
single
set.
</ins>
</span>
<ins class="diff-new">Note
that
even
if
only
one
Introduction
mechanism
is
supported
multiple
results
might
be
produced.
This
assertion
states
that
the
overall
output
of
the
Introduction
phase
is
a
single
set
of
URLs.
The
word
"set"
is
used
here
in
the
mathematical
sense:
the
results
are
unordered
and
unique.
Uniqueness
means
that
if
multiple
Introductions
have
the
same
result,
they
are
merged
into
a
single
result.
If
the
Discoverer
only
supports
one
Introduction
mechanism
and
that
mechanism
can
only
produce
one
URL,
then
the
"merge"
is
trivial.
</ins></li><li>
<del class="diff-old">To
do:
</del>
<span class="rfc2119-assertion" id="discoverer-td-identify">
<ins class="diff-chg">A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
able
to
identify
whether
a
TD
fetched
from
</ins>
an
<del class="diff-old">overview
</del>
<ins class="diff-chg">Introduction
URL
has
</ins><a href= "#exploration-td-type-thingdirectory"><ins class="diff-chg">
Thing
Directory
</ins></a><ins class="diff-chg">
or
</ins><a href="#exploration-td-type-thingdirectory"><ins class="diff-chg">
Thing
Link
</ins></a><ins class="diff-chg">
type.
</ins></span><ins class="diff-chg">
This
implies
that
the
Discoverer
needs
to
be
able
to
check
the
</ins><code><ins class="diff-chg">
@type
</ins></code><ins class="diff-chg">
field
and
make
this
distinction.
A
Discoverer
can
decide
whether
or
not
to
follow
links
or
fetch
TDD
contents.
There
are
some
use
cases
where
a
Consumer
may
not
expand
certain
URLs,
for
example
links
pointing
at
external
resources,
or
when
a
TDD
contains
many
TDs
and
fetching
them
all
would
exceed
the
Consumer's
memory
processing
capabilities.
</ins></li><li><span class="rfc2119-assertion" id="discoverer-fetch-tdd"><ins class="diff-chg">
A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
fetch
additional
TDs
from
any
Exploration
mechanism
described
in
its
initial
set
</ins>
of
<ins class="diff-new">TDs
(including,
in
particular,
Thing
Description
Directories)
and
add
them
into
</ins>
the
<del class="diff-old">two-phase
approach
</del>
<ins class="diff-chg">set
of
TD
results.
</ins></span><ins class="diff-chg">
This
only
adds
the
results
of
fetching
TDs
from
an
Exploration
mechanism
to
the
set
of
results.
These
new
results
do
not
delete
the
original
TD
describing
the
Exploration
mechanism.
A
Discoverer
implementation
can
decide
whether
or
not
to
fetch
TDD
contents.
Implementers
should
consider
the
fact
that
TDDs
may
be
large
</ins>
and
<ins class="diff-new">fetching
the
contents
of
an
entire
TDD
might
be
prohibitively
expensive.
</ins></li><li><span class="rfc2119-assertion" id="discoverer-fetch-links"><ins class="diff-new">
A
Discoverer
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
fetch
source
TDs
from
the
targets
of
the
links
in
a
</ins><a href= "#exploration-td-type-thingdirectory"><ins class="diff-new">
Thing
Link
</ins></a><ins class="diff-new">
described
in
</ins>
its
<del class="diff-old">purpose,
</del>
<ins class="diff-chg">initial
set
of
TDs
and
add
them
into
the
set
of
TD
results.
</ins></span><ins class="diff-chg">
This
only
adds
the
results
of
fetching
TDs
from
a
Thing
Link
to
the
set
of
results.
These
new
results
do
not
delete
the
original
TD
describing
the
Thing
Link.
A
Discoverer
implementation
can
decide
whether
or
not
to
fetch
the
targets
of
Thing
Links.
</ins></li><li><span class="rfc2119-assertion" id= "discoverer-fetch-iteration"><ins class="diff-chg">
A
Discoverer
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
fetch
additional
TDs
iteratively
from
any
</ins><a href="#exploration-td-type-thingdirectory"><ins class="diff-chg">
Thing
Link
</ins></a><ins class="diff-chg">
or
Exploration
mechanism
described
in
its
set
of
TDs
and
add
them
into
the
set
of
TD
results.
</ins></span><ins class="diff-chg">
This
only
adds
the
results
of
fetching
TDs
from
an
Exploration
mechanism
to
the
set
of
results.
These
new
results
do
not
delete
the
original
TD
describing
the
Exploration
mechanism.
</ins></li><li><span class="rfc2119-assertion" id="discoverer-termination"><ins class="diff-chg">
A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
terminate
fetching
additional
TDs
at
any
point
or
for
any
reason.
</ins></span></li><li><span class="rfc2119-assertion" id="discoverer-any-order"><ins class="diff-chg">
A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
fetch
additional
TDs
by
following
links
or
fetching
additional
TDs
from
Exploration
mechanisms
(e.g.
TDDs)
in
any
order.
</ins></span><ins class="diff-chg">
The
Discoverer
can
fetch
additional
TDs
in
any
order
from
any
Exploration
mechanism
and
is
not
required
to
use
all
of
them.
</ins></li><li><span class="rfc2119-assertion" id="discoverer-track"><ins class="diff-chg">
A
Discoverer
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
track
</ins>
which
<ins class="diff-new">TDs
describing
links
or
Exploration
mechanisms
have
already
been
fetched
and
avoid
fetching
duplicate
results.
</ins></span><ins class="diff-new">
This
</ins>
is
to
<del class="diff-old">support
controlled
</del>
<ins class="diff-chg">avoid
infinite
loops.
Note
that
Thing
Description
Directories
can
easily
refer
to
each
other,
for
example,
so
fetching
the
TDs
from
a
TDD,
then
fetching
all
those
TDs
will
give
another
copy
of
the
original
TDD's
TD.
This
second
copy
should
NOT
trigger
further
fetches.
Note
that
tracking
cannot
depend
only
on
the
value
of
"id"
fields
in
TDs
since
this
field
is
optional.
</ins></li></ul><p><ins class="diff-chg">
The
above
process
supports
a
way
to
let
Directories
reference
other
Directories
without
duplicating
their
TDs:
a
Directory
wanting
to
reference
other
Directories
should
include
a
</ins><a href= "#exploration-td-type-thingdirectory"><ins class="diff-chg">
Thing
Link
</ins></a><ins class="diff-chg">
with
a
"describedby"
relation
to
the
TD
of
the
other
Directory
service.
Then
the
above
process
would
expand
the
Thing
Link
to
obtain
the
actual
TD
of
the
Directory,
</ins>
and
<del class="diff-old">authenticated
</del>
<ins class="diff-chg">then
(optionally)
use
the
appropriate
Directory
affordance
to
</ins>
access
<ins class="diff-new">the
contents
of
the
linked
Directory.
Note
that
such
a
Thing
Link
points
at
the
TD
of
the
Directory,
not
at
the
Directory
itself.
These
may
or
may
not
be
hosted
in
the
same
location.
</ins></p><p><ins class="diff-new">
Recursively
fetching
the
contents
of
such
linked
directories,
especially
without
a
specific
query
or
filter,
could
easily
result
in
downloading
a
large
amount
of
data.
Such
recursive
expansion
should
be
limited
</ins>
to
<del class="diff-old">metadata
by
authorized
users
only.
</del>
<ins class="diff-chg">use
cases
that
require
it,
such
as
inventory,
auditing,
or
indexing.
</ins></p><p><ins class="diff-chg">
URLs
for
Directory
services
can
also
be
used
with
the
federation
capabilities
of
SPARQL
queries,
noted
below,
which
in
most
cases
will
be
a
more
efficient
way
to
collect
specific
information
from
a
set
of
distributed
directory
services.
However,
SPARQL
requires
the
URL
of
a
SPARQL
endpoint
for
such
federation,
which
can
be
found
in
the
TDs
of
Directories
supporting
SPARQL
queries.
This
is
not
the
same
as
the
URL
pointing
at
the
TD
of
a
Directory.
</ins>
</p>
</section>
<section id="introduction-mech" class="normative">
<div class="header-wrapper">
<h2 id="x6-introduction-mechanisms">
<bdi class="secno">
<del class="diff-old">5.
</del>
<ins class="diff-chg">6.
</ins>
</bdi>
Introduction
Mechanisms
</h2>
<a class="self-link" href="#introduction-mech" aria-label= "Permalink for Section 6.">
</a>
</div>
<p>
This
chapter
describes
<del class="diff-old">a
mechanism
</del>
<ins class="diff-chg">mechanisms
</ins>
for
<del class="diff-old">discovering
a
Thing
</del>
<ins class="diff-chg">initial
contact
with
Things
</ins>
or
<del class="diff-old">a
</del>
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-1">
Thing
Description
<del class="diff-old">Directory
</del>
<ins class="diff-chg">Directories
</ins>
</a>.
<del class="diff-old">The
</del>
<ins class="diff-chg">Any
of
the
</ins>
following
<del class="diff-old">mechanism
is
</del>
<ins class="diff-chg">mechanisms
may
be
</ins>
provided
by
the
Thing
or
the
<a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-2">
Thing
Description
Directory
</a>
<del class="diff-old">so
that
Consumers
can
discover
the
Thing
Description
or
</del>
<ins class="diff-chg">to
Consumers.
The
result
of
an
introduction
mechanism
is
always
</ins>
a
URL
<del class="diff-old">that
point
</del>
<ins class="diff-chg">(address)
of
an
exploration
service
which
can
be
used
to
obtain
detailed
metadata
(TDs)
after
suitable
authentication.
It
is
also
possible
for
multiple
introduction
mechanisms
</ins>
to
<ins class="diff-new">be
used
and
</ins>
the
<del class="diff-old">Thing
Description.
</del>
<ins class="diff-chg">results
merged.
No
particular
introduction
mechanism
is
mandatory,
as
long
as
the
URL
of
at
least
one
exploration
service
is
somehow
obtained.
</ins>
</p>
<section id="introduction-direct" class="normative">
<div class="header-wrapper">
<h3 id="x6-1-direct">
<bdi class="secno">
<del class="diff-old">5.1
</del>
<ins class="diff-chg">6.1
</ins>
</bdi>
Direct
</h3>
<a class="self-link" href="#introduction-direct" aria-label= "Permalink for Section 6.1">
</a>
</div>
<p>
<del class="diff-old">Any
</del>
<span class="rfc2119-assertion" id="introduction-direct-url">
<ins class="diff-chg">To
obtain
an
URL
of
an
exploration
service,
any
</ins>
mechanism
that
results
in
a
single
<del class="diff-old">URL.
</del>
<ins class="diff-chg">URL
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
be
used.
</ins></span>
This
includes
Bluetooth
beacons,
QR
codes,
and
written
URLs
to
be
typed
by
a
user.
<span class="rfc2119-assertion" id= "introduction-direct-thing-description">
A
request
on
all
such
URLs
<em class="rfc2119">
MUST
</em>
result
in
a
TD
as
prescribed
in
<del class="diff-old">§&nbsp;
</del>
<a href="#exploration-mech" data-matched-text= "[[[#exploration-mech]]]" class="sec-ref">
<bdi class= "secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.
</ins>
</bdi>
<del class="diff-old">Self-description
</del>
<ins class="diff-chg">Exploration
Mechanisms
</ins>
</a>.
</span>
For
self-describing
Things,
this
can
be
the
TD
of
the
Thing
itself.
<span class="rfc2119-assertion" id= "introduction-direct-directory-description">
If
the
URL
references
a
<a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-3">
Thing
Description
Directory
</a>,
this
<em class="rfc2119">
MUST
</em>
be
the
Directory
Description
of
the
<a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-4">
Thing
Description
Directory
</a>.
</span>
</p>
</section>
<section id="introduction-well-known" class="normative">
<div class="header-wrapper">
<h3 id="x6-2-well-known-uris">
<bdi class="secno">
<del class="diff-old">5.2
</del>
<ins class="diff-chg">6.2
</ins>
</bdi>
Well-Known
URIs
</h3>
<a class="self-link" href="#introduction-well-known" aria-label= "Permalink for Section 6.2">
</a>
</div>
<p>
<span class="rfc2119-assertion" id= "introduction-well-known-uri">
A
Thing
or
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-5">
Thing
Description
Directory
</a>
<del class="diff-old">may
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
use
the
Well-Known
Uniform
Resource
Identifier
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-rfc8615" title= "Well-Known Uniform Resource Identifiers (URIs)">
RFC8615
</a>
</cite>
]
to
advertise
its
presence.
<del class="diff-old">The
</del>
</span>
<span class="rfc2119-assertion" id="introduction-well-known-path">
<ins class="diff-chg">If
a
</ins>
Thing
or
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-6">
Thing
Description
Directory
</a>
<del class="diff-old">registers
</del>
<ins class="diff-chg">use
the
Well-Known
Uniform
Resource
Identifier
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc8615" title= "Well-Known Uniform Resource Identifiers (URIs)"><ins class="diff-chg">
RFC8615
</ins></a></cite><ins class="diff-chg">
]
to
advertise
its
presence,
it
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
register
</ins>
its
own
Thing
<del class="diff-old">or
Directory
</del>
Description
into
the
following
path:
<code>
<del class="diff-old">/.well-known/wot-thing-description
</del>
<ins class="diff-chg">/.well-known/wot
</ins>
</code>.
</span>
</p>
<p>
<span class="rfc2119-assertion" id= "introduction-well-known-thing-description">
When
a
request
is
made
at
the
above
Well-Known
URI,
the
server
<em class= "rfc2119">
MUST
</em>
return
a
Thing
Description
as
prescribed
in
<del class="diff-old">§&nbsp;
6.1
</del>
<a href="#exploration-mech" data-matched-text= "[[[#exploration-mech]]]" class="sec-ref">
<bdi class= "secno">
<ins class="diff-chg">7.
</ins>
</bdi>
<del class="diff-old">Self-description
</del>
<ins class="diff-chg">Exploration
Mechanisms
</ins>
</a>.
</span>
</p>
<div class="note" id="issue-container-generatedID">
<div role="heading" class="ednote-title marker" id="h-ednote" aria-level="4">
<span>
Editor's
note
</span>
<span class= "issue-label">:
Registration
of
Well-known
URI
</span>
</div>
<p class="">
The
service
name
in
Well-Known
URI
(
<code>
<del class="diff-old">wot-thing-description
</del>
<ins class="diff-chg">wot
</ins>
</code>
)
is
tentative.
"Well-Known
URIs"
registry
and
contents
of
registration
request
is
described
in
Section
3.1
of
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc8615" title= "Well-Known Uniform Resource Identifiers (URIs)">
RFC8615
</a>
</cite>
].
</p>
</div>
</section>
<section id="introduction-dns-sd-sec" class="normative">
<div class="header-wrapper">
<h3 id="x6-3-dns-based-service-discovery">
<bdi class= "secno">
<del class="diff-old">5.3
</del>
<ins class="diff-chg">6.3
</ins>
</bdi>
DNS-Based
Service
Discovery
</h3>
<a class="self-link" href="#introduction-dns-sd-sec" aria-label= "Permalink for Section 6.3">
</a>
</div>
<p>
<span class="rfc2119-assertion" id="introduction-dns-sd">
A
Thing
or
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-7">
Thing
Description
Directory
</a>
<del class="diff-old">may
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
use
<del class="diff-old">the
</del>
DNS-Based
Service
Discovery
(DNS-SD)[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-rfc6763" title= "DNS-Based Service Discovery">
RFC6763
</a>
</cite>
].
</span>
This
can
be
also
be
used
<del class="diff-old">to
discover
them
</del>
on
the
same
<del class="diff-old">link
by
combining
</del>
<ins class="diff-chg">local
network
in
combination
with
</ins>
Multicast
DNS
(mDNS)[
<cite>
<a class="bibref" data-link-type= "biblio" href="#bib-rfc6762" title= "Multicast DNS">
RFC6762
</a>
</cite>
].
</p>
<p>
In
DNS-SD,
<ins class="diff-new">the
</ins>
format
of
the
Service
Instance
Name
is
<code>
Instance.Service.Domain
</code>.
The
Service
part
is
a
pair
of
labels
following
the
conventions
of
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-rfc2782" title= "A DNS RR for specifying the location of services (DNS SRV)">
RFC2782
</a>
</cite>
].
The
first
label
has
an
underscore
followed
by
the
Service
Name,
and
the
second
label
describes
the
protocol.
</p>
<p>
<span class="rfc2119-assertion" id= "introduction-dns-sd-service-name">
The
Service
Name
to
indicate
the
Thing
or
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-8">
Thing
Description
Directory
</a>
<em class="rfc2119">
MUST
</em>
be
<code>
_wot
</code>.
</span>
<span class="rfc2119-assertion" id= "introduction-dns-sd-service-name-directory">
<del class="diff-old">And
the
</del>
<ins class="diff-chg">The
</ins>
Service
Name
to
indicate
the
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-9">
Thing
Description
Directory
</a>
<em class="rfc2119">
MUST
</em>
be
<code>
_directory._sub._wot
</code>.
</span>
</p>
<div class="note" id="issue-container-generatedID-0">
<div role="heading" class="ednote-title marker" id="h-ednote-0" aria-level="4">
<span>
Editor's
note
</span>
<span class= "issue-label">:
Service
Names
in
existing
implementations
</span>
</div>
<p class="">
The
Service
Names
<code>
_wot
</code>
and
<code>
_directory._sub._wot
</code>
are
tentative.
The
following
Service
Names
are
used
in
the
existing
implementations:
<code>
_wot
</code>,
<code>
_device._sub._wot
</code>,
<code>
_directory._sub._wot
</code>,
<code>
_webthing
</code>,
<code>
_wot-servient
</code>.
To
use
a
Service
Name,
registration
to
"Underscored
and
Globally
Scoped
DNS
Node
Names"
Registry
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc8552" title= "Scoped Interpretation of DNS Resource Records through &quot;Underscored&quot; Naming of Attribute Leaves">
RFC8552
</a>
</cite>
]
is
required.
</p>
</div>
<div class="rfc2119-assertion" id="introduction-dns-sd-txt-record">
<p>
In
addition,
the
following
information
<em class= "rfc2119">
MUST
</em>
be
included
in
the
<code>
TXT
</code>
record
that
is
pointed
to
by
the
Service
Instance
Name:
</p>
<dl>
<dt>
<code>
td
</code>
</dt>
<dd>
Absolute
pathname
of
the
Thing
Description
of
the
Thing
or
Directory
Description
of
the
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-10">
Thing
Description
Directory
</a>.
</dd>
<dt>
<code>
type
</code>
</dt>
<dd>
Type
of
the
Thing
Description,
i.e.
<code>
Thing
</code>
or
<code>
Directory
</code>.
If
omitted,
the
type
is
assumed
to
be
<code>
Thing
</code>.
</dd>
</dl>
</div>
<div class="note" id="issue-container-generatedID-1">
<div role="heading" class="ednote-title marker" id="h-ednote-1" aria-level="4">
<span>
Editor's
note
</span>
<span class= "issue-label">:
Usage
of
a
TXT
record
in
existing
implementations
</span>
</div>
<p class="">
The
following
key/value
pairs
are
used
in
the
existing
implementations:
<br />
<code>
retrieve
</code>:
Absolute
path
name
of
the
API
to
get
an
array
of
Thing
Description
IDs
from
the
directory
service.
<br />
<code>
register
</code>:
Absolute
path
name
of
the
API
to
register
a
Directory
Description
with
the
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-11">
Thing
Description
Directory
</a>.
<br />
<code>
path
</code>:
The
URI
of
the
thing
description
on
the
Web
Thing's
web
server
<br />
<code>
td
</code>:
Prefix
of
directory
service
API
<br />
<code>
tls
</code>:
Value
of
1
if
the
Web
Thing
supports
connections
via
HTTPS.
<br />
</p>
</div>
<p>
<a href="#sequence-dnssd-thing" class="fig-ref" title= "An example sequence of discovery of Thing using DNS-SD and mDNS">
Figure
<bdi class="figno">
2
</bdi>
</a>
and
<a href= "#sequence-dnssd-directory" class="fig-ref" title= "An example sequence of discovery of Thing Description Directory using DNS-SD and mDNS">
Figure
<bdi class="figno">
3
</bdi>
</a>
shows
example
sequences
of
discovery
of
Thing
and
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-12">
Thing
Description
Directory
</a>
using
DNS-SD
and
mDNS.
</p>
<figure id="sequence-dnssd-thing">
<img src= "images/sequence-dnssd-thing.png" srcset= "images/sequence-dnssd-thing.svg" class="wot-diagram" alt= "An example sequence of discovery of Thing using DNS-SD and mDNS" />
<figcaption>
Figure
<bdi class="figno">
2
</bdi>
<span class= "fig-title">
An
example
sequence
of
discovery
of
Thing
using
DNS-SD
and
mDNS
</span>
</figcaption>
</figure>
<figure id="sequence-dnssd-directory">
<img src= "images/sequence-dnssd-directory.png" srcset= "images/sequence-dnssd-directory.svg" class="wot-diagram" alt= "An example sequence of discovery of directory service using DNS-SD and mDNS" />
<figcaption>
Figure
<bdi class="figno">
3
</bdi>
<span class= "fig-title">
An
example
sequence
of
discovery
of
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-13">
Thing
Description
Directory
</a>
using
DNS-SD
and
mDNS
</span>
</figcaption>
</figure>
</section>
<section id="introduction-core-rd-sec" class="normative">
<div class="header-wrapper">
<h3 id="x6-4-core-link-format-and-core-resource-directory">
<bdi class="secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</bdi>
CoRE
Link
Format
and
CoRE
Resource
Directory
</h3>
<a class="self-link" href="#introduction-core-rd-sec" aria-label= "Permalink for Section 6.4">
</a>
</div>
<p>
<span class="rfc2119-assertion" id="introduction-core-rd">
A
Thing
or
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-14">
Thing
Description
Directory
</a>
<del class="diff-old">may
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
advertise
its
presence
using
the
Constrained
RESTful
Environment
(CoRE)
Link
Format
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc6690" title= "Constrained RESTful Environments (CoRE) Link Format">
RFC6690
</a>
</cite>
].
<del class="diff-old">And,
a
</del>
</span>
<span class="rfc2119-assertion" id= "introduction-core-rd-directory">
<ins class="diff-chg">A
</ins>
Thing
or
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-15">
Thing
Description
Directory
</a>
<del class="diff-old">may
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
use
the
CoRE
Resource
Directory
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-core-rd" title="CoRE Resource Directory">
CoRE-RD
</a>
</cite>
]
to
register
a
link
to
the
Thing
or
Directory
Description.
</span>
</p>
<p>
<span class="rfc2119-assertion" id= "introduction-core-rd-resource-type-thing">
The
resource
type
(
<code>
rt
</code>
)
of
the
Link
that
targets
the
Thing
Description
of
the
Thing
<em class="rfc2119">
MUST
</em>
be
<code>
wot.thing
</code>.
</span>
<span class="rfc2119-assertion" id= "introduction-core-rd-resource-type-directory">
The
resource
type
of
the
Link
that
targets
the
Directory
Description
of
the
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-16">
Thing
Description
Directory
</a>
<em class="rfc2119">
MUST
</em>
be
<code>
wot.directory
</code>.
</span>
</p>
<div class="note" id="issue-container-generatedID-2">
<div role="heading" class="ednote-title marker" id="h-ednote-2" aria-level="4">
<span>
Editor's
note
</span>
</div>
<p class="">
The
resource
types
<code>
wot.thing
</code>
and
<code>
wot.directory
</code>
are
tentative.
See
also
<a href= "#iana-considerations" class="sec-ref">
<del class="diff-old">§&nbsp;
8.
</del>
<bdi class="secno">
<ins class="diff-chg">11.
</ins>
</bdi>
IANA
Considerations
</a>.
</p>
</div>
</section>
<section id="introduction-did-sec" class="normative">
<div class="header-wrapper">
<h3 id="x6-5-did-documents">
<bdi class="secno">
<del class="diff-old">5.5
</del>
<ins class="diff-chg">6.5
</ins>
</bdi>
DID
Documents
</h3>
<a class="self-link" href="#introduction-did-sec" aria-label= "Permalink for Section 6.5">
</a>
</div>
<p>
<span class="rfc2119-assertion" id="introduction-did">
A
Thing
or
<a href="#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-17">
Thing
Description
Directory
</a>
<del class="diff-old">may
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
advertise
its
presence
using
the
Decentralized
Identifier
(DID)
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-did-core" title= "Decentralized Identifiers (DIDs) v1.0">
DID-CORE
</a>
</cite>
].
</span>
</p>
<p>
<span class="rfc2119-assertion" id= "introduction-did-service-endpoint">
The
DID
Document
obtained
by
resolving
the
DID
of
a
Thing
or
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-18">
Thing
Description
Directory
</a>
<em class="rfc2119">
MUST
</em>
<del class="diff-old">contains
</del>
<ins class="diff-chg">contain
</ins>
a
Service
Endpoint
which
<del class="diff-old">point
</del>
<ins class="diff-chg">points
</ins>
to
<ins class="diff-new">a
</ins>
Thing
Description
<del class="diff-old">of
the
</del>
<ins class="diff-chg">describing
that
</ins>
Thing
or
<del class="diff-old">Directory
Description
of
the
</del>
<a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-19">
Thing
Description
Directory
</a>.
</span>
</p>
<aside class="example" id= "example-a-example-service-endpoint-in-a-did-document">
<div class="marker">
<a class="self-link" href= "#example-a-example-service-endpoint-in-a-did-document">
Example
<bdi>
1
</bdi>
</a>
<span class="example-title">:
A
Example
Service
Endpoint
in
a
DID
Document
</span>
</div>
<pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"service"</span>: [{
        <span class="hljs-attr">"id"</span>: <span class=
"hljs-string">"did:example:wotdiscoveryexample#td"</span>,
        <span class="hljs-attr">"type"</span>: <span class=
"hljs-string">"WotThingDescription"</span>,
        <span class="hljs-attr">"serviceEndpoint"</span>:
            <span class=
<del class="diff-old">"hljs-string"&gt;"https://wot.example.com/.well-known/wot-thing-description"
</del>
<ins class="diff-chg">"hljs-string">"https://wot.example.com/.well-known/wot"</span>
</ins>
    }]
}
</code>
</pre>
</aside>
<div class="issue" id="issue-container-number-65">
<div role="heading" class="issue-title marker" id="h-issue" aria-level="4">
<a href= "https://github.com/w3c/wot-discovery/issues/65">
<span class= "issue-number">
Issue
65
</span>
</a>
<del class="diff-old">:
</del>
<span class="issue-label">:
Create
typed
links
in
DID
Documents
for
WoT
Directories
<a class= "respec-gh-label" href= "https://github.com/w3c/wot-discovery/issues/?q=is%3Aissue+is%3Aopen+label%3A%22DID%22" style="background-color: rgb(252, 201, 146); color: rgb(0, 0, 0);" aria-label="GitHub label: DID">
DID
</a>
</span>
</div>
<p dir="auto">
These
should
be
consistent
with
a
general
model
that
we
should
also
use
for
similar
things,
i.e.
CoRE-RD
and
DNS-SD.
We
should
discuss
with
DID
the
process
for
how
to
document
a
link
type
for
use
in
DID
Documents.
</p>
</div>
</section>
</section>
<section id="exploration-mech" class="normative">
<div class="header-wrapper">
<h2 id="x7-exploration-mechanisms">
<bdi class="secno">
<del class="diff-old">6.
</del>
<ins class="diff-chg">7.
</ins>
</bdi>
Exploration
Mechanisms
</h2>
<a class="self-link" href="#exploration-mech" aria-label= "Permalink for Section 7.">
</a>
<del class="diff-old">Editor's
note
</del>
</div>
<ins class="diff-chg">This
section
defines
the
supported
exploration
mechanisms
after
providing
some
common
background
material.
</ins><section id="exploration-overview" class="normative"><div class="header-wrapper"><h3 id="x7-1-overview">
<del class="diff-old">:
Exploration
Mechanism
</del>
<bdi class="secno">
<ins class="diff-chg">7.1
</ins></bdi>
Overview
</h3>
<a class="self-link" href="#exploration-overview" aria-label= "Permalink for Section 7.1">
</a>
</div>
<del class="diff-old">To
do:
Description
</del>
<figure id="exploration-class-diagram">
<img src= "images/exploration-class-diagram.svg" class="wot-diagram" alt= "Exploration mechanisms high-level class diagram" height="273" width="766" />
<figcaption>
<ins class="diff-chg">Figure
</ins><bdi class="figno"><ins class="diff-chg">
4
</ins></bdi><span class= "fig-title"><ins class="diff-chg">
The
high-level
class
diagram
</ins>
of
<del class="diff-old">supported
explorations,
</del>
<ins class="diff-chg">the
exploration
mechanisms,
depicting
how
Thing
Description
Servers
</ins>
and
<del class="diff-old">requirements
</del>
<ins class="diff-chg">Thing
Description
Directories
provide
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-1"><ins class="diff-chg">
TDs
</ins></a>.<ins class="diff-chg">
A
Self-describing
Thing
is
a
special
case
of
a
Thing
Description
Server
that
is
also
a
Thing.
A
Thing
Description
Directory
acts
as
a
Thing
Description
Server
</ins>
for
<del class="diff-old">new
exploration
mechanisms.
</del>
<ins class="diff-chg">each
Thing
Description
it
contains.
</ins></span></figcaption></figure><p><a href="#exploration-class-diagram" data-matched-text= "[[[#exploration-class-diagram]]]" class="fig-ref" title= "The high-level class diagram of the exploration mechanisms, depicting how Thing Description Servers and Thing Description Directories provide TDs. A Self-describing Thing is a special case of a Thing Description Server that is also a Thing. A Thing Description Directory acts as a Thing Description Server for each Thing Description it contains.">
Figure
<bdi class="figno">
4
</bdi>
</a>
depicts
the
high-level
information
model
for
<del class="diff-old">self-describing
</del>
<a href="#dfn-wot-td-server" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-td-server-1">
<ins class="diff-chg">TD
Servers
</ins></a><ins class="diff-chg">
(serving
single
TDs,
including
those
for
self-description)
</ins>
and
<del class="diff-old">directory
</del>
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-20">
<ins class="diff-chg">Thing
Description
Directory
</ins></a>
services.
<del class="diff-old">These
</del>
<ins class="diff-chg">A
</ins><a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-21"><ins class="diff-chg">
Thing
Description
Directory
</ins></a><ins class="diff-chg">
may
contain
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-2"><ins class="diff-chg">
TDs
</ins></a><ins class="diff-chg">
and
at
the
same
time
is
also
a
Thing,
which
means
it
has
its
own
TD.
A
directory
also
hosts
web
service
endpoints
for
retrieving
individual
TDs
for
other
Things
and
each
of
these
can
be
used
as
a
TD
Server.
A
Thing
may
in
general
host
its
own
TD
in
which
case
it
is
a
Self-Describing
Thing.
Self-description
is
not
mandatory
for
directories,
but
Self-Describing
Thing
Description
Directories
are
possible
that
are
both
Thing
Description
Directories
and
Self-Describing
Things.
</ins></p><p><ins class="diff-chg">
The
two
basic
</ins>
exploration
mechanisms
are
described
in
<del class="diff-old">§&nbsp;
</del>
<a href= "#exploration-server" data-matched-text="[[[#exploration-server]]]" class="sec-ref">
<bdi class="secno">
<del class="diff-old">6.1
</del>
<ins class="diff-chg">7.2
</ins>
</bdi>
<del class="diff-old">Self-description
</del>
<ins class="diff-chg">Thing
Description
Server
</ins>
</a>
and
<del class="diff-old">§&nbsp;
6.2
</del>
<a href="#exploration-directory" data-matched-text= "[[[#exploration-directory]]]" class="sec-ref">
<bdi class= "secno">
<ins class="diff-chg">7.3
</ins>
</bdi>
<ins class="diff-new">Thing
Description
</ins>
Directory
</a>.
</p>
<section id="exploration-ontology" class="normative">
<div class="header-wrapper">
<h4 id="x7-1-1-ontology">
<bdi class="secno">
<ins class="diff-chg">7.1.1
</ins></bdi><ins class="diff-chg">
Ontology
</ins></h4><a class="self-link" href="#exploration-ontology" aria-label= "Permalink for Section 7.1.1"></a></div><figure id="discovery-class-diagram-ontology"><img src= "images/discovery-class-diagram-ontology.svg" class="wot-diagram" alt="Ontology of TD in discovery context" height="288" width= "787" />
<figcaption>
Figure
<bdi class="figno">
<del class="diff-old">4
</del>
<ins class="diff-chg">5
</ins>
</bdi>
<span class= "fig-title">
The
<del class="diff-old">high-level
class
diagram
</del>
<ins class="diff-chg">ontology
</ins>
of
<ins class="diff-new">Thing
Descriptions
in
</ins>
the
<del class="diff-old">exploration
mechanisms
</del>
<ins class="diff-chg">Discovery
context.
</ins>
</span>
</figcaption>
</figure>
<del class="diff-old">The
Thing
Description
Directory
</del>
<p>
<a href="#discovery-class-diagram-ontology" data-matched-text= "[[[#discovery-class-diagram-ontology]]]" class="fig-ref" title= "The ontology of Thing Descriptions in the Discovery context.">
<ins class="diff-chg">Figure
</ins><bdi class="figno"><ins class="diff-chg">
5
</ins></bdi>
</a>
<ins class="diff-new">illustrates
the
Discovery
ontology
as
an
extension
of
the
Thing
ontology.
</ins></p><p><ins class="diff-new">
The
</ins>
ontology
<ins class="diff-new">includes
a
class
for
metadata
that
are
associated
with
TDs
stored
in
a
directory.
This
class
is
called
</ins><code><ins class="diff-new">
RegistrationInformation
</ins></code><ins class="diff-new">
and
described
as
part
of
the
directory
specification
in
</ins><a href= "#exploration-directory-registration-info" data-matched-text= "[[[#exploration-directory-registration-info]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-new">
7.3.1.1
</ins></bdi><ins class="diff-new">
Registration
Information
</ins></a>.</p><p><ins class="diff-new">
The
Discovery
ontology
also
</ins>
defines
two
new
Thing
Description
<del class="diff-old">classes
</del>
<ins class="diff-chg">classes,
described
in
the
following
sections,
</ins>
that
may
be
used
to
model
special
exploratory
metadata:
<del class="diff-old">Directory
Description
</del>
<a href= "#exploration-td-type-thingdirectory">
<ins class="diff-chg">ThingDirectory
</ins></a><ins class="diff-chg">
and
</ins><a href="#exploration-td-type-thinglink"><ins class="diff-chg">
ThingLink
</ins></a>.</p><section id="exploration-td-type-thingdirectory" class="normative"><div class="header-wrapper"><h5 id="x7-1-1-1-thingdirectory"><bdi class="secno"><ins class="diff-chg">
7.1.1.1
</ins></bdi><code><ins class="diff-chg">
ThingDirectory
</ins></code></h5><a class="self-link" href="#exploration-td-type-thingdirectory" aria-label="Permalink for Section 7.1.1.1"></a></div><div class="issue" id="issue-container-number-148"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="6"><a href= "https://github.com/w3c/wot-discovery/issues/148"><span class= "issue-number"><ins class="diff-chg">
Issue
148
</ins></span></a><span class="issue-label">:<ins class="diff-chg">
Discovery
context
and
namespace
under
w3.org/ns
</ins></span></div><div class=""><ins class="diff-chg">
The
type
URIs
used
below
are
tentative
and
subject
to
change.
</ins></div></div><span class="rfc2119-assertion" id= "exploration-directory-description-type">
A
TD
which
describes
a
<del class="diff-old">directory
instance.
The
Directory
</del>
<ins class="diff-chg">Thing
</ins>
Description
<ins class="diff-new">Directory
instance
</ins>
<em class="rfc2119">
MUST
</em>
use
type
<code>
<del class="diff-old">DirectoryDescription
</del>
<ins class="diff-chg">ThingDirectory
</ins>
</code>
from
the
discovery
context
or
URI
<code>
<del class="diff-old">https://www.w3.org/2021/wot/discovery#DirectoryDescription
</del>
<ins class="diff-chg">https://www.w3.org/2021/wot/discovery#ThingDirectory
</ins>
</code>.
</span>
<p>
<ins class="diff-new">A
TD
of
this
class
can
be
derived
from
Directory's
Thing
Model;
see
</ins><a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref">
<del class="diff-old">Example
3
</del>
<bdi class= "secno">
<ins class="diff-chg">7.3.2.4
</ins>
</bdi>
<del class="diff-old">which
describes
the
</del>
API
<del class="diff-old">of
the
Thing
Description
Directory
is
an
example
of
this
TD
type.
</del>
<ins class="diff-chg">Specification
(Thing
Model)
</ins></a>.
</p>
<del class="diff-old">Link
Description
</del>
</section>
<section id="exploration-td-type-thinglink" class="normative">
<div class="header-wrapper">
<h5 id="x7-1-1-2-thinglink">
<bdi class="secno">
<ins class="diff-chg">7.1.1.2
</ins></bdi><code><ins class="diff-chg">
ThingLink
</ins></code></h5><a class="self-link" href="#exploration-td-type-thinglink" aria-label="Permalink for Section 7.1.1.2"></a></div><div class="issue" id="issue-container-number-148-0"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="6"><a href= "https://github.com/w3c/wot-discovery/issues/148"><span class= "issue-number"><ins class="diff-chg">
Issue
148
</ins></span></a><span class="issue-label">:<ins class="diff-chg">
Discovery
context
and
namespace
under
w3.org/ns
</ins></span></div><div class=""><ins class="diff-chg">
The
type
URIs
used
below
are
tentative
and
subject
to
change.
</ins></div></div><span class="rfc2119-assertion" id= "exploration-link-description-type">
A
TD
which
describes
a
reference
to
another
<del class="diff-old">TD.
The
Link
Description
</del>
<ins class="diff-chg">TD
</ins>
<em class="rfc2119">
MUST
</em>
use
type
<code>
<del class="diff-old">LinkDescription
</del>
<ins class="diff-chg">ThingLink
</ins>
</code>
from
the
discovery
context
or
URI
<code>
<del class="diff-old">https://www.w3.org/2021/wot/discovery#LinkDescription
</del>
<ins class="diff-chg">https://www.w3.org/2021/wot/discovery#ThingLink
</ins>
</code>.
</span>
<span class="rfc2119-assertion" id= "exploration-link-description-link">
<del class="diff-old">The
</del>
<ins class="diff-chg">A
Thing
</ins>
Link
<del class="diff-old">Description
</del>
<em class= "rfc2119">
MUST
</em>
define
the
<del class="diff-old">reference
</del>
<ins class="diff-chg">referenced
</ins>
TD
as
a
Link
with
<code>
describedby
</code>
link
relation
type,
<code>
application/td+json
</code>
media
type
and
<code>
href
</code>
set
to
the
target
URL.
</span>
<p>
<a href="#example-td-link-type" data-matched-text= "[[[#example-td-link-type]]]" class="box-ref">
Example
<bdi>
2
</bdi>
</a>
is
an
example
<del class="diff-old">Link
Description.
</del>
<ins class="diff-chg">Thing
Link.
</ins>
</p>
<aside class="example" id="example-td-link-type">
<div class="marker">
<a class="self-link" href= "#example-td-link-type">
Example
<bdi>
2
</bdi>
</a>
<span class= "example-title">:
Example
<del class="diff-old">Link
Description
</del>
<ins class="diff-chg">of
a
Thing
Link,
referencing
a
remote
TD
</ins>
</span>
</div>
<pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
<del class="diff-old">        &lt;span class=
"hljs-string"&gt;"https://www.w3.org/2019/wot/td/v1",
</del>
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"@type"</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"LinkDescription",
</del>
<ins class="diff-chg">"hljs-string">"ThingLink"</span>,
</ins>
    <span class="hljs-attr">"id"</span>: <span class=
"hljs-string">"urn:example:link"</span>,
    <span class="hljs-attr">"links"</span>: [{
        <span class="hljs-attr">"rel"</span>: <span class=
"hljs-string">"describedby"</span>,
        <span class="hljs-attr">"href"</span>: <span class=
"hljs-string">"https://example.com/td.jsonld"</span>,
        <span class="hljs-attr">"type"</span>: <span class=
"hljs-string">"application/td+json"</span>
    }],
    <span class="hljs-attr">"security"</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"basic_sc",
</del>
<ins class="diff-chg">"hljs-string">"nosec_sc"</span>,
</ins>
    <span class="hljs-attr">"securityDefinitions"</span>: {
<del class="diff-old">        : {
</del>
        <span class="hljs-attr">"nosec_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"basic"
</del>
<ins class="diff-chg">"hljs-string">"nosec"</span>
</ins>
        }
    },
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Example TD referencing another"</span>
}
</code>
</pre>
<div class="issue" id="issue-container-number-148-1">
<div role="heading" class="issue-title marker" id="h-issue-2" aria-level="6">
<a href= "https://github.com/w3c/wot-discovery/issues/148">
<span class= "issue-number">
Issue
<del class="diff-old">54
</del>
<ins class="diff-chg">148
</ins>
</span>
</a>
<span class="issue-label">:
<del class="diff-old">Need
to
define
the
discovery
types
</del>
<ins class="diff-chg">Discovery
context
</ins>
and
<del class="diff-old">vocabulary
</del>
<ins class="diff-chg">namespace
under
w3.org/ns
</ins>
</span>
</div>
<div class="">
The
context
<del class="diff-old">and
type
</del>
URIs
are
tentative
and
subject
to
change.
</div>
</div>
</aside>
<p>
<ins class="diff-chg">A
Thing
Link
can
be
used
in
various
scenarios.
For
example:
</ins></p><ul><li><ins class="diff-chg">
A
self-describing
Thing
with
limited
computational
resources
intends
to
describe
itself:
host
a
minimal
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-3"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
(Thing
Link)
locally
and
references
a
larger
one
with
the
full
details
hosted
at
a
different
URL,
perhaps
in
a
directory.
</ins></li><li><ins class="diff-chg">
A
self-describing
Thing
or
proxy
has
a
very
large
or
dynamic
description:
registers
a
small
or
static
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-4"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
(Thing
Link)
in
a
directory
which
references
the
actual
</ins><a href= "#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-5"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
hosted
at
the
edge.
</ins></li></ul></section></section><section id="exploration-secboot" class="normative"><div class="header-wrapper"><h4 id="x7-1-2-security-bootstrapping">
<del class="diff-old">6.1
</del>
<bdi class= "secno">
<ins class="diff-chg">7.1.2
</ins>
</bdi>
<del class="diff-old">Self-description
</del>
<ins class="diff-chg">Security
Bootstrapping
</ins></h4><a class="self-link" href="#exploration-secboot" aria-label= "Permalink for Section 7.1.2">
</a>
</div>
<p>
The
<del class="diff-old">self-description
</del>
<ins class="diff-chg">purpose
of
an
exploration
service
</ins>
is
<ins class="diff-new">to
serve
TDs,
but
only
after
suitable
authentication,
and
only
to
authorized
parties.
However,
in
some
cases
a
Discoverer
may
not
know
what
security
credentials
are
needed
to
access
a
TD
via
</ins>
an
exploration
<del class="diff-old">mechanism
</del>
<ins class="diff-chg">service,
particularly
</ins>
in
<del class="diff-old">which
</del>
<ins class="diff-chg">ad-hoc
scenarios.
Since
upon
first
access
to
an
exploration
service
</ins>
a
<del class="diff-old">Thing
hosts
its
own
</del>
<ins class="diff-chg">Discoverer
will
not
yet
have
access
to
the
</ins>
TD
<ins class="diff-chg">if
suitable
authentication
credentials
are
not
provided,
the
Discoverer
can't
depend
on
the
security
metadata
held
in
TDs
to
know
what
kind
of
authentication
</ins>
and
<del class="diff-old">exposes
</del>
<ins class="diff-chg">authorization
information
is
needed.
If
the
Discoverer
has
no
prior
knowledge,
</ins>
it
<ins class="diff-new">will
have
to
depend
on
existing
security
negotation
support
to
bootstrap
access,
</ins>
at
<ins class="diff-new">least
to
the
TD
itself.
</ins></p><p><ins class="diff-new">
We
define
the
following
for
the
HTTP
protocol,
for
which
security
negotiation
processes
already
exist.
However,
most
of
the
HTTP
negotiation
processes
assume
there
is
a
human
user
in
the
loop,
but
this
is
also
appropriate
for
WoT
Discovery,
since
this
problem
will
typically
occur
when
a
user
is
trying
to
access
a
public
WoT
service
or
perform
integration
of
a
new
device.
In
this
case
the
purpose
of
negotiation
is
to
provide
guidance
on
what
credentials
are
needed
to
access
the
system.
</ins></p><p><ins class="diff-new">
In
cases
when
exploration
services
are
being
used
to
automate
system
management
it
would
be
best
to
pre-establish
what
credentials
(and
authentication
mechanisms)
are
needed
to
access
the
relevant
exploration
services
and
security
bootstrapping
would
not
be
required.
For
this
reason
security
bootstrapping
is
not
a
mandatory
feature,
and
can
be
omitted
or
disabled
on
devices
that
are
to
be
used
with
pre-established
security
mechanisms.
</ins></p><p><ins class="diff-new">
Security
bootstrapping
may
also
only
be
necessary
on
the
</ins><em><ins class="diff-new">
first
</ins></em><ins class="diff-new">
access
to
a
TD.
Once
a
Discoverer
has
determined
what
credentials
and
authentication
mechanism
are
required
to
access
a
particular
exploration
service,
they
can
retain
this
information
and
attempt
to
use
them
for
future
accesses.
Note
however
that
depending
on
the
security
scheme
used,
credentials
themselves
may
expire
and
may
need
to
be
re-established
periodically.
</ins></p><p><span class="rfc2119-assertion" id= "security-bootstrapping-endpoints"><ins class="diff-new">
Security
bootstrapping
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
be
provided
on
any
HTTP
endpoint
that
serves
a
TD.
</ins></span><ins class="diff-new">
As
mentioned
above,
disabling
or
omitting
security
bootstrapping
is
permissible
if
security
mechanisms
have
been
previously
established.
For
example,
if
an
installation
wants
to
use
the
OAuth2
</ins><code><ins class="diff-new">
client
</ins></code><ins class="diff-new">
flow
and
provide
potential
clients
with
an
address
of
an
authentication
server
to
use
in
advance,
then
security
bootstrapping
can
be
disabled,
since
the
alternative
would
be
to
include
other
(and
potentially
weaker)
forms
of
authentication.
</ins></p><p><ins class="diff-new">
In
the
HTTP
protocol,
the
authentication
and
authorization
mechanisms
to
be
used
can
generally
be
negotiated
by
the
HTTP
server
returning
a
"401
(Unauthorized)"
response
code
in
conjunction
with
a
</ins><code><ins class="diff-new">
WWW-Authenticate
</ins></code><ins class="diff-new">
header
that
specifies
the
information
required.
To
gain
access,
the
client
then
needs
to
make
another
request
with
the
necessary
information.
</ins><a href= "https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml"><ins class="diff-new">
There
are
several
authentication
schemes
registered
with
IANA.
</ins></a><ins class="diff-new">
However,
not
all
of
these
are
in
wide
use,
some
are
experimental,
and
there
is
only
partial
overlap
with
the
schemes
supported
by
TDs.
Also,
note
that
the
</ins><code><ins class="diff-new">
oauth
</ins></code><ins class="diff-new">
scheme
in
the
IANA
registration
refers
to
OAuth1,
which
is
deprecated,
so
it
should
not
be
used.
The
relevant
OAuth2
flow,
the
</ins><code><ins class="diff-new">
code
</ins></code><ins class="diff-new">
flow,
instead
of
a
401
response
begins
with
</ins>
a
<ins class="diff-new">redirection
to
an
authentication
server,
eventually
resulting
in
credentials
(bearer
tokens
in
the
case
of
WoT)
that
can
be
used
for
access.
</ins></p><p><ins class="diff-new">
Given
these
considerations,
to
enable
security
bootstrapping
on
a
wide
variety
of
devices
as
well
as
on
browsers,
the
following
constraints
should
be
observed:
</ins></p><ul><li><span class="rfc2119-assertion" id="exploration-secboot-401"><ins class="diff-new">
If
security
bootstrapping
is
enabled
on
an
exploration
service,
after
initial
contact
using
the
</ins>
URL
<ins class="diff-new">provided
by
an
introduction
mechanism,
the
exploration
service
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
reply
with
either
an
HTTP
"401
(Unauthorized)"
response
code
</ins>
or
<del class="diff-old">through
others
means.
</del>
<ins class="diff-chg">(in
the
case
of
OAuth2)
with
either
a
HTTP
"302
(Found)"
or
"303
(See
Other)"
response
code
if
appropriate
authentication
information
has
not
been
provided
but
access
can
be
granted
when
it
is.
</ins></span><ins class="diff-chg">
Note
that
if
the
exploration
service
does
not
want
to
provide
access
for
some
reason,
or
if
security
bootstrapping
is
disabled,
it
can
ignore
the
request
or
reply
with
another
code
such
as
404
or
403.
Also,
if
no
authentication
is
required,
then
the
system
can
reply
immediately
with
the
requested
TD
as
if
authentication
information
were
provided.
Bypassing
authentication
however
is
only
appropriate
if
the
TD
served
as
a
response
does
not
contain
and
cannot
be
used
to
infer
Personally
Identifiable
Information;
see
</ins><a href= "#privacy-considerations" class="sec-ref"><bdi class= "secno"><ins class="diff-chg">
9.
</ins></bdi><ins class="diff-chg">
Privacy
Considerations
</ins></a>.</li><li><span class="rfc2119-assertion" id= "exploration-secboot-auth">
If
<del class="diff-old">exposed
at
</del>
<ins class="diff-chg">security
bootstrapping
is
enabled
on
an
exploration
service
using
one
of
the
following
IANA-registered
HTTP
Authentication
Schemes:
Basic,
Bearer,
or
Digest,
then
</ins>
a
<del class="diff-old">URL
(e.g.
over
</del>
<ins class="diff-chg">401
</ins>
HTTP
<ins class="diff-new">response
at
an
API
endpoint
intended
to
serve
a
TD
</ins><em class= "rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
include
a
</ins><code><ins class="diff-new">
WWW-Authenticate
</ins></code><ins class="diff-new">
header
and
any
other
headers
describing
the
required
authorizations.
</ins></span><ins class="diff-new">
For
details
of
the
requirements,
the
IANA
registry
should
be
consulted
for
each
of
the
above
authentication
schemes.
</ins><span class="rfc2119-assertion" id= "exploration-secboot-oauth2-flows"><ins class="diff-new">
If
the
OAuth2
</ins><code><ins class="diff-new">
code
</ins></code><ins class="diff-new">
flow
is
used
during
security
bootstrapping,
the
"302
(Found)"
</ins>
or
<del class="diff-old">CoAP),
</del>
<ins class="diff-chg">"303
(See
Other)"
response
code
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
used
for
redirection
to
</ins>
the
<del class="diff-old">URL
may
</del>
<ins class="diff-chg">authentication
server,
with
access
credentials
eventually
being
represented
with
bearer
tokens.
</ins></span><ins class="diff-chg">
Note
that
the
other
OAuth2
flows
supported
in
WoT
Thing
Description
1.1,
</ins><code><ins class="diff-chg">
client
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
device
</ins></code>,<ins class="diff-chg">
both
expect
the
initial
access
to
</ins>
be
<del class="diff-old">advertised
</del>
<ins class="diff-chg">to
the
authentication
server,
not
the
final
endpoint,
and
so
cannot
be
used
</ins>
via
<del class="diff-old">one
</del>
<ins class="diff-chg">security
bootstrapping.
These
requirements
also
apply
only
to
endpoints
</ins>
of
<ins class="diff-new">exploration
services
that
might
need
to
support
security
bootstrapping,
that
is
those
that
serve
TDs,
not
to
other
endpoints
that
might
be
provided
by
</ins>
the
<del class="diff-old">§&nbsp;
</del>
<ins class="diff-chg">same
exploration
service.
In
particular,
these
requirements
apply
only
to
URLs
that
can
be
referenced
by
introduction
mechanisms,
not
to
(for
example)
event
subscription
endpoints.
</ins></li></ul><p><ins class="diff-chg">
There
are
relevant
Security
and
Privacy
Considerations
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1"><ins class="diff-chg">
wot-architecture11
</ins></a></cite><ins class="diff-chg">
]
and
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1"><ins class="diff-chg">
wot-thing-description11
</ins></a></cite><ins class="diff-chg">
]
regarding
when
authentication
is
required
for
access
to
TDs
and
the
use
of
secure
transport.
See
also
</ins><a href="#privacy-considerations" data-matched-text="[[[#privacy-considerations]]]" class= "sec-ref">
<bdi class="secno">
<del class="diff-old">5.
</del>
<ins class="diff-chg">9.
</ins>
</bdi>
<del class="diff-old">Introduction
Mechanisms
</del>
<ins class="diff-chg">Privacy
Considerations
</ins>
</a>.
<del class="diff-old">The
hosted
</del>
<ins class="diff-chg">In
summary,
secure
transport
(e.g.
TLS)
is
required
for
public
services
and
strongly
recommended
even
on
private
networks
(even
if
there
is
no
authentication
requirement,
to
protect
the
confidentiality
of
queries),
and
serving
requests
without
authentication
and
authorization
should
only
be
considered
in
limited
circumstances
when
no
Personally
Identifiable
Information
is
present
or
can
be
inferred.
</ins></p></section></section><section id="exploration-server" class="normative"><div class="header-wrapper"><h3 id="x7-2-thing-description-server"><bdi class="secno"><ins class="diff-chg">
7.2
</ins></bdi><ins class="diff-chg">
Thing
Description
Server
</ins></h3><a class="self-link" href="#exploration-server" aria-label= "Permalink for Section 7.2"></a></div><p><ins class="diff-chg">
Any
web
service
that
can
be
referenced
by
a
URL
and
return
a
</ins>
TD
<del class="diff-old">may
also
</del>
<ins class="diff-chg">with
appropriate
authentication
and
access
controls
can
</ins>
be
<del class="diff-old">registered
inside
</del>
<ins class="diff-chg">used
as
an
exploration
mechanism.
We
will
refer
to
this
as
</ins>
a
Thing
Description
<del class="diff-old">Directory
</del>
<ins class="diff-chg">Server
or
TD
Server.
A
TD
Server
does
not
need
to
be
a
Thing.
In
particular,
a
TD
can
be
hosted
on
an
ordinary
web
server
and
referenced
by
its
URL.
</ins></p><p><ins class="diff-chg">
A
TD
Server
can
be
used
to
support
self-description.
For
self-description,
a
</ins><a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-1"><ins class="diff-chg">
Thing
</ins>
</a>
<ins class="diff-new">hosts
its
own
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-6"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
and
makes
it
available
via
a
web
resource
identified
with
a
URL.
Such
a
web
resource
however
is
not
included
</ins>
as
<del class="diff-old">prescribed
</del>
<ins class="diff-chg">an
affordance
</ins>
in
<del class="diff-old">§&nbsp;
</del>
<ins class="diff-chg">the
TD
itself.
This
web
resource
may
or
may
not
be
the
same
as
the
well-known
URL
used
as
an
Introduction
mechanism
defined
in
</ins><a href="#introduction-well-known" class= "sec-ref">
<bdi class="secno">
6.2
</bdi>
<del class="diff-old">Directory
</del>
<ins class="diff-chg">Well-Known
URIs
</ins>
</a>.
</p>
<del class="diff-old">The
self-description
</del>
<p>
<ins class="diff-chg">Use
of
secure
transport
is
subject
to
assertions
given
in
the
Security
Considerations
and
Privacy
Considerations
sections
of
the
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1"><ins class="diff-chg">
wot-architecture11
</ins></a></cite><ins class="diff-chg">
]
and
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1"><ins class="diff-chg">
wot-thing-description11
</ins></a></cite><ins class="diff-chg">
]
specifications,
which
define
scenarios
where
secure
transport
is
recommended
or
mandatory
and
mutual
authentication
is
recommended.
</ins></p><p><ins class="diff-chg">
A
TD
Server
distributing
a
TD
</ins>
using
the
following
protocols
<del class="diff-old">must
be
according
</del>
<ins class="diff-chg">is
subject
</ins>
to
the
<del class="diff-old">given
specification:
</del>
<ins class="diff-chg">following
constraints:
</ins></p>
<dl>
<dt>
HTTP
</dt>
<dd>
<p>
<del class="diff-old">The
</del>
<span class="rfc2119-assertion" id= "exploration-server-http-method">
<ins class="diff-chg">An
</ins>
HTTP-based
<del class="diff-old">self-description
</del>
<ins class="diff-chg">TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-7"><ins class="diff-chg">
TD
</ins></a>
<em class="rfc2119">
<del class="diff-old">SHOULD
</del>
<ins class="diff-chg">MUST
</ins></em><ins class="diff-chg">
serve
that
resource
with
a
</ins><code><ins class="diff-chg">
GET
</ins></code><ins class="diff-chg">
method.
</ins></span><span class= "rfc2119-assertion" id="exploration-server-http-resp"><ins class="diff-chg">
A
successful
response
from
an
HTTP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-8"><ins class="diff-chg">
TD
</ins></a><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
have
200
(OK)
status
and
the
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-9"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
in
the
body.
</ins></span><span class="rfc2119-assertion" id= "exploration-server-http-resp-content-type"><ins class="diff-chg">
A
successful
response
with
JSON
serialization
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
contain
</ins><code><ins class="diff-chg">
application/json
</ins></code><ins class="diff-chg">
or
more
specifically,
</ins><code><ins class="diff-chg">
application/td+json
</ins></code><ins class="diff-chg">
in
the
Content-Type
header.
</ins></span><span class="rfc2119-assertion" id= "exploration-server-http-resp-json"><ins class="diff-chg">
The
default
serialization
format
for
successful
response
bodies
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins>
</em>
be
<del class="diff-old">over
HTTPS
(HTTP
Over
TLS).
</del>
<ins class="diff-chg">JSON,
with
JSON-LD
1.1
[
</ins><cite><a class="bibref" data-link-type= "biblio" href="#bib-json-ld11" title= "JSON-LD 1.1"><ins class="diff-chg">
JSON-LD11
</ins></a></cite><ins class="diff-chg">
]
syntax.
</ins>
</span>
The
<ins class="diff-new">JSON-LD
syntax
allows
semantic
extensions
and
processing.
</ins><span class= "rfc2119-assertion" id= "exploration-server-http-alternate-content"><ins class="diff-new">
An
HTTP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type= "dfn" id="ref-for-dfn-td-10"><ins class="diff-new">
TD
</ins></a><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
provide
alternative
representations
through
server-driven
content
negotiation,
that
is
by
honoring
the
request's
Accept
and
Accept-Encoding
headers
and
responding
with
the
supported
TD
serialization
and
equivalent
Content-Type
and
Content-Encoding
headers.
</ins></span><span class="rfc2119-assertion" id= "exploration-server-http-alternate-language"><ins class="diff-new">
An
HTTP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-11"><ins class="diff-new">
TD
</ins></a><em class= "rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
provide
modified
TDs
or
error
responses
using
a
different
default
language
after
server-driven
content
negotiation,
that
is
by
honouring
the
request's
Accept-Language
header.
</ins></span></p><p><span class="rfc2119-assertion" id= "exploration-server-http-head"><ins class="diff-new">
An
HTTP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-12"><ins class="diff-new">
TD
</ins></a><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
respond
to
</ins><code><ins class="diff-new">
HEAD
</ins></code><ins class="diff-new">
requests
by
returning
only
the
headers
equivalent
to
those
returned
by
a
</ins><code><ins class="diff-new">
GET
</ins></code><ins class="diff-new">
request
to
the
same
endpoint.
</ins></span><ins class="diff-new">
This
enables
clients
to
retrieve
</ins>
HTTP
<ins class="diff-new">headers
such
as
the
Content-Length
in
advance
to
know
the
size
of
the
</ins><a href= "#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-13"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
(in
bytes)
and
decide
on
an
efficient
query
strategy.
</ins></p><p><ins class="diff-new">
In
constrained
environments,
a
single
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-14"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
may
be
too
large
to
process
for
the
</ins>
server
<ins class="diff-new">or
clients.
See
</ins><a href= "#perf-incremental-transfer" data-matched-text= "[[[#perf-incremental-transfer]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-new">
10.1
</ins></bdi><ins class="diff-new">
Incremental
Transfer
</ins></a><ins class="diff-new">
for
protocol-specific
recommendations
on
incremental
transfer
of
the
requested
payload.
</ins></p><p><ins class="diff-new">
Error
responses:
</ins></p><ul><li><ins class="diff-new">
401
(Unauthorized):
No
authentication.
</ins></li><li><ins class="diff-new">
403
(Forbidden):
Insufficient
rights
to
the
resource.
</ins></li></ul></dd></dl><dl><dt><ins class="diff-new">
CoAP
</ins></dt><dd><p><span class="rfc2119-assertion" id= "exploration-server-coap-method"><ins class="diff-new">
A
CoAP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-15"><ins class="diff-new">
TD
</ins></a>
<em class="rfc2119">
MUST
</em>
serve
<del class="diff-old">the
TD
</del>
<ins class="diff-chg">that
resource
</ins>
with
a
<code>
GET
</code>
method.
</span>
<span class= "rfc2119-assertion" id="exploration-server-coap-resp">
A
successful
response
<ins class="diff-new">from
a
CoAP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-16"><ins class="diff-new">
TD
</ins></a>
<em class="rfc2119">
MUST
</em>
have
<del class="diff-old">200
(OK)
</del>
<ins class="diff-chg">a
2.05
(Content)
</ins>
status,
contain
<ins class="diff-new">a
Content-Format
option
with
value
50
(
</ins><code><ins class="diff-new">
application/json
</ins></code><ins class="diff-new">
)
or
432
(
</ins>
<code>
application/td+json
</code>
<del class="diff-old">Content-Type
header,
</del>
<ins class="diff-chg">),
</ins>
and
the
<a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-17">
TD
</a>
in
<del class="diff-old">body.
</del>
<ins class="diff-chg">the
payload.
</ins>
</span>
<del class="diff-old">The
server
</del>
<ins class="diff-chg">Note
that
the
payload
might
be
split
over
multiple
message
exchanges
using
block-wise
transfer
[
</ins><cite><a class="bibref" data-link-type= "biblio" href="#bib-rfc7959" title= "Block-Wise Transfers in the Constrained Application Protocol (CoAP)"><ins class="diff-chg">
RFC7959
</ins></a></cite><ins class="diff-chg">
].
</ins><span class="rfc2119-assertion" id= "exploration-server-coap-alternate-content"><ins class="diff-chg">
A
CoAP-based
TD
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type= "dfn" id="ref-for-dfn-td-18"><ins class="diff-chg">
TD
</ins></a><em class="rfc2119">
MAY
</em>
provide
alternative
representations
through
server-driven
content
negotiation,
that
is
by
<del class="diff-old">honoring
</del>
<ins class="diff-chg">honouring
</ins>
the
request's
Accept
<del class="diff-old">header
</del>
<ins class="diff-chg">option
</ins>
and
responding
with
the
supported
<a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-19">
TD
</a>
serialization
and
equivalent
<del class="diff-old">Content-Type
header.
</del>
<ins class="diff-chg">Content-Format
option.
</ins>
</span>
<del class="diff-old">The
server
</del>
</p>
<p>
<span class="rfc2119-assertion" id= "exploration-server-coap-size2">
<ins class="diff-chg">A
CoAP-based
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-20"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
Server
providing
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-21"><ins class="diff-chg">
TD
</ins></a>
<em class="rfc2119">
SHOULD
</em>
<del class="diff-old">serve
the
</del>
<ins class="diff-chg">respond
to
</ins>
requests
<del class="diff-old">after
performing
necessary
authentication
and
authorization.
</del>
<ins class="diff-chg">containing
a
Size2
option
by
including
the
size
estimate
of
the
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-22"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
in
its
next
response.
</ins>
</span>
<ins class="diff-new">This
is
relevant
when
obtaining
a
</ins><a href= "#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-23"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
using
block-wise
transfer
and
enables
clients
to
abort
the
retrieval
if
the
total
payload
size
should
be
too
large
for
them
to
process.
</ins></p><p><ins class="diff-new">
In
constrained
environments,
a
single
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-24"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
may
be
too
large
to
process
for
the
server
or
clients.
See
</ins><a href= "#perf-incremental-transfer" data-matched-text= "[[[#perf-incremental-transfer]]]" class="sec-ref">
<bdi class= "secno">
<ins class="diff-new">10.1
</ins></bdi><ins class="diff-new">
Incremental
Transfer
</ins></a><ins class="diff-new">
for
protocol-specific
recommendations
on
incremental
transfer
of
the
requested
payload.
</ins>
</p>
<p>
Error
responses:
</p>
<ul>
<li>
<del class="diff-old">401
</del>
<ins class="diff-chg">4.01
</ins>
(Unauthorized):
No
authentication.
</li>
<li>
<del class="diff-old">403
</del>
<ins class="diff-chg">4.03
</ins>
(Forbidden):
Insufficient
rights
to
the
resource.
</li>
</ul>
</dd>
</dl>
</section>
<section id="exploration-directory" class="normative">
<div class="header-wrapper">
<h3 id="x7-3-thing-description-directory">
<del class="diff-old">6.2
</del>
<bdi class= "secno">
<ins class="diff-chg">7.3
</ins>
</bdi>
<ins class="diff-new">Thing
Description
</ins>
Directory
</h3>
<del class="diff-old">Editor's
note
</del>
<a class="self-link" href="#exploration-directory" aria-label= "Permalink for Section 7.3">
<del class="diff-old">:
Directory
Overview
</del>
</a>
</div>
<del class="diff-old">To
do:
Describe
mechanisms
</del>
<p>
<ins class="diff-chg">A
</ins><a href="#dfn-wot-thing-description-directory" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-22"><ins class="diff-chg">
Thing
Description
Directory
</ins></a><ins class="diff-chg">
(TDD
or
Directory
</ins>
for
<del class="diff-old">TDs
</del>
<ins class="diff-chg">short)
is
a
</ins><a href= "#dfn-thing" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-thing-2"><ins class="diff-chg">
Thing
</ins></a><ins class="diff-chg">
that
provides
a
service
</ins>
to
<del class="diff-old">be
hosted
in
</del>
<ins class="diff-chg">manage
</ins>
a
<del class="diff-old">searchable
directory
service.
</del>
<ins class="diff-chg">set
of
TDs
describing
other
Things.
</ins>
</p>
<section id="exploration-directory-info" class="normative">
<div class="header-wrapper">
<h4 id="x7-3-1-information-model">
<bdi class="secno">
<del class="diff-old">6.2.1
</del>
<ins class="diff-chg">7.3.1
</ins>
</bdi>
Information
Model
</h4>
<del class="diff-old">Editor's
note
:
Directory
Information
Model
To
Do:
Formal
definition
of
information
contained
in
a
directory
and
its
organization.
</del>
<a class="self-link" href="#exploration-directory-info" aria-label= "Permalink for Section 7.3.1">
<del class="diff-old">Figure
5
The
ontology
of
a
TD
</del>
</a>
<del class="diff-old">that
can
be
stored
in
a
Thing
Description
Directory
.
</del>
</div>
As
shown
in
<a href="#exploration-class-diagram" data-matched-text= "[[[#exploration-class-diagram]]]" class="fig-ref" title= "The high-level class diagram of the exploration mechanisms, depicting how Thing Description Servers and Thing Description Directories provide TDs. A Self-describing Thing is a special case of a Thing Description Server that is also a Thing. A Thing Description Directory acts as a Thing Description Server for each Thing Description it contains.">
Figure
<bdi class="figno">
4
</bdi>
</a>,
the
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-23">
Thing
Description
Directory
</a>
can
contain
zero
or
more
<del class="diff-old">TD
s.
</del>
<a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-25">
<ins class="diff-chg">TDs
</ins></a>.
For
every
TD,
the
directory
<del class="diff-old">may
additionally
maintain
the
registration
information
</del>
<ins class="diff-chg">maintains
additional
metadata
</ins>
for
bookkeeping
and
search
purposes.
<del class="diff-old">When
available,
consumers
may
request
the
registration
information
via
the
respective
API.
</del>
<ins class="diff-chg">These
are
described
in
</ins><a href= "#exploration-directory-registration-info" data-matched-text= "[[[#exploration-directory-registration-info]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.1.1
</ins></bdi><ins class="diff-chg">
Registration
Information
</ins></a><ins class="diff-chg">
and
</ins><a href="#exploration-directory-anonymous-td" data-matched-text="[[[#exploration-directory-anonymous-td]]]" class="sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.1.3
</ins></bdi><ins class="diff-chg">
Anonymous
TD
Identifiers
</ins></a>.
A
<a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-26">
TD
<del class="diff-old">which
</del>
</a>
<ins class="diff-chg">that
</ins>
embeds
<ins class="diff-new">such
additional
metadata
as
part
of
</ins>
the
<del class="diff-old">registration
information
</del>
<ins class="diff-chg">interaction
with
the
directory
</ins>
is
called
an
<a href="#dfn-wot-enriched-thing-description" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-1">
Enriched
TD
</a>.
<section id="exploration-directory-registration-info" class= "normative">
<div class="header-wrapper">
<h5 id="x7-3-1-1-registration-information">
<bdi class= "secno">
<ins class="diff-new">7.3.1.1
</ins></bdi><ins class="diff-new">
Registration
Information
</ins></h5><a class="self-link" href= "#exploration-directory-registration-info" aria-label= "Permalink for Section 7.3.1.1"></a></div>
The
ontology
of
a
<a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-27">
TD
</a>
<del class="diff-old">maintained
by
</del>
<ins class="diff-chg">in
</ins>
the
<del class="diff-old">directory
is
illustrated
</del>
<ins class="diff-chg">Discovery
context
was
introduced
</ins>
in
<a href= "#discovery-class-diagram-ontology" data-matched-text= "[[[#discovery-class-diagram-ontology]]]" class="fig-ref" title= "The ontology of Thing Descriptions in the Discovery context.">
Figure
<bdi class="figno">
5
</bdi>
</a>.
<ins class="diff-new">The
</ins><code><ins class="diff-new">
RegistrationInformation
</ins></code><ins class="diff-new">
class
is
associated
with
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-28"><ins class="diff-new">
TDs
</ins></a><ins class="diff-new">
that
are
stored
in
a
directory.
The
following
table
lists
the
registration
information
attributes
for
use
within
</ins><a href="#dfn-td" class="internalDFN" data-link-type= "dfn" id="ref-for-dfn-td-29"><ins class="diff-new">
TDs
</ins></a><ins class="diff-new">
that
embed
or
reference
the
Discovery
context.
Note
that
only
an
</ins><a href= "#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-2"><ins class="diff-new">
Enriched
TD
</ins></a><ins class="diff-new">
embeds
the
registration
information.
</ins><span class= "rfc2119-assertion" id="tdd-context-injection"><ins class="diff-new">
An
</ins><a href= "#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-3"><ins class="diff-new">
Enriched
TD
</ins></a><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
contain
in
its
@context
the
URI
</ins><code><ins class="diff-new">
https://w3c.github.io/wot-discovery/context/discovery-context.jsonld
</ins></code>.</span><ins class="diff-new">
In
this
table,
client
refers
to
the
producer
or
consumer
of
a
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-30"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
and
server
refers
to
the
</ins><a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-24"><ins class="diff-new">
Thing
Description
Directory
</ins></a>.<table class="def"><thead><tr><th><ins class="diff-new">
Vocabulary
term
</ins></th><th><ins class="diff-new">
Description
</ins></th><th><ins class="diff-new">
Client
Assignment
</ins></th><th><ins class="diff-new">
Server
Assignment
</ins></th><th><ins class="diff-new">
Type
</ins></th></tr></thead><tbody><tr class="rfc2119-table-assertion" id= "tdd-registrationinfo-vocab-created"><td><code><ins class="diff-new">
created
</ins></code></td><td><ins class="diff-new">
Provides
information
when
the
TD
instance
was
created
inside
the
directory.
</ins><p><ins class="diff-new">
This
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
be
set
by
the
directory
and
returned
to
consumers.
</ins></p></td><td><ins class="diff-new">
read-only
</ins></td><td><ins class="diff-new">
optional
</ins></td><td><a href= "http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code><ins class="diff-new">
dateTime
</ins></code></a></td></tr><tr class="rfc2119-table-assertion" id= "tdd-registrationinfo-vocab-modified"><td><code><ins class="diff-new">
modified
</ins></code></td><td><ins class="diff-new">
Provides
information
when
the
TD
instance
was
last
modified
inside
the
directory.
</ins><p><ins class="diff-new">
This
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
be
set
by
the
directory
and
returned
to
consumers.
</ins></p></td><td><ins class="diff-new">
read-only
</ins></td><td><ins class="diff-new">
optional
</ins></td><td><a href= "http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code><ins class="diff-new">
dateTime
</ins></code></a></td></tr><tr class="rfc2119-table-assertion" id= "tdd-registrationinfo-vocab-expires"><td><code><ins class="diff-new">
expires
</ins></code></td><td><ins class="diff-new">
Provides
the
absolute
time
for
when
the
TD
instance
registration
expires.
</ins><p><ins class="diff-new">
The
producer
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
set
this
to
indicate
the
absolute
expiry
time
during
the
registration.
</ins></p><p><ins class="diff-new">
For
servers
that
support
expirable
TDs:
If
</ins><code><ins class="diff-new">
ttl
</ins></code><ins class="diff-new">
(relative
expiry)
is
present,
the
server
</ins><em class= "rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
ignore
client
assignments
to
</ins><code><ins class="diff-new">
expires
</ins></code><ins class="diff-new">
and
instead
compute
and
set
it
internally.
</ins></p></td><td><ins class="diff-new">
optional
</ins></td><td><ins class="diff-new">
optional
</ins></td><td><a href= "http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code><ins class="diff-new">
dateTime
</ins></code></a></td></tr><tr class="rfc2119-table-assertion" id= "tdd-registrationinfo-vocab-ttl"><td><code><ins class="diff-new">
ttl
</ins></code></td><td><ins class="diff-new">
Time-to-live:
relative
amount
of
time
in
seconds
from
the
registration
time
until
when
the
TD
instance
registration
expires.
</ins><p><ins class="diff-new">
The
producer
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
set
this
to
indicate
the
relative
expiry
time
during
the
registration.
</ins></p><p><ins class="diff-new">
For
servers
that
support
expirable
TDs:
The
server
</ins><em class= "rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
use
</ins><code><ins class="diff-new">
ttl
</ins></code><ins class="diff-new">
to
calculate
the
</ins><code><ins class="diff-new">
expires
</ins></code><ins class="diff-new">
(absolute
expiry)
value.
</ins></p></td><td><ins class="diff-new">
optional
</ins></td><td><ins class="diff-new">
read-only
</ins></td><td><code><ins class="diff-new">
number
</ins></code></td></tr><tr class="rfc2119-table-assertion" id= "tdd-registrationinfo-vocab-retrieved"><td><code><ins class="diff-new">
retrieved
</ins></code></td><td><ins class="diff-new">
The
time
at
which
the
TD
was
retrieved
from
the
server.
</ins><p><ins class="diff-new">
This
is
useful
for
clients
that
intend
to
process
other
absolute
timestamps
but
do
not
have
an
internal
clock
or
other
means
of
acquiring
the
current
time.
</ins></p></td><td><ins class="diff-new">
read-only
</ins></td><td><ins class="diff-new">
optional
</ins></td><td><a href= "http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#dateTime"><code><ins class="diff-new">
dateTime
</ins></code></a></td></tr></tbody></table></section><section id="exploration-directory-registration-expiry" class= "normative"><div class="header-wrapper"><h5 id="x7-3-1-2-registration-expiry"><bdi class= "secno"><ins class="diff-new">
7.3.1.2
</ins></bdi><ins class="diff-new">
Registration
Expiry
</ins></h5><a class="self-link" href= "#exploration-directory-registration-expiry" aria-label= "Permalink for Section 7.3.1.2"></a></div><ins class="diff-new">
Section
</ins><a href="#exploration-directory-registration-info" data-matched-text="[[[#exploration-directory-registration-info]]]" class="sec-ref"><bdi class="secno"><ins class="diff-new">
7.3.1.1
</ins></bdi><ins class="diff-new">
Registration
Information
</ins></a><ins class="diff-new">
introduces
some
attributes
to
specify
and
discover
the
expiry
time
of
registered
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-31"><ins class="diff-new">
TDs
</ins></a>.<p><ins class="diff-new">
Producers
can
set
the
expiry
time
to
inform
the
directory
and
other
consumers
about
the
validity
of
the
TD
registrations.
The
expiry
is
also
a
useful
indicator
to
inform
the
consumers
about
expiry
of
dynamic
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-32"><ins class="diff-new">
TDs
</ins></a>,<ins class="diff-new">
e.g.
when
changes
to
metadata
such
as
geolocation
or
properties
are
expected
to
be
valid
for
a
limited
period.
Consumers
may
rely
on
the
expiry
time
to
know
how
long
a
retrieved
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-33"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
will
be
valid
and
when
they
need
to
request
a
more
recent
one.
Consumers
who
retrieve
an
expired
TD
may
consider
it
as
metadata
of
an
inactive
client.
</ins></p><p><ins class="diff-new">
For
the
servers,
the
expiry
time
is
useful
for
implementing
automatic
removal
of
obsolete
or
accidental
registrations.
</ins><span class="rfc2119-assertion" id= "tdd-registrationinfo-expiry-purge"><ins class="diff-new">
Servers
</ins><em class= "rfc2119"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
periodically
purge
TDs
that
are
past
their
expiry
times.
</ins></span><ins class="diff-new">
Prescribing
a
global
mandate
or
upper
limit
for
the
expiry
time
is
application-specific
and
beyond
the
scope
of
this
specification.
</ins><span class="rfc2119-assertion" id= "tdd-registrationinfo-expiry-config"><ins class="diff-new">
The
servers
</ins><em class= "rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
mandate
or
set
a
configurable
upper
limit
to
expiry
times
and
refuse
incompliant
requests.
</ins></span><ins class="diff-new">
The
purging
by
servers
is
particularly
beneficial
when
interacting
with
clients
(e.g.
IoT
devices)
that
are
unable
to
explicitly
deregister
their
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-34"><ins class="diff-new">
TDs
</ins></a>.<ins class="diff-new">
This
could
be
due
to
protocol-specific
limitations,
failure,
destruction,
or
ungraceful
decommissioning.
Such
clients
should
set
a
reasonably
short
expiry
time
and
periodically
extend
it
during
the
normal
operation.
The
expiry
can
be
extended
by
updating
the
registration
either
fully
or
partially,
including
an
update
that
makes
no
changes
to
the
TD;
see
</ins><a href= "#exploration-directory-api-things-update" data-matched-text= "[[[#exploration-directory-api-things-update]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-new">
7.3.2.1.3
</ins></bdi><ins class="diff-new">
Update
</ins></a>.<ins class="diff-new">
If
a
client
ceases
to
operate,
a
directory
with
purging
capability
will
automatically
remove
its
registration.
</ins>
</p>
</section>
<section id="exploration-directory-anonymous-td" class="normative">
<div class="header-wrapper">
<h5 id="x7-3-1-3-anonymous-td-identifiers">
<bdi class= "secno">
<ins class="diff-new">7.3.1.3
</ins></bdi><ins class="diff-new">
Anonymous
TD
Identifiers
</ins></h5><a class="self-link" href="#exploration-directory-anonymous-td" aria-label="Permalink for Section 7.3.1.3"></a></div><ins class="diff-new">
The
directory
assigns
local
identifiers
to
</ins><a href= "#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-1"><ins class="diff-new">
Anonymous
TDs
</ins></a><ins class="diff-new">
to
enable
management
and
retrieval
of
such
TDs
from
the
directory.
</ins><span class="rfc2119-assertion" id="tdd-anonymous-td-identifier"><ins class="diff-new">
In
situations
where
the
server
exposes
an
Anonymous
TD
(e.g.
retrieval,
listing,
search),
it
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
add
the
local
identifier
to
the
TD
to
allow
local
referencing.
</ins></span><span class="rfc2119-assertion" id= "tdd-anonymous-td-local-uuid"><ins class="diff-new">
The
local
identifier
</ins><em class= "rfc2119"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
be
a
UUID
Version
4,
presented
as
a
URN
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc4122" title= "A Universally Unique IDentifier (UUID) URN Namespace"><ins class="diff-new">
RFC4122
</ins></a></cite><ins class="diff-new">
].
</ins></span><ins class="diff-new">
UUID
Version
4
is
a
random
or
pseudo-random
number
which
does
not
carry
unintended
information
about
the
host
or
the
resource.
</ins></section></section>
<section id="exploration-directory-api" class="normative">
<div class="header-wrapper">
<h4 id="x7-3-2-directory-service-api">
<bdi class= "secno">
<del class="diff-old">6.2.2
</del>
<ins class="diff-chg">7.3.2
</ins>
</bdi>
Directory
Service
API
</h4>
<a class="self-link" href="#exploration-directory-api" aria-label= "Permalink for Section 7.3.2">
</a>
<del class="diff-old">The
</del>
</div>
<p>
Directory
<del class="diff-old">APIs
must
use
secure
protocols
guaranteeing
</del>
<ins class="diff-chg">services
provide
access
to
</ins>
<a href= "https://www.w3.org/TR/wot-security/#dfn-system-user-data">
System
User
Data
</a>
<ins class="diff-new">and
need
to
provide
appropriate
security
and
privacy
protections.
The
use
of
secure
transport
protocols
and
access
controls
for
</ins>
authenticity
and
confidentiality
<del class="diff-old">(see
</del>
<ins class="diff-chg">in
implementations
of
the
WoT
Directory
Service
API
are
governed
by
the
Security
Consideration
and
Privacy
Consierations
given
in
</ins>
[
<cite>
<del class="diff-old">WOT-SECURITY
</del>
<a class= "bibref" data-link-type="biblio" href="#bib-wot-architecture11" title= "Web of Things (WoT) Architecture 1.1">
<ins class="diff-chg">wot-architecture11
</ins>
</a>
</cite>
<del class="diff-old">]).
The
HTTP
API
MUST
be
exposed
over
HTTPS
(HTTP
Over
TLS).
</del>
<ins class="diff-chg">].
</ins></p>
<p>
The
HTTP
API
responses
must
use
appropriate
status
codes
described
in
this
section
for
success
and
error
responses.
<span class="rfc2119-assertion" id="tdd-http-error-response">
The
HTTP
API
<em class="rfc2119">
MUST
</em>
use
the
Problem
Details
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc7807" title= "Problem Details for HTTP APIs">
RFC7807
</a>
</cite>
]
format
to
carry
error
details
in
HTTP
client
error
(4xx)
and
server
error
(5xx)
responses.
</span>
This
enables
both
machines
and
humans
to
know
the
high-level
error
class
and
fine-grained
details.
<del class="diff-old">Editor's
note
:
WoT-specific
</del>
<span class= "rfc2119-assertion" id="tdd-http-error-response-utf-8">
<ins class="diff-chg">All
HTTP
API
</ins>
error
<del class="diff-old">types
The
</del>
<ins class="diff-chg">responses
described
using
</ins>
Problem
Details
<em class= "rfc2119">
<ins class="diff-new">MUST
</ins></em><ins class="diff-new">
be
encoded
using
UTF-8.
</ins></span><span class= "rfc2119-assertion" id="tdd-http-error-response-lang"><ins class="diff-new">
HTTP
API
</ins>
error
<del class="diff-old">type
field
is
a
URI
reference
which
could
used
to
map
the
occurred
error
to
WoT-specific
error
class.
There
are
few
open
issues
raising
</del>
<ins class="diff-chg">responses
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
report
details
in
different
languages
using
proactive
negotiation,
if
</ins>
the
<del class="diff-old">lack
of
WoT-specific
error
types:
wot-discovery#44
,
wot-thing-description#303
,
wot-scripting-api#200
.
For
now,
type
can
be
omitted
which
defaults
to
"about:blank",
and
</del>
<code>
<del class="diff-old">title
</del>
<ins class="diff-chg">Accept-Language
</ins>
</code>
<del class="diff-old">should
be
</del>
<ins class="diff-chg">header
field
has
been
</ins>
set
<del class="diff-old">to
</del>
<ins class="diff-chg">in
the
</ins>
HTTP
<del class="diff-old">status
text.
</del>
<ins class="diff-chg">request
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc7231" title= "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"><ins class="diff-chg">
RFC7231
</ins></a></cite><ins class="diff-chg">
].
</ins></span>
</p>
<p>
<del class="diff-old">Below
is
a
generic
Thing
Description
for
</del>
<ins class="diff-chg">The
APIs
set
</ins>
the
<del class="diff-old">Directory
</del>
HTTP
<del class="diff-old">API
with
OAuth2
security.
The
Thing
Description
alone
should
not
be
considered
</del>
<ins class="diff-chg">status
codes
</ins>
as
<del class="diff-old">the
full
specification
to
implement
or
interact
with
a
directory.
Additional
details
for
every
interaction
are
described
in
human-readable
form
</del>
<ins class="diff-chg">defined
</ins>
in
<del class="diff-old">the
subsequent
sections.
Example
3
</del>
<a href= "https://datatracker.ietf.org/doc/html/rfc7231#section-6">
<ins class="diff-chg">Section
6
</ins></a><ins class="diff-chg">
of
[
</ins><cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc7231" title= "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">
<ins class="diff-new">RFC7231
</ins>
</a>
<del class="diff-old">:
Thing
Description
</del>
</cite>
<ins class="diff-chg">].
The
list
</ins>
of
<ins class="diff-new">used
error
codes
include
(but
are
not
limited
to)
</ins>
the
<del class="diff-old">Directory
</del>
<ins class="diff-chg">following:
</ins></p><ul><li><ins class="diff-chg">
400
(Bad
Request):
Invalid
client
input
in
body,
query,
or
headers.
This
is
accompanied
by
an
appropriate
response
message.
</ins></li><li><ins class="diff-chg">
401
(Unauthorized):
The
request
lacks
valid
authentication
credentials.
As
noted
in
</ins><a href="#exploration-secboot" data-matched-text="[[[#exploration-secboot]]]" class= "sec-ref">
<del class="diff-old">{
    : [
        ,
        &lt;span class=
"hljs-string"&gt;"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"
    ],
    : &lt;span class=
"hljs-string"&gt;"DirectoryDescription",
    : &lt;span class=
"hljs-string"&gt;"Thing Description Directory (TDD)",
    : {
        : &lt;span class=
"hljs-string"&gt;"1.0.0-alpha"
    },
    : {
        : {
            : &lt;span class=
"hljs-string"&gt;"oauth2",
            : &lt;span class=
"hljs-string"&gt;"code",
            &lt;span class=
"hljs-attr"&gt;"authorization": &lt;span class=
"hljs-string"&gt;"https://auth.example.com/authorization",
            : &lt;span class=
"hljs-string"&gt;"https://auth.example.com/token",
            : [
                ,
                ,
                
            ]
        },
        : {
            : &lt;span class=
"hljs-string"&gt;"oauth2",
            : &lt;span class=
"hljs-string"&gt;"client",
            : &lt;span class=
"hljs-string"&gt;"https://auth.example.com/token",
            : [
                ,
                ,
                
            ]
        },
        : {
            : &lt;span class=
"hljs-string"&gt;"oauth2",
            : &lt;span class=
"hljs-string"&gt;"device",
            &lt;span class=
"hljs-attr"&gt;"authorization": &lt;span class=
"hljs-string"&gt;"https://auth.example.com/device_authorization",
            : &lt;span class=
"hljs-string"&gt;"https://auth.example.com/token",
            : [
                ,
                ,
                
            ]
        },
        : {
            : &lt;span class=
"hljs-string"&gt;"combo",
            : [
                ,
                ,
                
            ]
        }
    },
    : &lt;span class=
"hljs-string"&gt;"combo_sc",
    : &lt;span class=
"hljs-string"&gt;"https://tdd.example.com",
    : {
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Create a Thing Description",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Thing Description ID",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/td/{id}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"PUT",
                    &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/td+json",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;201
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Invalid serialization or TD",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"write"
                },
                {
                    &lt;span class=
"hljs-attr"&gt;"href",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"POST",
                    &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/td+json",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:headers": [
                            {
                                &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"System-generated UUID (version 4) URN",
                                &lt;span class=
"hljs-attr"&gt;"htv:fieldName": &lt;span class=
"hljs-string"&gt;"Location",
                                &lt;span class=
"hljs-attr"&gt;"htv:fieldValue": &lt;span class=
"hljs-string"&gt;""
                            }
                        ],
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;201
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Invalid serialization or TD",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"write"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Update a Thing Description",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Thing Description ID",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/td/{id}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"PUT",
                    &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/td+json",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;204
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Invalid serialization or TD",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"write"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Update parts of a Thing Description",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Thing Description ID",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/td/{id}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"PATCH",
                    &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/merge-patch+json",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;204
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Invalid serialization or TD",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        },
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"TD with the given id not found",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;404
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"write"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Delete a Thing Description",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Thing Description ID",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/td/{id}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"DELETE",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;204
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"TD with the given id not found",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;404
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"write"
                }
            ]
        }
    },
    : {
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Retrieve a Thing Description",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Thing Description ID",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/td/{id}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"GET",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200,
                        &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/td+json"
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"TD with the given id not found",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;404
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"read"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Retrieve all Thing Descriptions",
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"GET",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200,
                        &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/ld+json",
                    },
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"readAll"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"JSONPath syntactic search",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"A valid JSONPath expression",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/search/jsonpath?query={query}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"GET",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/json",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"JSONPath expression not provided or contains syntax errors",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"search"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"XPath syntactic search",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"A valid XPath expression",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/search/xpath?query={query}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"GET",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/json",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"JSONPath expression not provided or contains syntax errors",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"search"
                }
            ]
        },
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"SPARQL semantic search",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"A valid SPARQL 1.1. query",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/search/sparql?query={query}",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"GET",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"JSONPath expression not provided or contains syntax errors",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"search"
                },
                {
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/search/sparql",
                    &lt;span class=
"hljs-attr"&gt;"htv:methodName": &lt;span class=
"hljs-string"&gt;"POST",
                    : {
                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Success response",
                        &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/json",
                        &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;200
                    },
                    &lt;span class=
"hljs-attr"&gt;"additionalResponses": [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"JSONPath expression not provided or contains syntax errors",
                            &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"application/problem+json",
                            &lt;span class=
"hljs-attr"&gt;"htv:statusCodeValue": &lt;span class=
"hljs-number"&gt;400
                        }
                    ],
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"search"
                }
            ]
        }
    },
    : {
        : {
            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"TD registration events",
            : {
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Event type",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                    : [
                        &lt;span class=
"hljs-string"&gt;"created_td",
                        &lt;span class=
"hljs-string"&gt;"updated_td",
                        &lt;span class=
"hljs-string"&gt;"deleted_td"
                    ]
                },
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Identifier of TD in directory",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string"
                },
                : {
                    &lt;span class=
"hljs-attr"&gt;"title": &lt;span class=
"hljs-string"&gt;"Include TD changes inside event data",
                    &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"boolean"
                }
            },
            : [
                {
                    &lt;span class=
"hljs-attr"&gt;"op": &lt;span class=
"hljs-string"&gt;"subscribeevent",
                    &lt;span class=
"hljs-attr"&gt;"href": &lt;span class=
"hljs-string"&gt;"/events{?type,td_id,include_changes}",
                    &lt;span class=
"hljs-attr"&gt;"subprotocol": &lt;span class=
"hljs-string"&gt;"sse",
                    &lt;span class=
"hljs-attr"&gt;"contentType": &lt;span class=
"hljs-string"&gt;"text/event-stream",
                    : [
                        {
                            &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"ID of the last event for reconnection",
                            &lt;span class=
"hljs-attr"&gt;"htv:fieldName": &lt;span class=
"hljs-string"&gt;"Last-Event-ID",
                            &lt;span class=
"hljs-attr"&gt;"htv:fieldValue": &lt;span class=
"hljs-string"&gt;""
                        }
                    ],
                    : {
                        : [
                            {
                                &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"object",
                                &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"The schema of event data",
                                &lt;span class=
"hljs-attr"&gt;"properties": {
                                    &lt;span class=
"hljs-attr"&gt;"td_id": {
                                        &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                                        &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference",
                                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Identifier of TD in directory"
                                    }
                                }
                            },
                            {
                                &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"object",
                                &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"The schema of create event data including the created TD",
                                &lt;span class=
"hljs-attr"&gt;"properties": {
                                    &lt;span class=
"hljs-attr"&gt;"td_id": {
                                        &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                                        &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference",
                                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Identifier of TD in directory"
                                    },
                                    &lt;span class=
"hljs-attr"&gt;"td": {
                                        &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"object",
                                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"The created TD in a create event"
                                    }
                                }
                            },
                            {
                                &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"object",
                                &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"The schema of the update event data including the updates to TD",
                                &lt;span class=
"hljs-attr"&gt;"properties": {
                                    &lt;span class=
"hljs-attr"&gt;"td_id": {
                                        &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"string",
                                        &lt;span class=
"hljs-attr"&gt;"format": &lt;span class=
"hljs-string"&gt;"iri-reference",
                                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"Identifier of TD in directory"
                                    },
                                    &lt;span class=
"hljs-attr"&gt;"td_updates": {
                                        &lt;span class=
"hljs-attr"&gt;"type": &lt;span class=
"hljs-string"&gt;"object",
                                        &lt;span class=
"hljs-attr"&gt;"description": &lt;span class=
"hljs-string"&gt;"The partial TD composed of modified TD parts in an update event"
                                    }
                                }
                            }
                        ]
                    },
                    &lt;span class=
"hljs-attr"&gt;"scopes": &lt;span class=
"hljs-string"&gt;"notifications"
                }
            ]
        }
    }
}
</del>
<bdi class="secno">
<ins class="diff-chg">7.1.2
</ins></bdi><ins class="diff-chg">
Security
Bootstrapping
</ins></a>,<ins class="diff-chg">
this
is
the
first
step
in
authentication
negotiation,
needed
to
bootstrap
secure
access
to
TDs.
Information
on
what
credentials
are
required
will
be
included
in
a
</ins><code><ins class="diff-chg">
WWW-Authenticate
</ins>
</code>
<ins class="diff-new">header.
</ins></li><li><ins class="diff-new">
403
(Forbidden):
Insufficient
rights
to
access
the
resource.
</ins></li><li><ins class="diff-new">
404
(Not
Found):
TD
or
endpoint
does
not
exist.
This
is
accompanied
by
an
appropriate
response
message.
</ins></li></ul><p>
<del class="diff-old">Editor's
note
:
Normative
JSON
Block
Need
</del>
<span class="rfc2119-assertion" id="tdd-http-head">
<ins class="diff-chg">For
each
HTTP
endpoint
that
responds
</ins>
to
<del class="diff-old">add
a
css
class
for
normative
code
blocks,
instead
of
using
</del>
the
<code>
<del class="diff-old">example
</del>
<ins class="diff-chg">GET
</ins>
</code>
<del class="diff-old">class.
Editor's
note
:
ID
Type
The
</del>
<ins class="diff-chg">method,
the
server
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
accept
</ins>
<code>
<del class="diff-old">id
</del>
<ins class="diff-chg">HEAD
</ins>
</code>
<del class="diff-old">variable
need
</del>
<ins class="diff-chg">requests
and
return
only
the
headers.
</ins></span><ins class="diff-chg">
This
allows
clients
</ins>
to
<del class="diff-old">have
</del>
<ins class="diff-chg">retrieve
headers
such
as
the
Content-Length
without
receiving
the
body
and
decide
on
</ins>
a
<del class="diff-old">defined
type
for
semantic
association
with
TD's
id
attribute.
</del>
<ins class="diff-chg">suitable
strategy
to
query
the
information.
For
example,
a
constrained
client
can
request
only
the
necessary
parts
of
an
object
(using
an
appropriate
search
query)
or
retrieve
a
list
of
items
in
small
subsets.
</ins>
</p>
<del class="diff-old">Editor's
note
:
Scopes
The
scopes
</del>
<p>
<ins class="diff-chg">In
constrained
environments,
a
single
TD
</ins>
may
<del class="diff-old">need
to
</del>
be
<del class="diff-old">more
concrete
</del>
<ins class="diff-chg">too
large
</ins>
to
<del class="diff-old">able
</del>
<ins class="diff-chg">process
for
the
server
or
clients.
This
affects
both
read
(i.e.
retrieving
one
or
more
TDs
or
TD
fragments)
and
write
(i.e.
submitting
a
TD
or
Partial
TD)
operations.
See
</ins><a href= "#perf-incremental-transfer" data-matched-text= "[[[#perf-incremental-transfer]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-chg">
10.1
</ins></bdi><ins class="diff-chg">
Incremental
Transfer
</ins></a><ins class="diff-chg">
for
protocol-specific
recommendations
on
incremental
transfer
of
the
payloads.
</ins></p><p><ins class="diff-chg">
The
directory
APIs
include
mandatory,
recommended,
and
optional
features.
Directories
that
don't
offer
recommended
or
optional
features
inform
the
clients
about
the
absence
of
those
features
according
</ins>
to
<del class="diff-old">allow
updates
but
prevent
creation.
</del>
<ins class="diff-chg">the
following
rules:
</ins>
</p>
<ul>
<li>
<ins class="diff-chg">If
the
missing
feature
is
to
customize
existing
functionality
of
an
API,
the
server
will
respond
with
501
(Not
Implemented)
HTTP
status.
For
example,
if
a
client
requests
a
list
of
items
with
a
particular
sorting
order,
the
server
either
respects
that
request
and
returns
the
list
with
the
requested
order,
or
rejects
the
request
and
does
not
return
the
list.
The
server
will
return
the
list
with
the
default
order
if
and
only
if
custom
sorting
is
not
requested.
The
normative
behavior
is
prescribed
in
the
respective
sections.
</ins></li><li>
<del class="diff-old">Issue
82
</del>
<span class="rfc2119-assertion" id= "tdd-http-missing-api-endpoint">
<ins class="diff-chg">If
an
API
endpoint
is
not
provided,
the
server
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
respond
with
404
(Not
Found).
</ins>
</span>
</li>
</ul>
<p>
<del class="diff-old">:
Creation
of
OpenAPI
spec
from
</del>
<span class="rfc2119-assertion" id= "tdd-http-alternate-language">
<ins class="diff-chg">A
</ins>
Directory
<del class="diff-old">TD
</del>
<ins class="diff-chg">server
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
provide
modified
TDs
or
error
responses
using
a
different
default
language
after
server-driven
content
negotiation,
that
is
by
honouring
the
request's
Accept-Language
header.
</ins>
</span>
<del class="diff-old">Need
to
confirm
if
equivalent
OpenAPI
spec
can
be
easily
created
out
</del>
<ins class="diff-chg">The
process
</ins>
of
<ins class="diff-new">modifying
</ins>
the
<ins class="diff-new">default
language
of
a
</ins>
TD
<ins class="diff-new">using
translations
already
provided
</ins>
in
<del class="diff-old">Example
3
.
If
yes,
</del>
a
<del class="diff-old">sentence
may
be
added
indicating
this
possibility.
</del>
<ins class="diff-chg">TD
is
described
in
the
WoT
Thing
Description
1.1
specification
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1"><ins class="diff-chg">
wot-thing-description11
</ins></a></cite><ins class="diff-chg">
].
</ins>
</p>
<section id="exploration-directory-api-things" class="normative">
<div class="header-wrapper">
<h5 id="x7-3-2-1-things-api">
<bdi class="secno">
<del class="diff-old">6.2.2.1
</del>
<ins class="diff-chg">7.3.2.1
</ins>
</bdi>
<del class="diff-old">Registration
</del>
<ins class="diff-chg">Things
API
</ins></h5><a class="self-link" href="#exploration-directory-api-things" aria-label="Permalink for Section 7.3.2.1">
</a>
</div>
<p>
The
<del class="diff-old">Registration
</del>
<ins class="diff-chg">Things
</ins>
API
is
a
RESTful
HTTP
API
<ins class="diff-new">served
at
the
</ins><code><ins class="diff-new">
/things
</ins></code><ins class="diff-new">
endpoint
providing
interfaces
to
create,
retrieve,
update,
delete,
and
list
(CRUDL)
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-35"><ins class="diff-new">
TDs
</ins></a>.<ins class="diff-new">
The
design
of
this
API
is
</ins>
in
accordance
with
<del class="diff-old">the
recommendations
defined
in
</del>
[
<cite>
<a class= "bibref" data-link-type="biblio" href="#bib-rfc7231" title= "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">
RFC7231
</a>
</cite>
]
and
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rest-iot" title= "RESTful Design for Internet of Things Systems">
REST-IOT
</a>
</cite>
].
</p>
<p>
<ins class="diff-chg">The
HTTP
API
follows
these
general
rules:
</ins></p><ul><li><span class="rfc2119-assertion" id="tdd-things-list-only"><ins class="diff-chg">
The
API
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
provide
the
interface
to
list
TDs.
</ins></span><ins class="diff-chg">
The
Search
API
allows
filtering
and
selection
from
this
list;
see
</ins><a href="#exploration-directory-api-search" data-matched-text="[[[#exploration-directory-api-search]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.2.3
</ins></bdi><ins class="diff-chg">
Search
API
</ins></a>.</li><li><span class="rfc2119-assertion" id="tdd-things-crud"><ins class="diff-chg">
The
API
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
provide
the
interfaces
to
create,
read,
update,
and
delete
(CRUD)
individual
TDs.
</ins></span></li><li><ins class="diff-chg">
A
directory
that
provides
both
read
and
write
over
HTTP
is
considered
a
full
HTTP
directory.
</ins><span class="rfc2119-assertion" id="tdd-things-crudl"><ins class="diff-chg">
Full
HTTP
directories
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
implement
all
of
CRUDL
(create,
read,
update,
delete,
and
list)
interfaces.
</ins></span><ins class="diff-chg">
It
is
practical
to
implement
only
the
interfaces
to
read
and
list
if
the
directory
serves
a
static
collection
of
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-36"><ins class="diff-chg">
TDs
</ins></a>.<ins class="diff-chg">
This
is
also
useful
for
directories
that
intend
to
expose
only
retrieval
operations
over
HTTP,
and
perform
other
operations
via
out-of-band
mechanisms.
</ins><span class="rfc2119-assertion" id= "tdd-things-read-only-auth"><ins class="diff-chg">
To
expose
read-only
access,
the
directory
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
enforce
access
control
on
create,
update,
and
delete
interfaces.
</ins></span></li><li><span class="rfc2119-assertion" id= "tdd-things-default-representation">
The
default
serialization
format
for
all
request
and
<ins class="diff-new">success
</ins>
response
bodies
<em class= "rfc2119">
MUST
</em>
be
JSON,
with
JSON-LD
1.1
[
<cite>
<a class= "bibref" data-link-type="biblio" href="#bib-json-ld11" title= "JSON-LD 1.1">
JSON-LD11
</a>
</cite>
]
syntax
to
support
extensions
and
semantic
processing.
</span>
</li>
<li>
<span class="rfc2119-assertion" id= "tdd-things-representation-alternate-input">
Directories
<em class= "rfc2119">
MAY
</em>
accept
<del class="diff-old">additional
</del>
<ins class="diff-chg">alternative
</ins>
representations
based
on
request's
indicated
Content-Type
or
<del class="diff-old">Content-Encoding,
and
</del>
<ins class="diff-chg">Content-Encoding
headers.
</ins></span><ins class="diff-chg">
This
is
useful
for
applications
that
need
to
</ins>
provide
<del class="diff-old">additional
</del>
representations
<del class="diff-old">through
server-driven
content
negotiation.
</del>
<ins class="diff-chg">other
than
raw
JSON
as
input
to
a
directory.
</ins></li><li>
<del class="diff-old">The
Registration
API
MUST
</del>
<span class="rfc2119-assertion" id= "tdd-http-representation-alternate-output">
<ins class="diff-chg">Directories
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins>
</em>
provide
<del class="diff-old">create,
retrieve,
update,
delete,
</del>
<ins class="diff-chg">alternative
representations
through
server-driven
content
negotiation,
that
is
by
honouring
the
request's
Accept
</ins>
and
<del class="diff-old">listing
(CRUDL)
interfaces.
</del>
<ins class="diff-chg">Accept-Encoding
headers
and
responding
with
the
supported
TD
representation
and
equivalent
Content-Type
and
Content-Encoding
headers.
</ins>
</span>
<ins class="diff-new">This
is
useful
for
applications
that
need
to
retrieve
representations
other
than
raw
JSON
from
a
directory,
such
as
Gzip-compressed
JSON.
</ins></li></ul><p>
The
<ins class="diff-new">CRUDL
</ins>
operations
are
described
<del class="diff-old">below:
</del>
<ins class="diff-chg">in
the
following
sections:
</ins>
</p>
<section id="exploration-directory-api-things-creation" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-1-creation">
<bdi class="secno">
<del class="diff-old">6.2.2.1.1
</del>
<ins class="diff-chg">7.3.2.1.1
</ins>
</bdi>
Creation
</h6>
<a class="self-link" href= "#exploration-directory-api-things-creation" aria-label= "Permalink for Section 7.3.2.1.1">
</a>
</div>
<p>
<del class="diff-old">The
API
MUST
allow
</del>
<ins class="diff-chg">Creation
refers
to
the
</ins>
registration
of
a
<ins class="diff-new">new
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-37">
TD
<del class="diff-old">object
passed
as
request
body.
The
request
SHOULD
contain
application/td+json
Content-Type
header
for
JSON
serialization
of
TD.
</del>
</a>
<ins class="diff-chg">inside
the
directory.
</ins></p><p>
The
TD
object
<del class="diff-old">must
be
</del>
<ins class="diff-chg">is
</ins>
validated
in
accordance
with
<del class="diff-old">§&nbsp;
</del>
<a href= "#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref">
<bdi class="secno">
<del class="diff-old">6.2.2.1.6
</del>
<ins class="diff-chg">7.3.2.1.6
</ins>
</bdi>
Validation
</a>.
<ins class="diff-new">Note
that
a
TD
may
or
may
not
be
generated
by
the
</ins><a href="#dfn-thing" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-thing-3"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
it
describes.
For
brownfield
devices
in
particular
a
separate
</ins><a href="#dfn-wot-discoverer" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-discoverer-2"><ins class="diff-new">
Discoverer
</ins></a><ins class="diff-new">
process
or
service
may
be
required
that
generates
and
registers
a
TD
for
a
</ins><a href= "#dfn-thing" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-thing-4"><ins class="diff-new">
Thing
</ins></a><ins class="diff-new">
on
its
behalf.
</ins>
</p>
<p>
<span class="rfc2119-assertion" id= "tdd-things-create-known-vs-anonymous">
A
TD
which
is
identified
with
an
<code>
id
</code>
attribute
<em class="rfc2119">
MUST
</em>
be
handled
differently
with
one
that
has
no
identifier
(
<a href= "#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-2">
Anonymous
TD
</a>
).
</span>
The
create
operations
are
<del class="diff-old">specified
as
createTD
action
in
Example
3
and
</del>
elaborated
below:
</p>
<ul>
<li>
<span class="rfc2119-assertion" id= "tdd-things-create-known-td">
A
TD
<ins class="diff-new">that
has
an
</ins><code><ins class="diff-new">
id
</ins></code>
<em class="rfc2119">
MUST
</em>
be
submitted
to
the
directory
<del class="diff-old">using
</del>
<ins class="diff-chg">in
the
body
of
</ins>
an
HTTP
<code>
PUT
</code>
request
at
<del class="diff-old">a
target
location
(HTTP
path)
containing
</del>
<code>
<ins class="diff-chg">/things/{id}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
id
</ins></code><ins class="diff-chg">
is
</ins>
the
unique
TD
<ins class="diff-new">identifier,
present
inside
the
TD
object.
</ins></span><ins class="diff-new">
An
</ins><a href="#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-3"><ins class="diff-new">
Anonymous
TD
</ins></a><ins class="diff-new">
is
handled
differently;
see
below.
</ins><span class="rfc2119-assertion" id= "tdd-things-create-known-contenttype"><ins class="diff-new">
The
request
</ins><em class= "rfc2119"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
contain
</ins>
<code>
<del class="diff-old">id
.
</del>
<ins class="diff-chg">application/td+json
</ins></code><ins class="diff-chg">
Content-Type
header
for
JSON
serialization
of
TD.
</ins>
</span>
<ins class="diff-chg">The
TD
object
is
validated
in
accordance
with
</ins><a href= "#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.2.1.6
</ins></bdi><ins class="diff-chg">
Validation
</ins></a>.<span class="rfc2119-assertion" id= "tdd-things-create-known-td-resp">
Upon
successful
processing,
the
server
<em class="rfc2119">
MUST
</em>
respond
with
201
(Created)
status.
</span>
<p>
Note:
If
the
target
location
corresponds
to
an
existing
TD,
the
request
shall
instead
proceed
as
an
Update
operation
and
respond
the
appropriate
status
code
(see
Update
section).
</p>
<p>
<ins class="diff-new">The
create
operation
for
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-38"><ins class="diff-new">
TDs
</ins></a><ins class="diff-new">
that
have
identifiers
is
specified
as
</ins><code><ins class="diff-new">
createThing
</ins></code><ins class="diff-new">
action
in
</ins><a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-new">
7.3.2.4
</ins></bdi><ins class="diff-new">
API
Specification
(Thing
Model)
</ins></a>.</p>
</li>
<li>
<span class="rfc2119-assertion" id= "tdd-things-create-anonymous-td">
An
<a href= "#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-4">
Anonymous
TD
</a>
<em class="rfc2119">
MUST
</em>
be
submitted
to
the
directory
<del class="diff-old">using
</del>
<ins class="diff-chg">in
the
body
of
</ins>
an
HTTP
<code>
POST
</code>
<del class="diff-old">request.
</del>
<ins class="diff-chg">request
at
</ins><code><ins class="diff-chg">
/things
</ins></code><ins class="diff-chg">
endpoint.
</ins>
</span>
<span class="rfc2119-assertion" id= "tdd-things-create-anonymous-contenttype">
<ins class="diff-chg">The
request
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
contain
</ins><code><ins class="diff-chg">
application/td+json
</ins></code><ins class="diff-chg">
Content-Type
header
for
JSON
serialization
of
TD.
</ins></span><ins class="diff-chg">
The
TD
object
is
validated
in
accordance
with
</ins><a href= "#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.2.1.6
</ins></bdi><ins class="diff-chg">
Validation
</ins></a>.<span class="rfc2119-assertion" id= "tdd-things-create-anonymous-td-resp">
Upon
successful
processing,
the
server
<em class="rfc2119">
MUST
</em>
respond
with
201
(Created)
status
and
a
Location
header
containing
a
system-generated
identifier
for
the
TD.
</span>
The
<del class="diff-old">identifier
SHOULD
be
a
Version
4
UUID
URN
[
</del>
<ins class="diff-chg">scheme
of
the
system-generated
ID
is
described
in
</ins><a href="#exploration-directory-anonymous-td" data-matched-text="[[[#exploration-directory-anonymous-td]]]" class="sec-ref">
<del class="diff-old">RFC4122
</del>
<bdi class="secno">
<ins class="diff-chg">7.3.1.3
</ins></bdi><ins class="diff-chg">
Anonymous
TD
Identifiers
</ins></a>.<p><ins class="diff-chg">
The
create
operation
for
</ins><a href= "#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-5"><ins class="diff-chg">
Anonymous
TDs
</ins>
</a>
<ins class="diff-new">is
specified
as
</ins><code><ins class="diff-new">
createAnonymousThing
</ins></code><ins class="diff-new">
action
in
</ins><a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref">
<del class="diff-old">].
Error
responses:
</del>
<bdi class= "secno">
<ins class="diff-chg">7.3.2.4
</ins></bdi><ins class="diff-chg">
API
Specification
(Thing
Model)
</ins></a>.
</p>
<del class="diff-old">400
(Bad
Request):
Invalid
serialization
or
TD.
This
is
accompanied
by
an
appropriate
response
message.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
</del>
</li>
</ul>
<del class="diff-old">Issue
18
:
Consider
TTL
Use
cases
In
certain
scenarios
(e.g.
automatic
removal
of
obsolete
or
accidental
registrations),
the
registration
may
benefit
from
an
expiration
time.
The
expiration
time
may
be
set
explicitly
or
relative
to
the
registration
time
</del>
<p>
<ins class="diff-chg">A
server
that
supports
expirable
TDs
will
realize
such
functionality
</ins>
as
<del class="diff-old">a
time-to-live
(TTL)
value.
Issue
48
:
How
to
avoid
duplicates
</del>
<ins class="diff-chg">described
</ins>
in
<del class="diff-old">a
directory
</del>
<a href= "#exploration-directory-registration-expiry" data-matched-text= "[[[#exploration-directory-registration-expiry]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-chg">7.3.1.2
</ins></bdi>
Registration
<del class="diff-old">of
TDs
using
non-idempotent
HTTP
POST
method
enables
creation
of
anonymous
TDs
(TDs
without
</del>
<ins class="diff-chg">Expiry
</ins></a>.<ins class="diff-chg">
In
particular,
if
</ins>
<code>
<del class="diff-old">id
</del>
<ins class="diff-chg">ttl
</ins>
</code>
<del class="diff-old">attribute).
The
producer
can
distinguish
between
the
created
TDs
using
the
unique-system
generated
IDs
</del>
<ins class="diff-chg">(relative
expiry)
is
</ins>
given
<del class="diff-old">in
</del>
<ins class="diff-chg">during
</ins>
the
<del class="diff-old">response
Location
header.
A
side-effect
of
this
is
that
clients
</del>
<ins class="diff-chg">creation,
such
servers
</ins>
will
<del class="diff-old">be
able
to
register
duplicate
TDs
accidentally
or
on
purpose.
Need
to
clarify:
What
are
</del>
<ins class="diff-chg">calculate
and
store
</ins>
the
<del class="diff-old">use
cases
where
a
duplicate
TD
is
desired?
How
can
we
mitigate
accidental
duplicates
(deduplication)?
</del>
<code>
<ins class="diff-chg">expires
</ins></code><ins class="diff-chg">
value.
</ins></p>
</section>
<section id="exploration-directory-api-things-retrieval" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-2-retrieval">
<bdi class="secno">
<del class="diff-old">6.2.2.1.2
</del>
<ins class="diff-chg">7.3.2.1.2
</ins>
</bdi>
Retrieval
</h6>
<a class="self-link" href= "#exploration-directory-api-things-retrieval" aria-label= "Permalink for Section 7.3.2.1.2">
</a>
</div>
<p>
<del class="diff-old">A
</del>
<span class="rfc2119-assertion" id="tdd-things-retrieve">
<ins class="diff-chg">The
retrieval
of
an
existing
</ins>
TD
<em class="rfc2119">
MUST
</em>
be
<del class="diff-old">retrieved
from
the
directory
</del>
<ins class="diff-chg">done
</ins>
using
an
HTTP
<code>
GET
</code>
<del class="diff-old">request,
including
the
identifier
of
</del>
<ins class="diff-chg">request
at
</ins><code><ins class="diff-chg">
/things/{id}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
id
</ins></code><ins class="diff-chg">
is
</ins>
the
<ins class="diff-new">unique
</ins>
TD
<del class="diff-old">as
part
of
the
path.
</del>
<ins class="diff-chg">identifier.
</ins>
</span>
<span class="rfc2119-assertion" id="tdd-things-retrieve-resp">
A
successful
response
<em class="rfc2119">
MUST
</em>
have
200
(OK)
<del class="diff-old">status,
contain
application/td+json
Content-Type
header,
</del>
<ins class="diff-chg">status
</ins>
and
the
requested
TD
in
<ins class="diff-new">the
</ins>
body.
</span>
<span class= "rfc2119-assertion" id="tdd-things-retrieve-resp-content-type">
<ins class="diff-new">A
successful
response
with
JSON
serialization
</ins><em class= "rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
contain
</ins><code><ins class="diff-new">
application/json
</ins></code><ins class="diff-new">
or
more
specifically,
</ins><code><ins class="diff-new">
application/td+json
</ins></code><ins class="diff-new">
in
the
Content-Type
header.
</ins></span><ins class="diff-new">
Note
that
the
default
serialization
is
JSON
with
JSON-LD
syntax,
and
alternative
serializations
can
be
negotiated;
see
</ins><a href="#exploration-directory-api-things" data-matched-text= "[[[#exploration-directory-api-things]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-new">
7.3.2.1
</ins></bdi><ins class="diff-new">
Things
API
</ins></a>.</p><p>
The
retrieve
operation
is
specified
as
<code>
<del class="diff-old">retrieveTD
</del>
<ins class="diff-chg">retrieveThing
</ins>
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">action
</ins>
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-new">7.3.2.4
</ins></bdi><ins class="diff-new">
API
Specification
(Thing
Model)
</ins>
</a>.
</p>
<p>
<del class="diff-old">Error
responses:
</del>
<ins class="diff-chg">The
following
is
an
example
of
a
retrieved
TD:
</ins>
</p>
<del class="diff-old">404
(Not
Found):
</del>
<aside class="example" id="example-enriched-td">
<div class="marker">
<a class="self-link" href= "#example-enriched-td">
<ins class="diff-chg">Example
</ins><bdi><ins class="diff-chg">
3
</ins></bdi></a><span class= "example-title">:<ins class="diff-chg">
Example
Enriched
</ins>
TD
<del class="diff-old">with
the
given
id
</del>
</span>
</div>
<pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class=
<ins class="diff-chg">"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
</ins>    <span class="hljs-attr">"id"</span>: <span class=<ins class="diff-chg">
"hljs-string">"urn:example:simple-td"</span>,
</ins>    <span class="hljs-attr">"security"</span>: <span class=<ins class="diff-chg">
"hljs-string">"basic_sc"</span>,
</ins>    <span class="hljs-attr">"securityDefinitions"</span>: {        <span class="hljs-attr">"basic_sc"</span>: {            <span class="hljs-attr">"scheme"</span>: <span class=<ins class="diff-chg">
"hljs-string">"basic"</span>
        }
    },
</ins>    <span class="hljs-attr">"registration"</span>: {        <span class="hljs-attr">"created"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-01-19T17:02:00Z"</span>,
</ins>        <span class="hljs-attr">"modified"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-01-19T17:02:00Z"</span>
    },
</ins>    <span class="hljs-attr">"title"</span>: <span class=<ins class="diff-chg">
"hljs-string">"Simple TD"</span>
}
</ins>
</code>
<del class="diff-old">not
found.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
</del>
<del class="diff-old">Editor's
note
</del>
</pre>
<div class="issue" id="issue-container-number-148-2">
<div role="heading" class="issue-title marker" id="h-issue-3" aria-level="7">
<a href= "https://github.com/w3c/wot-discovery/issues/148">
<span class= "issue-number">
<ins class="diff-chg">Issue
148
</ins>
</span>
<del class="diff-old">:
Registration
Info
query
argument
</del>
</a>
<span class="issue-label">:
<ins class="diff-chg">Discovery
context
and
namespace
under
w3.org/ns
</ins>
</span>
</div>
<del class="diff-old">Need
to
specify
</del>
<div class="">
<ins class="diff-chg">The
context
URIs
are
tentative
</ins>
and
<del class="diff-old">describe
the
query
argument
</del>
<ins class="diff-chg">subject
</ins>
to
<del class="diff-old">toggle
enrichment
of
</del>
<ins class="diff-chg">change.
</ins></div></div></aside><p><ins class="diff-chg">
This
is
an
</ins><a href="#dfn-wot-enriched-thing-description" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-4"><ins class="diff-chg">
Enriched
</ins>
TD
<del class="diff-old">with
</del>
</a>
<ins class="diff-chg">which
includes
the
</ins>
registration
<del class="diff-old">info.
</del>
<ins class="diff-chg">information
such
as
the
creation
and
modification
time
of
the
TD
within
the
directory.
</ins></p><p><ins class="diff-chg">
The
example
below
shows
a
retrieved
</ins><a href= "#dfn-wot-anonymous-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-anonymous-thing-description-6"><ins class="diff-chg">
Anonymous
TD
</ins></a><ins class="diff-chg">
that
is
in
</ins><a href="#dfn-wot-enriched-thing-description" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-5"><ins class="diff-chg">
Enriched
TD
</ins></a><ins class="diff-chg">
form
and
has
local
identifier
</ins><code><ins class="diff-chg">
urn:uuid:48951ff3-4019-4e67-b217-dbbf011873dc
</ins></code>.
</p>
<aside class="example" id="example-anonymous-enriched-td">
<div class="marker">
<a class="self-link" href= "#example-anonymous-enriched-td">
<ins class="diff-new">Example
</ins><bdi><ins class="diff-new">
4
</ins></bdi></a><span class="example-title">:<ins class="diff-new">
Example
Enriched
Anonymous
TD
</ins></span></div><pre aria-busy="false"><code class="hljs json">{    <span class="hljs-attr">"@context"</span>: [        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,        <span class=<ins class="diff-new">
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
</ins>    <span class="hljs-attr">"id"</span>: <span class=<ins class="diff-new">
"hljs-string">"urn:uuid:48951ff3-4019-4e67-b217-dbbf011873dc"</span>,
</ins>    <span class="hljs-attr">"security"</span>: <span class=<ins class="diff-new">
"hljs-string">"basic_sc"</span>,
</ins>    <span class="hljs-attr">"securityDefinitions"</span>: {        <span class="hljs-attr">"basic_sc"</span>: {            <span class="hljs-attr">"scheme"</span>: <span class=<ins class="diff-new">
"hljs-string">"basic"</span>
        }
    },
</ins>    <span class="hljs-attr">"registration"</span>: {        <span class="hljs-attr">"created"</span>: <span class=<ins class="diff-new">
"hljs-string">"2021-01-19T17:02:00Z"</span>,
</ins>        <span class="hljs-attr">"modified"</span>: <span class=<ins class="diff-new">
"hljs-string">"2021-01-19T17:02:00Z"</span>
    },
</ins>    <span class="hljs-attr">"title"</span>: <span class=<ins class="diff-new">
"hljs-string">"Anonymous TD"</span>
}
</ins></code></pre><div class="issue" id="issue-container-number-148-3"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="7"><a href= "https://github.com/w3c/wot-discovery/issues/148"><span class= "issue-number"><ins class="diff-new">
Issue
148
</ins></span></a><span class="issue-label">:<ins class="diff-new">
Discovery
context
and
namespace
under
w3.org/ns
</ins></span>
</div>
<div class="">
<ins class="diff-new">The
context
URIs
are
tentative
and
subject
to
change.
</ins></div></div></aside><p>
The
following
is
an
example
<del class="diff-old">queried
TD,
enriched
</del>
<ins class="diff-chg">of
a
retrieved
TD
that
was
registered
</ins>
with
<ins class="diff-new">a
relative
expiry
time
of
3600
seconds
(one
hour).
The
server
has
calculated
</ins>
the
<del class="diff-old">registration
info
per
request:
</del>
<ins class="diff-chg">absolute
expiry
time
as
one
hour
after
the
modification
time.
</ins></p><aside class="example" id="example-expirable-enriched-td">
<div class="marker">
<a class="self-link" href= "#example-expirable-enriched-td">
Example
<bdi>
<del class="diff-old">4
</del>
<ins class="diff-chg">5
</ins>
</bdi>
</a>
<span class="example-title">:
Example
<ins class="diff-new">Expirable
Enriched
</ins>
TD
<del class="diff-old">with
Registration
Info
</del>
</span>
</div>
<pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"@context"</span>: [
<del class="diff-old">        &lt;span class=
"hljs-string"&gt;"https://www.w3.org/2019/wot/td/v1",
</del>
        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,
        <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
    <span class="hljs-attr">"id"</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"urn:example:simple-td",
</del>
<ins class="diff-chg">"hljs-string">"urn:example:expirable-td"</span>,
</ins>
    <span class="hljs-attr">"security"</span>: <span class=
"hljs-string">"basic_sc"</span>,
    <span class="hljs-attr">"securityDefinitions"</span>: {
        <span class="hljs-attr">"basic_sc"</span>: {
            <span class="hljs-attr">"scheme"</span>: <span class=
"hljs-string">"basic"</span>
        }
    },
<del class="diff-old">    : {
        : &lt;span class=
"hljs-string"&gt;"2021-01-19T17:02:00Z",
        : &lt;span class=
"hljs-string"&gt;"2021-01-19T17:02:00Z"
</del>
    <span class="hljs-attr">"registration"</span>: {
        <span class="hljs-attr">"created"</span>: <span class=
<ins class="diff-chg">"hljs-string">"2021-05-10T16:00:00Z"</span>,
</ins>        <span class="hljs-attr">"modified"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-05-10T17:00:00Z"</span>,
</ins>        <span class="hljs-attr">"expires"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-05-10T18:00:00Z"</span>,
</ins>        <span class="hljs-attr">"ttl"</span>: <span class=<ins class="diff-chg">
"hljs-number">3600</span>,
</ins>        <span class="hljs-attr">"retrieved"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-05-10T17:35:00Z"</span>
</ins>
    },
    <span class="hljs-attr">"title"</span>: <span class=
<del class="diff-old">"hljs-string"&gt;"Simple TD"
</del>
<ins class="diff-chg">"hljs-string">"Expirable TD"</span>
</ins>
}
</code>
</pre>
<div class="issue" id="issue-container-number-148-4">
<div role="heading" class="issue-title marker" id="h-issue-5" aria-level="7">
<a href= "https://github.com/w3c/wot-discovery/issues/148">
<span class= "issue-number">
<ins class="diff-new">Issue
148
</ins></span></a>
<span class="issue-label">:
<ins class="diff-new">Discovery
context
and
namespace
under
w3.org/ns
</ins></span></div><div class=""><ins class="diff-new">
The
context
URIs
are
tentative
and
subject
to
change.
</ins></div></div>
</aside>
<p>
<ins class="diff-new">For
the
sake
of
readability,
the
time
values
in
this
example
are
set
to
exact
numbers.
In
realistic
settings,
time
values
may
include
fractions.
</ins></p>
</section>
<section id="exploration-directory-api-things-update" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-3-update">
<bdi class="secno">
<del class="diff-old">6.2.2.1.3
</del>
<ins class="diff-chg">7.3.2.1.3
</ins>
</bdi>
Update
</h6>
<a class="self-link" href= "#exploration-directory-api-things-update" aria-label= "Permalink for Section 7.3.2.1.3">
</a>
</div>
<p>
The
<del class="diff-old">API
MUST
allow
modifications
</del>
<ins class="diff-chg">update
operations
are
</ins>
to
<ins class="diff-new">replace
or
partially
modify
</ins>
an
existing
<del class="diff-old">TD
as
full
replacement
or
partial
updates.
</del>
<ins class="diff-chg">TD.
</ins></p><p>
The
update
operations
are
described
below:
</p>
<ul>
<li>
<span class="rfc2119-assertion" id="tdd-things-update">
A
modified
TD
<em class="rfc2119">
MUST
</em>
replace
an
existing
one
when
submitted
using
an
HTTP
<code>
PUT
</code>
request
<del class="diff-old">to
</del>
<ins class="diff-chg">at
</ins><code><ins class="diff-chg">
/things/{id}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
id
</ins></code><ins class="diff-chg">
is
</ins>
the
<del class="diff-old">location
corresponding
to
</del>
<ins class="diff-chg">identifier
of
</ins>
the
existing
TD.
</span>
<span class= "rfc2119-assertion" id="tdd-things-update-contenttype">
The
request
<em class="rfc2119">
SHOULD
</em>
contain
<code>
application/td+json
</code>
Content-Type
header
for
JSON
serialization
of
TD.
</span>
The
TD
object
<del class="diff-old">must
be
</del>
<ins class="diff-chg">is
</ins>
validated
in
accordance
with
<del class="diff-old">§&nbsp;
</del>
<a href= "#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref">
<bdi class="secno">
<del class="diff-old">6.2.2.1.6
</del>
<ins class="diff-chg">7.3.2.1.6
</ins>
</bdi>
Validation
</a>.
<span class="rfc2119-assertion" id="tdd-things-update-resp">
Upon
success,
the
server
<em class="rfc2119">
MUST
</em>
respond
with
204
(No
Content)
status.
</span>
<p>
This
operation
is
specified
as
<code>
<del class="diff-old">updateTD
</del>
<ins class="diff-chg">updateThing
</ins>
</code>
property
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref">
<bdi class= "secno">
<ins class="diff-chg">7.3.2.4
</ins>
</bdi>
<ins class="diff-new">API
Specification
(Thing
Model)
</ins></a>.</p><p><ins class="diff-new">
A
server
that
supports
expirable
TDs
will
realize
such
functionality
as
described
in
</ins><a href= "#exploration-directory-registration-expiry" data-matched-text= "[[[#exploration-directory-registration-expiry]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-new">7.3.1.2
</ins></bdi><ins class="diff-new">
Registration
Expiry
</ins>
</a>.
<ins class="diff-new">If
</ins><code><ins class="diff-new">
ttl
</ins></code><ins class="diff-new">
(relative
expiry)
is
set
during
the
update
operation,
the
server
will
calculate
and
set
the
</ins><code><ins class="diff-new">
expires
</ins></code><ins class="diff-new">
(absolute
expiry)
value.
</ins></p>
<p>
Note:
If
the
target
location
does
not
correspond
to
an
existing
TD,
the
request
shall
instead
proceed
as
a
Create
operation
and
respond
the
appropriate
status
code
(see
Create
section).
In
other
words,
an
HTTP
<code>
PUT
</code>
request
acts
as
a
create
or
update
operation.
</p>
</li>
<li>
<span class="rfc2119-assertion" id= "tdd-things-update-partial">
An
existing
TD
<em class= "rfc2119">
MUST
</em>
be
partially
modified
when
the
modified
parts
are
submitted
using
an
HTTP
<code>
PATCH
</code>
request
<del class="diff-old">to
</del>
<ins class="diff-chg">at
</ins><code><ins class="diff-chg">
/things/{id}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
id
</ins></code><ins class="diff-chg">
is
</ins>
the
<del class="diff-old">location
corresponding
to
</del>
<ins class="diff-chg">identifier
of
</ins>
the
existing
TD.
</span>
<span class= "rfc2119-assertion" id="tdd-things-update-partial-mergepatch">
The
partial
update
<em class="rfc2119">
MUST
</em>
be
processed
using
the
JSON
merge
patch
format
<del class="diff-old">format
</del>
described
in
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-rfc7396" title= "JSON Merge Patch">
RFC7396
</a>
</cite>
].
</span>
<span class= "rfc2119-assertion" id="tdd-things-update-partial-contenttype">
The
request
<em class="rfc2119">
MUST
</em>
contain
<code>
application/merge-patch+json
</code>
Content-Type
header
for
JSON
serialization
of
the
merge
patch
document.
</span>
<span class= "rfc2119-assertion" id="tdd-things-update-partial-partialtd">
The
input
<em class="rfc2119">
MUST
</em>
be
in
<a href= "#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-partial-thing-description-1">
Partial
TD
</a>
form
and
conform
to
the
original
TD
structure.
</span>
If
the
input
contains
members
that
appear
in
the
original
TD,
their
values
are
replaced.
If
a
member
<del class="diff-old">do
</del>
<ins class="diff-chg">does
</ins>
not
appear
in
the
original
TD,
that
member
is
added.
If
the
member
is
set
to
<code>
null
</code>
but
appear
in
the
original
TD,
that
member
is
removed.
Members
with
object
values
are
processed
recursively.
After
applying
the
modifications,
the
TD
object
<del class="diff-old">must
be
</del>
<ins class="diff-chg">is
</ins>
validated
in
accordance
with
<del class="diff-old">§&nbsp;
</del>
<a href="#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref">
<bdi class="secno">
<del class="diff-old">6.2.2.1.6
</del>
<ins class="diff-chg">7.3.2.1.6
</ins>
</bdi>
Validation
</a>.
<span class="rfc2119-assertion" id= "tdd-things-update-partial-resp">
Upon
success,
the
server
<em class="rfc2119">
MUST
</em>
respond
with
a
204
(No
Content)
status.
</span>
<p>
This
operation
is
specified
as
<code>
<del class="diff-old">updatePartialTD
</del>
<ins class="diff-chg">partiallyUpdateThing
</ins>
</code>
property
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref">
<bdi class= "secno">
<ins class="diff-new">7.3.2.4
</ins></bdi><ins class="diff-new">
API
Specification
(Thing
Model)
</ins>
</a>.
</p>
<p>
<del class="diff-old">Error
responses:
</del>
<ins class="diff-chg">A
server
that
supports
expirable
TDs
will
realize
such
functionality
as
described
in
</ins><a href= "#exploration-directory-registration-expiry" data-matched-text= "[[[#exploration-directory-registration-expiry]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.1.2
</ins></bdi><ins class="diff-chg">
Registration
Expiry
</ins></a>.<ins class="diff-chg">
During
the
partial
update
operation,
if
the
resulting
</ins><a href= "#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-39"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
has
</ins><code><ins class="diff-chg">
ttl
</ins></code><ins class="diff-chg">
(relative
expiry),
the
server
will
calculate
and
set
a
new
</ins><code><ins class="diff-chg">
expires
</ins></code><ins class="diff-chg">
(absolute
expiry)
value.
</ins>
</p>
<del class="diff-old">400
(Bad
Request):
Invalid
serialization
or
TD.
</del>
<p>
<ins class="diff-chg">A
patch
operation
is
particularly
useful
to
efficiently
extend
the
expiry
of
a
registration
that
uses
a
</ins><code><ins class="diff-chg">
ttl
</ins></code><ins class="diff-chg">
(relative
expiry)
value.
</ins>
This
is
<del class="diff-old">accompanied
</del>
<ins class="diff-chg">typically
done
</ins>
by
<ins class="diff-new">submitting
</ins>
an
<del class="diff-old">appropriate
response
message.
404
(Not
Found):
TD
with
</del>
<ins class="diff-chg">empty
merge
patch
document,
i.e.
an
empty
JSON
object.
This
effectively
translates
to
performing
a
partial
update
operation
that
updates
nothing,
but
triggers
</ins>
the
<del class="diff-old">given
</del>
<ins class="diff-chg">recalculation
of
</ins>
<code>
<del class="diff-old">id
</del>
<ins class="diff-chg">expires
</ins>
</code>
<del class="diff-old">not
found
(for
</del>
<ins class="diff-chg">(absolute
expiry)
value.
This
expiry
functionality
only
works
if
the
server
supports
it
as
defined
in
</ins><a href= "#exploration-directory-registration-expiry" data-matched-text= "[[[#exploration-directory-registration-expiry]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.1.2
</ins></bdi><ins class="diff-chg">
Registration
Expiry
</ins></a>.</p><p><ins class="diff-chg">
The
following
example
is
a
merge
patch
document
to
update
only
the
</ins>
<code>
<del class="diff-old">PATCH
</del>
<ins class="diff-chg">base
</ins>
</code>
<del class="diff-old">only).
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
</del>
<ins class="diff-chg">and
registration
</ins><code><ins class="diff-chg">
expires
</ins></code><ins class="diff-chg">
fields
of
a
TD:
</ins></p><aside class="example" id="example-patch-enriched-td"><div class="marker"><a class="self-link" href= "#example-patch-enriched-td"><ins class="diff-chg">
Example
</ins><bdi><ins class="diff-chg">
6
</ins></bdi></a><span class= "example-title">:<ins class="diff-chg">
Example
merge
patch
document
</ins></span></div><pre aria-busy="false"><code class="hljs json">{    <span class="hljs-attr">"base"</span>: <span class=<ins class="diff-chg">
"hljs-string">"http://192.168.0.2/"</span>,
</ins>    <span class="hljs-attr">"registration"</span>: {        <span class="hljs-attr">"expires"</span>: <span class=<ins class="diff-chg">
"hljs-string">"2021-01-20T17:02:00Z"</span>
    }
}
</ins></code></pre><ins class="diff-chg">
This
is
a
valid
way
of
extending
</ins>
the
<del class="diff-old">resource.
</del>
<ins class="diff-chg">absolute
expiry
only
if
the
stored
TD
has
no
</ins><code><ins class="diff-chg">
ttl
</ins></code><ins class="diff-chg">
(relative
expiry).
For
more
details,
refer
to
</ins><a href= "#exploration-directory-registration-expiry" data-matched-text= "[[[#exploration-directory-registration-expiry]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.1.2
</ins></bdi><ins class="diff-chg">
Registration
Expiry
</ins></a>.</aside>
</li>
</ul>
</section>
<section id="exploration-directory-api-things-deletion" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-4-deletion">
<bdi class="secno">
<del class="diff-old">6.2.2.1.4
</del>
<ins class="diff-chg">7.3.2.1.4
</ins>
</bdi>
Deletion
</h6>
<a class="self-link" href= "#exploration-directory-api-things-deletion" aria-label= "Permalink for Section 7.3.2.1.4">
</a>
</div>
<p>
<span class="rfc2119-assertion" id="tdd-things-delete">
A
<del class="diff-old">TD
</del>
<ins class="diff-chg">delete
operation
</ins>
<em class="rfc2119">
MUST
</em>
be
<del class="diff-old">removed
from
the
directory
when
</del>
<ins class="diff-chg">done
using
</ins>
an
HTTP
<code>
DELETE
</code>
request
<ins class="diff-new">at
</ins><code><ins class="diff-new">
/things/{id}
</ins></code>,<ins class="diff-new">
where
</ins><code><ins class="diff-new">
id
</ins></code>
is
<del class="diff-old">submitted
to
</del>
the
<del class="diff-old">location
corresponding
to
</del>
<ins class="diff-chg">identifier
of
</ins>
the
existing
TD.
</span>
<span class="rfc2119-assertion" id="tdd-things-delete-resp">
A
successful
response
<em class="rfc2119">
MUST
</em>
have
204
(No
Content)
status.
</span>
The
retrieve
operation
is
specified
as
<code>
<del class="diff-old">deleteTD
</del>
<ins class="diff-chg">deleteThing
</ins>
</code>
property
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-new">7.3.2.4
</ins></bdi><ins class="diff-new">
API
Specification
(Thing
Model)
</ins>
</a>.
</p>
<del class="diff-old">Error
responses:
404
(Not
Found):
TD
with
the
given
id
not
found.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
</del>
</section>
<section id="exploration-directory-api-things-listing" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-5-listing">
<bdi class="secno">
<del class="diff-old">6.2.2.1.5
</del>
<ins class="diff-chg">7.3.2.1.5
</ins>
</bdi>
Listing
</h6>
<a class="self-link" href= "#exploration-directory-api-things-listing" aria-label= "Permalink for Section 7.3.2.1.5">
</a>
</div>
<p>
The
listing
endpoint
provides
<del class="diff-old">a
way
</del>
<ins class="diff-chg">different
ways
</ins>
to
query
the
collection
of
<ins class="diff-new">full
</ins>
TD
objects
from
the
directory.
</p>
<p>
<ins class="diff-new">In
many
scenarios,
retrieving
parts
instead
of
full
TD
objects
is
preferred
because
only
a
subset
of
elements
are
needed
(e.g.
</ins><code><ins class="diff-new">
id
</ins></code><ins class="diff-new">
and
</ins><code><ins class="diff-new">
href
</ins></code><ins class="diff-new">
of
a
property
for
all
TDs)
and
to
save
networking
resources.
</ins>
The
Search
API
<del class="diff-old">may
be
used
to
retrieve
Partial
TD
s
or
</del>
<ins class="diff-chg">allows
querying
parts
of
</ins>
TD
<del class="diff-old">fragments;
</del>
<ins class="diff-chg">objects;
</ins>
see
<del class="diff-old">§&nbsp;
</del>
<a href= "#exploration-directory-api-search" data-matched-text= "[[[#exploration-directory-api-search]]]" class= "sec-ref">
<bdi class="secno">
<del class="diff-old">6.2.2.4
</del>
<ins class="diff-chg">7.3.2.3
</ins>
</bdi>
Search
<ins class="diff-new">API
</ins>
</a>.
</p>
<p>
<span class="rfc2119-assertion" id="tdd-things-list-method">
The
<del class="diff-old">list
of
TDs
</del>
<ins class="diff-chg">directory
</ins>
<em class="rfc2119">
MUST
</em>
<del class="diff-old">be
retrieved
from
the
directory
</del>
<ins class="diff-chg">allow
retrieval
of
existing
TDs
</ins>
using
<del class="diff-old">an
</del>
HTTP
<code>
GET
</code>
<del class="diff-old">request.
</del>
<ins class="diff-chg">requests
at
the
</ins><code><ins class="diff-chg">
/things
</ins></code><ins class="diff-chg">
endpoint.
</ins>
</span>
<span class= "rfc2119-assertion" id="tdd-things-list-resp">
A
successful
response
<em class="rfc2119">
MUST
</em>
have
200
(OK)
<del class="diff-old">status,
contain
application/ld+json
Content-Type
header,
</del>
<ins class="diff-chg">status
</ins>
and
an
array
of
TDs
in
the
body.
</span>
<span class="rfc2119-assertion" id= "tdd-things-list-resp-content-type">
<ins class="diff-new">A
successful
response
with
JSON
serialization
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
contain
</ins><code><ins class="diff-new">
application/json
</ins></code><ins class="diff-new">
or
more
specifically,
</ins><code><ins class="diff-new">
application/ld+json
</ins></code><ins class="diff-new">
in
the
Content-Type
header.
</ins></span><ins class="diff-new">
Note
that
the
default
serialization
is
JSON
with
JSON-LD
syntax,
and
alternative
serializations
can
be
negotiated;
see
</ins><a href= "#exploration-directory-api-things" data-matched-text= "[[[#exploration-directory-api-things]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-new">7.3.2.1
</ins></bdi><ins class="diff-new">
Things
API
</ins></a>.
</p>
<p>
<del class="diff-old">Serializing
and
returning
</del>
<ins class="diff-chg">There
may
be
scenarios
in
which
clients
need
to
retrieve
</ins>
the
<del class="diff-old">full
list
</del>
<ins class="diff-chg">collection
in
small
subsets
</ins>
of
<del class="diff-old">TDs
</del>
<ins class="diff-chg">TDs.
While
the
Search
API
(
</ins><a href= "#exploration-directory-api-search" data-matched-text= "[[[#exploration-directory-api-search]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.2.3
</ins></bdi><ins class="diff-chg">
Search
API
</ins></a><ins class="diff-chg">
)
does
offer
the
ability
to
query
a
specific
range,
it
</ins>
may
<ins class="diff-new">not
</ins>
be
<del class="diff-old">burdensome
</del>
<ins class="diff-chg">optimal,
nor
developer-friendly.
</ins><span class="rfc2119-assertion" id= "tdd-things-list-pagination"><ins class="diff-chg">
The
server
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
support
pagination
</ins>
to
<del class="diff-old">servers.
As
such,
servers
should
serialize
incrementally
and
utilize
protocol-specific
mechanisms
</del>
<ins class="diff-chg">return
the
collection
in
small
subsets.
</ins></span><ins class="diff-chg">
The
pagination
must
be
based
on
the
following
rules:
</ins></p><ul><li><span class="rfc2119-assertion" id= "tdd-things-list-pagination-limit"><ins class="diff-chg">
When
the
</ins><code><ins class="diff-chg">
limit
</ins></code><ins class="diff-chg">
query
parameter
is
set
</ins>
to
<ins class="diff-new">a
positive
integer,
the
server
</ins><em class= "rfc2119"><ins class="diff-new">
MAY
</ins></em>
respond
<del class="diff-old">in
chunks.
HTTP/1.1
servers
</del>
<ins class="diff-chg">with
a
subset
of
TDs
totalling
to
less
than
or
equal
to
the
requested
number.
</ins></span></li><li><span class="rfc2119-assertion" id= "tdd-things-list-pagination-header-nextlink"><ins class="diff-chg">
When
there
are
more
TDs
after
a
returned
subset
of
the
collection,
the
response
</ins>
<em class="rfc2119">
<del class="diff-old">SHOULD
</del>
<ins class="diff-chg">MUST
</ins>
</em>
<del class="diff-old">perform
chunked
Transfer-Encoding
</del>
<ins class="diff-chg">contain
a
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
Link
header
</ins>
[
<cite>
<del class="diff-old">RFC7230
</del>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc8288" title="Web Linking">
<ins class="diff-chg">RFC8288
</ins>
</a>
</cite>
]
<ins class="diff-new">with
the
URL
of
the
next
subset.
</ins></span><span class="rfc2119-assertion" id= "tdd-things-list-pagination-header-nextlink-attr"><ins class="diff-new">
The
</ins><code><ins class="diff-new">
next
</ins></code><ins class="diff-new">
link
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
include
all
arguments
needed
</ins>
to
<del class="diff-old">respond
</del>
<ins class="diff-chg">produce
</ins>
the
<ins class="diff-new">same
set
of
</ins>
data
<del class="diff-old">incrementally.
</del>
<ins class="diff-chg">and
its
ordering,
in
particular
the
same
</ins><code><ins class="diff-chg">
limit
</ins></code><ins class="diff-chg">
argument
given
on
the
initial
request
as
well
as
a
zero-based
</ins><code><ins class="diff-chg">
offset
</ins></code><ins class="diff-chg">
argument
anchored
at
the
beginning
of
the
next
subset.
</ins>
</span>
<del class="diff-old">Most
HTTP/1.1
</del>
<span class="rfc2119-assertion" id= "tdd-things-list-pagination-header-nextlink-base">
<ins class="diff-chg">The
link
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
absolute
or
relative
to
directory
API's
base
URL.
</ins></span><ins class="diff-chg">
Moreover,
it
may
include
additional
arguments
that
are
necessary
for
ordering
or
session
management.
</ins></li><li><span class="rfc2119-assertion" id= "tdd-things-list-pagination-header-canonicallink"><ins class="diff-chg">
All
paged
responses
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
contain
a
</ins><code><ins class="diff-chg">
canonical
</ins></code><ins class="diff-chg">
Link
header
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8288" title= "Web Linking"><ins class="diff-chg">
RFC8288
</ins></a></cite><ins class="diff-chg">
]
pointing
to
the
collection
and
include
an
</ins><code><ins class="diff-chg">
etag
</ins></code><ins class="diff-chg">
parameter
to
represent
the
current
state
of
the
collection.
</ins></span><ins class="diff-chg">
The
link
may
be
absolute
or
relative
to
directory
API's
base
URL.
The
</ins><code><ins class="diff-chg">
etag
</ins></code><ins class="diff-chg">
value
could
be
a
revision
number,
timestamp,
or
UUID
Version
4,
set
whenever
the
TD
collection
changes
in
a
way
that
affects
the
ordering
of
the
TDs.
The
</ins>
clients
<del class="diff-old">automatically
process
</del>
<ins class="diff-chg">may
rely
on
</ins>
the
<del class="diff-old">data
received
with
chunked
transfer
encoding.
Memory-constrained
applications
which
require
</del>
<code>
<ins class="diff-chg">etag
</ins></code><ins class="diff-chg">
value
to
know
whether
</ins>
the
<del class="diff-old">full
list
should
consider
processing
</del>
<ins class="diff-chg">collection
remains
consistent
across
paginated
retrieval
of
</ins>
the
<del class="diff-old">received
data
incrementally.
Chunked
transfer
encoding
is
</del>
<ins class="diff-chg">collection.
For
example,
creation
or
deletion
of
TDs
or
update
of
TD
fields
used
for
ordering
may
make
shift
the
calculated
paging
window.
</ins></li><li><span class="rfc2119-assertion" id= "tdd-things-list-pagination-order-default"><ins class="diff-chg">
By
default,
the
collection
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
sorted
using
UTF-8
lexicographical
order
by
the
unique
identifier
of
TDs.
</ins></span><span class="rfc2119-assertion" id= "tdd-things-list-pagination-order"><ins class="diff-chg">
The
server
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
support
sorting
by
other
TD
attributes
using
query
arguments:
</ins><code><ins class="diff-chg">
sort_by
</ins></code><ins class="diff-chg">
to
select
a
field
(e.g.
</ins><code><ins class="diff-chg">
created
</ins></code><ins class="diff-chg">
)
and
</ins><code><ins class="diff-chg">
sort_order
</ins></code><ins class="diff-chg">
to
choose
the
order
(i.e.
</ins><code><ins class="diff-chg">
asc
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
desc
</ins></code><ins class="diff-chg">
for
ascending
and
descending
ordering).
</ins></span><span class="rfc2119-assertion" id= "tdd-things-list-pagination-orderable"><ins class="diff-chg">
A
server
</ins><em class= "rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
reject
requests
to
sort
on
fields
that
do
</ins>
not
<del class="diff-old">supported
in
HTTP/2.
HTTP/2
servers
</del>
<ins class="diff-chg">have
values
that
are
orderable
basic
types,
with
a
400
(Bad
Request)
status.
</ins></span><span class="rfc2119-assertion" id= "tdd-things-list-pagination-order-unsupported"><ins class="diff-chg">
If
the
server
does
not
support
custom
sorting,
it
</ins>
<em class="rfc2119">
<del class="diff-old">SHOULD
</del>
<ins class="diff-chg">MUST
</ins>
</em>
<del class="diff-old">respond
</del>
<ins class="diff-chg">reject
</ins>
the
<del class="diff-old">data
incrementally
</del>
<ins class="diff-chg">request
with
501
(Not
Implemented)
status.
</ins></span><span class= "rfc2119-assertion" id= "tdd-things-list-pagination-order-nextlink"><ins class="diff-chg">
If
sorting
attributes
are
accepted,
they
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
added
consistently
to
all
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
links.
</ins></span><span class= "rfc2119-assertion" id= "tdd-things-list-pagination-order-utf-8"><ins class="diff-chg">
Sorting
order
</ins><em class= "rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
always
be
defined
</ins>
using
<del class="diff-old">HTTP
Frames
</del>
<ins class="diff-chg">lexicographical
ordering
on
a
UTF-8
encoding
of
the
relevant
fields.
</ins></span></li></ul><p><ins class="diff-chg">
This
above
specification
follows
a
subset
of
Linked
Data
Paging
</ins>
[
<cite>
<del class="diff-old">RFC7540
</del>
<a class="bibref" data-link-type="biblio" href= "#bib-ldp-paging" title= "Linked Data Platform Paging 1.0">
<ins class="diff-chg">LDP-Paging
</ins>
</a>
</cite>
<del class="diff-old">].
</del>
<ins class="diff-chg">]
to
allow
optional
pagination
of
the
JSON-LD
array.
Additional
parts
of
Linked
Data
Paging
may
be
implemented
for
examples
to
honour
client's
query
preference
or
to
add
other
link
relations
for
semantic
annotation
and
alternative
navigation
links.
</ins>
</p>
<p>
The
<ins class="diff-new">following
example
provides
a
walk-through
of
the
</ins>
paginated
<ins class="diff-new">retrieval
of
TDs:
</ins></p><aside class="example" id="example-pagination"><div class="marker"><a class="self-link" href= "#example-pagination"><ins class="diff-new">
Example
</ins><bdi><ins class="diff-new">
7
</ins></bdi></a><span class= "example-title">:<ins class="diff-new">
Query
all
TDs
with
page
size
10.
</ins></span></div><ins class="diff-new">
The
client
requests
the
</ins>
list
<del class="diff-old">operation
</del>
<ins class="diff-chg">with
a
</ins><code><ins class="diff-chg">
limit
</ins></code><ins class="diff-chg">
of
10:
</ins><pre aria-busy="false"><code class=<ins class="diff-chg">
"hljs">GET /things?limit=10 HTTP/1.1   
Host:
tdd.example.com
</ins></code></pre><ins class="diff-chg">
Response:
</ins><pre aria-busy="false"><code class="hljs http"><span class=<ins class="diff-chg">
"hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
</ins><span class="hljs-attribute">Content-Type</span><span class=<ins class="diff-chg">
"hljs-punctuation">: </span>application/ld+json
</ins><span class="hljs-attribute">Link</span><span class=<ins class="diff-chg">
"hljs-punctuation">: </span>&lt;/things?offset=10&amp;limit=10&gt;; rel="next"
</ins><span class="hljs-attribute">Link</span><span class=<ins class="diff-chg">
"hljs-punctuation">: </span>&lt;/things&gt;; rel="canonical"; etag="v1"
</ins><span class="css"><span class=<ins class="diff-chg">
"hljs-selector-attr">
[{
TD
},
...9
other
TDs...
]
</ins></span></span></code></pre><ins class="diff-chg">
The
response
includes
two
Link
headers
with
relative
URLs:
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
link
to
query
the
remaining
TDs,
</ins><code><ins class="diff-chg">
canonical
</ins></code><ins class="diff-chg">
link
referencing
the
full
collection
with
</ins><code><ins class="diff-chg">
etag
</ins></code><ins class="diff-chg">
value
indicating
the
state
of
that
collection.
</ins><br /><ins class="diff-chg">
The
response
body
</ins>
is
<del class="diff-old">specified
</del>
<ins class="diff-chg">an
array
of
10
TDs.
</ins><br /><br /><ins class="diff-chg">
The
presence
of
the
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
link
implies
that
subsequent
pages
should
be
queried
for
the
remaining
TDs.
The
client
requests
the
next
page
via
the
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
link:
</ins><pre aria-busy="false"><code class=<ins class="diff-chg">
"hljs">GET /things?offset=10&amp;limit=10 HTTP/1.1   
Host:
tdd.example.com
</ins></code></pre><ins class="diff-chg">
Response:
</ins><pre aria-busy="false"><code class="hljs http"><span class=<ins class="diff-chg">
"hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK
</ins><span class="hljs-attribute">Content-Type</span><span class=<ins class="diff-chg">
"hljs-punctuation">: </span>application/ld+json
</ins><span class="hljs-attribute">Link</span><span class=<ins class="diff-chg">
"hljs-punctuation">: </span>&lt;/things&gt;; rel="canonical"; etag="v1"
</ins><span class="css"><span class=<ins class="diff-chg">
"hljs-selector-attr">
[{
TD
},
{
TD
}]
</ins></span></span></code></pre><ins class="diff-chg">
The
server
response
has
the
remaining
two
TDs.
There
is
no
</ins><code><ins class="diff-chg">
next
</ins></code><ins class="diff-chg">
link,
because
this
is
the
last
page.
The
</ins><code><ins class="diff-chg">
etag
</ins></code><ins class="diff-chg">
value
has
not
changed
implying
that
the
collection
has
remained
consistent
between
the
two
requests.
</ins><br /><br /><ins class="diff-chg">
The
client
has
retrieved
the
whole
collection,
containing
12
TDs.
</ins></aside><p><span class="rfc2119-assertion" id= "tdd-things-list-pagination-collection"><ins class="diff-chg">
As
an
alternative
to
an
array
of
TDs
as
the
body
of
the
response,
the
server
</ins><em class= "rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
send
a
more
verbose
payload
allowing
server-side
information,
such
as
pagination
information,
to
be
included
in
addition
to
the
actual
data.
</ins></span></p><p><ins class="diff-chg">
The
alternative
pagination
format
is
derived
from
</ins><a href= "https://www.hydra-cg.com/spec/latest/core/#advanced-concepts"><ins class="diff-chg">
Hydra
Advanced
Concepts
</ins></a>,<ins class="diff-chg">
more
concretely
the
</ins><a href= "https://www.hydra-cg.com/spec/latest/core/#example-20-a-hydra-partialcollectionview-splits-a-collection-into-multiple-views"><ins class="diff-chg">
Partial
Collection
View
</ins></a>.<ins class="diff-chg">
Adapted
to
our
purposes
and
using
the
</ins><i><ins class="diff-chg">
members
</ins></i><ins class="diff-chg">
field
to
accomodate
the
array
of
TDs,
it
looks
</ins>
as
<ins class="diff-new">follows
for
the
listing
endpoint:
</ins></p><aside class="example" id="example-alternative-payload"><div class="marker"><a class="self-link" href= "#example-alternative-payload"><ins class="diff-new">
Example
</ins><bdi><ins class="diff-new">
8
</ins></bdi></a><span class= "example-title">:<ins class="diff-new">
Alternative
payload
format
including
pagination
information
</ins></span></div><pre aria-busy="false"><code class="hljs javascript">{        <span class="hljs-string">"@context"</span>: <span class=<ins class="diff-new">
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>,
</ins>        <span class="hljs-string">"@type"</span>: <span class=<ins class="diff-new">
"hljs-string">"ThingCollection"</span>,
</ins>        <span class="hljs-string">"total"</span>: <span class=<ins class="diff-new">
"hljs-number">12</span>,
</ins>        <span class="hljs-string">"members"</span>: [<ins class="diff-new">
                { TD },
</ins>                <span class="hljs-number">9</span> other TDs...<ins class="diff-new">
        ],
</ins>        <span class="hljs-string">"@id"</span>: <span class=<ins class="diff-new">
"hljs-string">"/things?offset=0&amp;limit=10&amp;format=collection"</span>,
</ins>        <span class="hljs-string">"next"</span>: <span class=<ins class="diff-new">
"hljs-string">"/things?offset=10&amp;limit=10&amp;format=collection"</span>
}
</ins></code></pre></aside><p><ins class="diff-new">
To
tell
the
server
which
format
to
send,
the
additional
query
parameter
</ins>
<code>
<del class="diff-old">retrieveTDs
</del>
<ins class="diff-chg">?format=array|collection
</ins>
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">can
be
added
to
the
request.
</ins><code><ins class="diff-chg">
?format=array
</ins></code><ins class="diff-chg">
is
the
default
parameter,
does
not
have
to
be
provided
explicitly,
and
yields
to
a
server
response
of
the
pure
array
of
TDs.
</ins><code><ins class="diff-chg">
?format=collection
</ins></code><ins class="diff-chg">
should
yield
to
a
server
response
with
the
format
as
described
</ins>
in
<a href= "#example-alternative-payload" data-matched-text= "[[[#example-alternative-payload]]]" class="box-ref">
Example
<bdi>
<del class="diff-old">3
</del>
<ins class="diff-chg">8
</ins>
</bdi>
</a>.
</p>
<p>
<del class="diff-old">Error
responses:
</del>
<ins class="diff-chg">The
listing
operation
is
specified
as
</ins><code><ins class="diff-chg">
things
</ins></code><ins class="diff-chg">
property
in
</ins><a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-chg">
7.3.2.4
</ins></bdi><ins class="diff-chg">
API
Specification
(Thing
Model)
</ins></a>.
</p>
<del class="diff-old">401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
</del>
</section>
<section id="exploration-directory-api-things-validation" class= "normative">
<div class="header-wrapper">
<h6 id="x7-3-2-1-6-validation">
<bdi class="secno">
<del class="diff-old">6.2.2.1.6
</del>
<ins class="diff-chg">7.3.2.1.6
</ins>
</bdi>
Validation
</h6>
<a class="self-link" href= "#exploration-directory-api-things-validation" aria-label= "Permalink for Section 7.3.2.1.6">
</a>
</div>
<p>
<span class="rfc2119-assertion" id= "tdd-validation-syntactic">
The
syntactic
validation
of
TD
objects
before
storage
is
<em class="rfc2119">
RECOMMENDED
</em>
to
prevent
common
erroneous
submissions.
</span>
<span class= "rfc2119-assertion" id="tdd-validation-jsonschema">
The
server
<em class="rfc2119">
<del class="diff-old">MAY
</del>
<ins class="diff-chg">SHOULD
</ins>
</em>
use
<ins class="diff-new">at
least
</ins><a href= "https://www.w3.org/TR/wot-thing-description11/#minimal-validation-serialization-json"><ins class="diff-new">
Minimal
Validation
</ins></a><ins class="diff-new">
as
defined
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1"><ins class="diff-new">
wot-thing-description11
</ins></a></cite><ins class="diff-new">
]
to
validate
TDs,
including
use
of
the
</ins>
<a href= "https://www.w3.org/TR/wot-thing-description/#json-schema-for-validation">
<ins class="diff-new">WoT
</ins>
Thing
Description
<ins class="diff-new">(1.0)
</ins>
JSON
Schema
</a>
<del class="diff-old">to
validate
standard
TD
vocabulary,
</del>
or
<del class="diff-old">a
more
comprehensive
</del>
<a href= "https://www.w3.org/TR/wot-thing-description11/#json-schema-for-validation">
<ins class="diff-chg">WoT
Thing
Description
1.1
</ins>
JSON
Schema
<del class="diff-old">to
also
validate
extensions.
</del>
</a>,
<ins class="diff-chg">and
the
JSON
schema
defined
in
</ins><a href="#tdd-extensions-jsonschema" data-matched-text= "[[[#tdd-extensions-jsonschema]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-chg">
A.
</ins></bdi><ins class="diff-chg">
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins></a><ins class="diff-chg">
for
</ins><a href="#dfn-wot-enriched-thing-description" class= "internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-6"><ins class="diff-chg">
Enriched
TDs
</ins></a>,<ins class="diff-chg">
as
appropriate
based
on
the
value
of
the
</ins><code><ins class="diff-chg">
@context
</ins></code>.
</span>
</p>
<p>
<ins class="diff-new">Additional
forms
of
validation
can
be
added
to
support
various
use
cases.
For
example,
a
use
case
may
require
stateful
validation
of
the
input
TDs
to
ensure
that
the
</ins><code><ins class="diff-new">
version
</ins></code><ins class="diff-new">
value
is
initialized
and
updated
according
to
pre-defined
rules.
</ins></p><p>
<span class="rfc2119-assertion" id="tdd-validation-result">
If
the
server
fails
to
validate
the
TD
object,
it
<em class= "rfc2119">
MUST
</em>
inform
the
client
with
necessary
details
to
identify
and
resolve
the
errors.
</span>
<span class= "rfc2119-assertion" id="tdd-validation-response">
The
validation
error
<em class="rfc2119">
MUST
</em>
be
described
as
Problem
Details
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-rfc7807" title= "Problem Details for HTTP APIs">
RFC7807
</a>
</cite>
]
with
an
extension
field
called
<code>
validationErrors
</code>,
set
to
an
array
of
objects
with
<code>
field
</code>
and
<code>
description
</code>
fields.
</span>
This
is
necessary
to
represent
the
error
in
a
machine-readable
way.
<span class= "rfc2119-assertion" id="tdd-validation-response-utf-8">
<ins class="diff-new">All
validation
error
responses
described
using
Problem
Details
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
be
encoded
using
UTF-8.
</ins></span><span class="rfc2119-assertion" id= "tdd-validation-response-lang"><ins class="diff-new">
Validation
error
responses
</ins><em class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
report
details
in
different
languages
using
proactive
negotiation,
if
the
</ins><code><ins class="diff-new">
Accept-Language
</ins></code><ins class="diff-new">
header
field
has
been
set
in
the
HTTP
request
[
</ins><cite><a class= "bibref" data-link-type="biblio" href="#bib-rfc7231" title= "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"><ins class="diff-new">
RFC7231
</ins></a></cite><ins class="diff-new">
].
</ins></span>
</p>
<p>
<a href="#example-validation-error" data-matched-text= "[[[#example-validation-error]]]" class="box-ref">
Example
<bdi>
<del class="diff-old">5
</del>
<ins class="diff-chg">9
</ins>
</bdi>
</a>
is
an
example
error
response
with
two
validation
errors.
</p>
<aside class="example" id="example-validation-error">
<div class="marker">
<a class="self-link" href= "#example-validation-error">
Example
<bdi>
<del class="diff-old">5
</del>
<ins class="diff-chg">9
</ins>
</bdi>
</a>
<span class= "example-title">:
Example
validation
error
response
</span>
</div>
<pre aria-busy="false"><code class="hljs json">{
    <span class="hljs-attr">"title"</span>: <span class=
"hljs-string">"Bad Request"</span>,
    <span class="hljs-attr">"status"</span>: <span class=
"hljs-number">400</span>,
    <span class="hljs-attr">"detail"</span>: <span class=
"hljs-string">"The input did not pass the JSON Schema validation"</span>,
    <span class="hljs-attr">"instance"</span>: <span class=
"hljs-string">"/errors/30585584-cce2-4d04-8079-67b33ffdafbc"</span>,
    <span class="hljs-attr">"validationErrors"</span>: [
        {
            <span class="hljs-attr">"field"</span>: <span class=
"hljs-string">"(root)"</span>,
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"security is required"</span>
        },
        {
            <span class="hljs-attr">"field"</span>: <span class=
"hljs-string">"properties.status.forms.0.href"</span>,
            <span class=
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid type. Expected: string, given: integer"</span>
        }
    ]
}
</code>
</pre>
<del class="diff-old">Editor's
note
:
Validation
error
type
This
example
skips
the
type
field
due
to
the
current
lack
of
specific
error
types.
See
notes
in
§&nbsp;
6.2.2
Directory
Service
API
.
</del>
</aside>
<div class="issue closed" id="issue-container-number-99">
<div role="heading" class="issue-title marker" id="h-issue-6" aria-level="7">
<a href= "https://github.com/w3c/wot-discovery/issues/99">
<span class= "issue-number">
Issue
99
</span>
</a>
<span class="issue-label">:
Define
requirements
and
add
section
for
validation
</span>
</div>
<p dir="auto">
How
much
validation
does
a
directory
need
to
do?
</p>
<ol dir="auto">
<li>
If
it
only
supports
syntactic
queries,
is
JSONSchema
validation
sufficient?
Do
we
also
use
SHACL?
</li>
<li>
If
we
support
SPARQL,
do
we
need
to
do
more
to
make
sure
the
ontologies
used
are
correct?
</li>
<li>
Is
there
a
subset
of
TD
assertions
we
should
check?
</li>
</ol>
</div>
</section>
</section>
<del class="diff-old">6.2.2.2
Management
Editor's
note
:
Management
API
To
do:
Other
administrative
functions
not
having
to
do
with
CRUD
of
individual
records,
for
example,
security
configuration.
Also,
administrator
roles
may
expand
the
capabilities
of
administrators
for
management
of
records
(for
instance,
the
ability
to
delete
a
record
they
did
not
create).
</del>
<section id="exploration-directory-api-notification" class= "normative">
<div class="header-wrapper">
<h5 id="x7-3-2-2-events-api">
<bdi class="secno">
<del class="diff-old">6.2.2.3
</del>
<ins class="diff-chg">7.3.2.2
</ins>
</bdi>
<del class="diff-old">Notification
Editor's
note
:
Notification
API
Changes
The
query
and
payload
specification
are
subject
to
change
for
simplification
and
consistency
with
other
</del>
<ins class="diff-chg">Events
</ins>
API
<del class="diff-old">features
(e.g.
Anonymous
TD,
partial
TD
format
[
</del>
</h5>
<a class="self-link" href="#exploration-directory-api-notification" aria-label="Permalink for Section 7.3.2.2">
<del class="diff-old">RFC7396
</del>
</a>
<del class="diff-old">]).
</del>
</div>
<p>
The
Notification
API
is
to
notify
clients
about
the
changes
to
<del class="diff-old">Thing
Descriptions
</del>
<a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-40">
<ins class="diff-chg">TDs
</ins></a>
maintained
within
the
directory.
<span class="rfc2119-assertion" id="tdd-notification">
<ins class="diff-chg">Directories
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
implement
the
Notification
API.
</ins></span></p><p><span class="rfc2119-assertion" id="tdd-notification-sse">
The
Notification
API
<em class="rfc2119">
MUST
</em>
follow
the
Server-Sent
Events
<ins class="diff-new">(SSE)
</ins>
[
<cite>
<a class="bibref" data-link-type= "biblio" href="#bib-eventsource" title= "Server-Sent Events">
EVENTSOURCE
</a>
</cite>
]
specifications
to
serve
events
to
<del class="diff-old">clients.
</del>
<ins class="diff-chg">clients
at
</ins><code><ins class="diff-chg">
/events
</ins></code><ins class="diff-chg">
endpoint.
</ins>
</span>
In
particular,
the
server
responds
to
successful
requests
with
200
(OK)
status
and
<code>
text/event-stream
</code>
Content
Type.
Re-connecting
clients
may
continue
from
the
last
event
by
providing
the
last
event
ID
as
<code>
Last-Event-ID
</code>
header
value.
<del class="diff-old">This
API
is
specified
</del>
<span class="rfc2119-assertion" id="tdd-notification-event-id">
<ins class="diff-chg">The
server
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
provide
an
event
ID
</ins>
as
<ins class="diff-new">the
</ins>
<code>
<del class="diff-old">registration
</del>
<ins class="diff-chg">id
</ins>
</code>
<del class="diff-old">event
</del>
<ins class="diff-chg">field
</ins>
in
<del class="diff-old">Example
3
</del>
<ins class="diff-chg">each
event
and
respond
to
re-connecting
clients
by
delivering
all
missed
events.
</ins></span>
<del class="diff-old">.
</del>
</p>
<p>
<ins class="diff-chg">The
rest
of
this
section
describes
the
implementation
details
on
top
of
the
SSE
protocol.
Realizing
the
notification
functionality
using
other
protocols
such
as
MQTT
are
possible
and
may
be
formalized
in
future
versions
of
this
specification.
</ins>
</p>
<dl>
<dt>
Event
Types
</dt>
<dd>
<span class="rfc2119-assertion" id= "tdd-notification-event-types">
The
server
<em class= "rfc2119">
MUST
</em>
produce
events
<del class="diff-old">for
creation,
update,
and
deletion
</del>
<ins class="diff-chg">attributed
to
the
lifecycle
</ins>
of
<ins class="diff-new">the
</ins>
Thing
Descriptions
<del class="diff-old">represented
by
</del>
<ins class="diff-chg">within
the
directory
using
</ins>
<code>
<del class="diff-old">created_td
</del>
<ins class="diff-chg">thing_created
</ins>
</code>,
<code>
<del class="diff-old">updated_td
</del>
<ins class="diff-chg">thing_updated
</ins>
</code>,
<ins class="diff-new">and
</ins>
<code>
<del class="diff-old">deleted_td
</del>
<ins class="diff-chg">thing_deleted
</ins>
</code>
<del class="diff-old">keywords
respectively.
</del>
<ins class="diff-chg">event
types.
</ins>
</span>
</dd>
<dt>
Event
Filtering
</dt>
<dd>
The
API
<del class="diff-old">supports
</del>
<ins class="diff-chg">enables
</ins>
server-side
filtering
of
events
to
reduce
resource
consumption
by
delivering
only
the
events
required
by
clients.
<del class="diff-old">The
</del>
<ins class="diff-chg">Client
libraries
may
offer
additional
</ins>
filtering
<del class="diff-old">is
based
</del>
<ins class="diff-chg">capabilities
</ins>
on
<del class="diff-old">query
parameters
passed
to
</del>
the
<del class="diff-old">server
at
connection
time.
The
filtering
behavior
is
described
below:
</del>
<ins class="diff-chg">client-side.
</ins><p>
<span class="rfc2119-assertion" id= "tdd-notification-filter-type">
The
server
<em class= "rfc2119">
MUST
</em>
support
event
filtering
based
on
the
event
<del class="diff-old">types
passed
as
one
or
more
</del>
type
<del class="diff-old">query
parameters.
</del>
<ins class="diff-chg">given
by
the
client
upon
subscription.
</ins>
</span>
</p>
<p>
For
example,
<del class="diff-old">in
response
to
query
</del>
<ins class="diff-chg">given
the
URI
Template
</ins>
<code>
<del class="diff-old">?type=created_td&amp;type=deleted_td
,
</del>
<ins class="diff-chg">/events{/type}
</ins></code>:</p><ul><li><code><ins class="diff-chg">
/events/thing_created
</ins></code><ins class="diff-chg">
instructs
</ins>
the
server
<del class="diff-old">must
</del>
<ins class="diff-chg">to
</ins>
only
deliver
events
of
<del class="diff-old">types
</del>
<ins class="diff-chg">type
</ins>
<code>
<del class="diff-old">created_td
</del>
<ins class="diff-chg">thing_created
</ins>
</code>
<del class="diff-old">and
deleted_td
.
At
the
absence
of
any
</del>
</li>
<li>
<code>
<del class="diff-old">type
</del>
<ins class="diff-chg">/events
</ins>
</code>
<del class="diff-old">query
parameter,
</del>
<ins class="diff-chg">instructs
</ins>
the
server
<del class="diff-old">must
</del>
<ins class="diff-chg">to
</ins>
deliver
all
<del class="diff-old">types
of
events.
</del>
<ins class="diff-chg">events
</ins>
</li>
</ul>
<p>
The
<del class="diff-old">server
MUST
support
event
filtering
based
on
the
Thing
Description
identifier
passed
as
one
or
more
td_id
query
parameters.
For
example,
</del>
<ins class="diff-chg">clients
need
to
subscribe
separately
to
receive
a
subset
of
</ins>
the
<del class="diff-old">query
</del>
<ins class="diff-chg">events
(e.g.
only
</ins>
<code>
<del class="diff-old">?type=updated_td&amp;td_id=urn:example:1234
</del>
<ins class="diff-chg">thing_created
</ins>
</code>
<del class="diff-old">must
result
in
</del>
<ins class="diff-chg">and
</ins>
<code>
<del class="diff-old">updated_td
</del>
<ins class="diff-chg">thing_deleted
</ins>
</code>
<del class="diff-old">events
for
</del>
<ins class="diff-chg">)
from
</ins>
the
<del class="diff-old">TD
identified
with
urn:example:1234
.
The
server
MAY
support
event
filtering
based
</del>
<ins class="diff-chg">server.
When
using
HTTP/2,
multiple
subscriptions
</ins>
on
the
<del class="diff-old">search
expressions
passed
as
one
of
jsonpath
,
xpath
,
or
sparql
query
parameters.
If
the
server
does
not
support
</del>
<ins class="diff-chg">same
domain
(HTTP
streams)
get
multiplexed
on
</ins>
a
<del class="diff-old">given
search
query
parameter,
it
MUST
reject
the
request
with
501
(Not
Implemented)
status.
</del>
<ins class="diff-chg">single
connection.
</ins></p>
</dd>
<dt>
Event
Data
</dt>
<dd>
<p>
<span class="rfc2119-assertion" id="tdd-notification-data">
The
event
data
<em class="rfc2119">
MUST
</em>
contain
the
JSON
serialization
of
the
event
object.
</span>
The
event
data
object
is
<del class="diff-old">defined
by
</del>
<ins class="diff-chg">a
</ins><a href="#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-partial-thing-description-2"><ins class="diff-chg">
Partial
TD
</ins></a><ins class="diff-chg">
or
</ins>
the
<del class="diff-old">following
rules:
</del>
<ins class="diff-chg">whole
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-41"><ins class="diff-chg">
TD
</ins></a><ins class="diff-chg">
object
depending
on
the
request:
</ins></p>
<ul>
<li>
<p>
<span class="rfc2119-assertion" id= "tdd-notification-data-td-id">
The
event
data
object
<em class= "rfc2119">
MUST
</em>
at
least
include
the
identifier
of
the
TD
created,
updated,
or
deleted
at
that
event
<del class="diff-old">as
value
of
td_id
field.
</del>
<ins class="diff-chg">in
</ins><a href= "#dfn-wot-partial-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-partial-thing-description-3"><ins class="diff-chg">
Partial
TD
</ins></a><ins class="diff-chg">
form.
</ins></span></p><aside class="example" id= "example-creation-and-deletion-sse-events-for-a-td"><div class="marker"><a class="self-link" href= "#example-creation-and-deletion-sse-events-for-a-td"><ins class="diff-chg">
Example
</ins><bdi><ins class="diff-chg">
10
</ins></bdi></a><span class="example-title">:<ins class="diff-chg">
Creation
and
deletion
SSE
events
for
a
TD
</ins>
</span>
</div>
<pre aria-busy="false"><code class="hljs css">event: thing_created
<ins class="diff-new">data: {<span class="hljs-string">"id"</span>: <span class=
"hljs-string">"urn:example:simple-td"</span>}
id: event_1
event: thing_deleted
data: {<span class="hljs-string">"id"</span>: <span class=
"hljs-string">"urn:example:simple-td"</span>}
id:
event_2
</ins></code></pre></aside>
</li>
<li>
<p>
<span class="rfc2119-assertion" id= "tdd-notification-data-create-full">
When
<code>
<del class="diff-old">include_changes
</del>
<ins class="diff-chg">diff
</ins>
</code>
query
parameter
is
set
to
<code>
true
<del class="diff-old">,
</del>
</code>
<ins class="diff-chg">and
</ins>
the
<del class="diff-old">create
</del>
event
<del class="diff-old">data
object
</del>
<ins class="diff-chg">has
</ins><code><ins class="diff-chg">
thing_created
</ins></code><ins class="diff-chg">
type,
the
server
</ins><em class= "rfc2119">
MAY
</em>
<del class="diff-old">include
</del>
<ins class="diff-chg">return
</ins>
the
<del class="diff-old">created
</del>
<ins class="diff-chg">whole
</ins>
TD
<ins class="diff-new">object
</ins>
as
<del class="diff-old">the
value
of
created_td
</del>
<ins class="diff-chg">event
data.
</ins></span></p><aside class="example" id="example-create-event-full"><div class="marker"><a class="self-link" href= "#example-create-event-full"><ins class="diff-chg">
Example
</ins><bdi><ins class="diff-chg">
11
</ins></bdi></a><span class= "example-title">:<ins class="diff-chg">
Full
creation
SSE
event
for
a
TD
</ins></span></div><pre aria-busy="false"><code class="hljs css">event: thing_created<ins class="diff-chg">
data: {
data:     <span class="hljs-string">"@context"</span>: [
data:         <span class=
"hljs-string">"https://www.w3.org/2019/wot/td/v1"</span>,
data:         <span class=
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
data:     ],
data:     <span class=
"hljs-string">"description"</span>: <span class=
"hljs-string">"This is a new TD"</span>,
data:     <span class="hljs-string">"id"</span>: <span class=
"hljs-string">"urn:example:simple-td"</span>,
data:     <span class="hljs-string">"security"</span>: <span class=
"hljs-string">"basic_sc"</span>,
data:     <span class="hljs-string">"securityDefinitions"</span>: {
data:         <span class="hljs-string">"basic_sc"</span>: {
data:             <span class=
"hljs-string">"scheme"</span>: <span class=
"hljs-string">"basic"</span>
data:         }
data:     },
data:     <span class="hljs-string">"registration"</span>: {
data:         <span class=
"hljs-string">"created"</span>: <span class=
"hljs-string">"2021-01-19T17:02:00Z"</span>,
data:         <span class=
"hljs-string">"modified"</span>: <span class=
"hljs-string">"2021-01-19T17:02:00Z"</span>
data:     },
data:     <span class="hljs-string">"title"</span>: <span class=
"hljs-string">"Simple TD"</span>
data: }
id:
event_1
</ins>
</code>
<del class="diff-old">field.
</del>
</pre>
<div class="issue" id="issue-container-number-148-5">
<div role="heading" class="issue-title marker" id="h-issue-7" aria-level="6">
<a href= "https://github.com/w3c/wot-discovery/issues/148">
<span class= "issue-number">
<ins class="diff-chg">Issue
148
</ins>
</span>
</a>
<span class="issue-label">:
<ins class="diff-new">Discovery
context
and
namespace
under
w3.org/ns
</ins></span></div><div class=""><ins class="diff-new">
The
context
URIs
are
tentative
and
subject
to
change.
</ins></div></div></aside>
</li>
<li>
<p>
<span class="rfc2119-assertion" id= "tdd-notification-data-update-diff">
When
<code>
<del class="diff-old">include_changes
</del>
<ins class="diff-chg">diff
</ins>
</code>
query
parameter
is
set
to
<code>
true
<del class="diff-old">,
</del>
</code>
<ins class="diff-chg">and
</ins>
the
<del class="diff-old">update
</del>
event
<del class="diff-old">data
object
</del>
<ins class="diff-chg">has
</ins><code><ins class="diff-chg">
thing_updated
</ins></code><ins class="diff-chg">
type,
the
server
</ins><em class= "rfc2119">
MAY
</em>
<del class="diff-old">include
</del>
<ins class="diff-chg">inform
the
client
about
</ins>
the
updated
parts
<ins class="diff-new">following
the
JSON
Merge
Patch
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7396" title= "JSON Merge Patch"><ins class="diff-new">
RFC7396
</ins></a></cite><ins class="diff-new">
]
format.
</ins></span><span class= "rfc2119-assertion" id="tdd-notification-data-update-id"><ins class="diff-new">
A
</ins><code><ins class="diff-new">
thing_updated
</ins></code><ins class="diff-new">
event
data
that
is
based
on
JSON
Merge
Patch
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc7396" title="JSON Merge Patch"><ins class="diff-new">
RFC7396
</ins></a></cite><ins class="diff-new">
]
</ins><em class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
always
include
the
identifier
</ins>
of
the
TD
<del class="diff-old">in
Partial
</del>
<ins class="diff-chg">regardless
of
whether
it
is
changed.
</ins></span></p><p><ins class="diff-chg">
The
following
example
shows
the
event
triggered
on
update
of
the
</ins>
TD
<ins class="diff-new">from
</ins><a href="#example-create-event-full" data-matched-text= "[[[#example-create-event-full]]]" class="box-ref"><ins class="diff-new">
Example
</ins><bdi><ins class="diff-new">
11
</ins></bdi></a>:</p><aside class="example" id="example-update-event-full"><div class="marker"><a class="self-link" href= "#example-update-event-full"><ins class="diff-new">
Example
</ins><bdi><ins class="diff-new">
12
</ins></bdi>
</a>
<del class="diff-old">form
as
</del>
<span class= "example-title">:
<ins class="diff-chg">Full
update
SSE
event
for
a
TD
with
removed
description
and
changed
title
</ins></span></div><pre aria-busy="false"><code class="hljs css">event: thing_updated<ins class="diff-chg">
data: {
data:     <span class="hljs-string">"description"</span>: null,
data:     <span class="hljs-string">"id"</span>: <span class=
"hljs-string">"urn:example:simple-td"</span>,
data:     <span class="hljs-string">"title"</span>: <span class=
"hljs-string">"Updated TD"</span>
data: }
id:
event_3
</ins></code></pre></aside></li><li><p><span class="rfc2119-assertion" id= "tdd-notification-data-delete-diff"><ins class="diff-chg">
The
</ins><code><ins class="diff-chg">
diff
</ins></code><ins class="diff-chg">
query
parameter
</ins><em class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
ignored
for
</ins><code><ins class="diff-chg">
thing_deleted
</ins></code><ins class="diff-chg">
events.
</ins></span><ins class="diff-chg">
In
other
words,
</ins>
the
<del class="diff-old">value
</del>
<ins class="diff-chg">server
shall
not
include
additional
properties
in
the
payload
</ins>
of
<code>
<del class="diff-old">td_updates
</del>
<ins class="diff-chg">thing_deleted
</ins>
</code>
<del class="diff-old">field.
</del>
<ins class="diff-chg">events
when
</ins><code><ins class="diff-chg">
diff
</ins></code><ins class="diff-chg">
is
set
to
</ins><code><ins class="diff-chg">
true
</ins></code>.</p>
</li>
<li>
<p>
<span class="rfc2119-assertion" id= "tdd-notification-data-diff-unsupported">
When
a
server
which
does
not
support
the
<del class="diff-old">inclusion
of
changes
inside
event
data
object
</del>
<code>
<ins class="diff-chg">diff
</ins></code><ins class="diff-chg">
query
parameter
</ins>
is
requested
with
<del class="diff-old">a
include_changes
</del>
<ins class="diff-chg">such
</ins>
query
parameter,
it
<em class="rfc2119">
MUST
</em>
reject
the
request
with
501
(Not
Implemented)
status.
</span>
<ins class="diff-chg">This
is
to
inform
the
clients
about
the
lack
of
such
functionality
at
the
connection
time
to
avoid
runtime
exceptions
caused
by
missing
event
data
attributes.
</ins></p>
</li>
</ul>
</dd>
</dl>
<p>
<ins class="diff-chg">The
Notification
API
is
specified
as
three
event
affordances
in
</ins><a href="#directory-api-spec" data-matched-text= "[[[#directory-api-spec]]]" class="sec-ref"><bdi class= "secno"><ins class="diff-chg">
7.3.2.4
</ins></bdi><ins class="diff-chg">
API
Specification
(Thing
Model)
</ins></a>,<ins class="diff-chg">
namely:
</ins><code><ins class="diff-chg">
thingCreated
</ins></code>,<code><ins class="diff-chg">
thingUpdated
</ins></code>,<ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
thingDeleted
</ins></code>.</p><div class="note" id="issue-container-generatedID-3"><div role="heading" class="ednote-title marker" id="h-ednote-3" aria-level="6">
<span>
Editor's
note
</span>
<span class= "issue-label">:
SSE
Authorization
Header
</span>
</div>
<p class="">
Some
early
SSE
implementations
(including
HTML5
EventSource)
do
not
allow
setting
custom
headers
in
the
initial
HTTP
request.
Authorization
header
is
required
in
few
OAuth2
flows
and
passing
it
as
a
query
parameter
is
<a href= "https://tools.ietf.org/html/rfc6750#section-2.3">
not
advised
</a>.
There
are
polyfills
for
browsers
and
modern
libraries
which
allow
setting
Authorization
header.
</p>
</div>
</section>
<section id="exploration-directory-api-search" class="normative">
<div class="header-wrapper">
<h5 id="x7-3-2-3-search-api">
<bdi class="secno">
<del class="diff-old">6.2.2.4
</del>
<ins class="diff-chg">7.3.2.3
</ins>
</bdi>
Search
<ins class="diff-chg">API
</ins></h5><a class="self-link" href="#exploration-directory-api-search" aria-label="Permalink for Section 7.3.2.3">
</a>
</div>
<div class="note" id="issue-container-generatedID-4">
<div role="heading" class="ednote-title marker" id="h-ednote-4" aria-level="6">
<span>
Editor's
note
</span>
<span class= "issue-label">:
Search
API
Overview
</span>
</div>
<p class="">
Sub-API
to
search
a
directory,
e.g.
issue
a
query.
There
are
different
forms
and
levels
of
query
possible,
for
example,
syntactic
(JSONPath,
XPath)
vs.
semantic
(SPARQL),
and
the
more
advanced
query
types
may
not
be
supported
by
all
directories.
So
this
API
will
have
further
subsections,
some
of
which
will
be
optional.
Search
also
includes
a
sub-API
for
managing
listing
the
contents
<del class="diff-old">(eg
</del>
<ins class="diff-chg">(e.g.
</ins>
returned
by
a
query)
including
handling
pagination,
etc.
Note
that
one
special
form
of
query
will
be
able
to
return
everything.
Results
may
be
subject
to
the
requestor's
authorization.
<br />
To
discuss
further:
Federated
queries
to
other
TDDs,
Spatial
and
network-limited
queries,
Links
</p>
</div>
<del class="diff-old">The
Directory
has
</del>
<ins class="diff-chg">This
specification
describes
</ins>
three
search
APIs:
syntactic
search
with
JSONPath
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-jsonpath" title= "JSONPath: Query expressions for JSON">
JSONPATH
</a>
</cite>
<del class="diff-old">]
or
</del>
<ins class="diff-chg">],
syntactic
search
with
</ins>
XPath
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-xpath-31" title= "XML Path Language (XPath) 3.1">
xpath-31
</a>
</cite>
],
and
semantic
search
with
SPARQL
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title= "SPARQL 1.1 Overview">
sparql11-overview
</a>
</cite>
].
<del class="diff-old">The
Directory
MUST
implement
the
syntactic
search
with
JSONPath.
</del>
<span class= "rfc2119-assertion" id="tdd-search-sparql">
The
Directory
<em class= "rfc2119">
<del class="diff-old">SHOULD
</del>
<ins class="diff-chg">MAY
</ins>
</em>
implement
<del class="diff-old">the
syntactic
</del>
<ins class="diff-chg">semantic
</ins>
search
with
<del class="diff-old">XPath.
</del>
<ins class="diff-chg">SPARQL.
</ins>
</span>
<del class="diff-old">The
Directory
</del>
<ins class="diff-chg">JSONPath
and
XPath
are
informative
and
subject
to
change.
</ins><p><span class="rfc2119-assertion" id="tdd-search-large-tdds"><ins class="diff-chg">
It
is
</ins>
<em class="rfc2119">
<del class="diff-old">MAY
</del>
<ins class="diff-chg">RECOMMENDED
</ins>
</em>
<ins class="diff-new">that
directories
</ins>
implement
<del class="diff-old">semantic
</del>
<ins class="diff-chg">a
</ins>
search
<del class="diff-old">with
SPARQL.
</del>
<ins class="diff-chg">API
to
efficiently
serve
</ins><a href="#dfn-td" class= "internalDFN" data-link-type="dfn" id="ref-for-dfn-td-42"><ins class="diff-chg">
TDs
</ins></a><ins class="diff-chg">
based
on
client-specific
queries.
</ins>
</span>
</p>
<section id="jsonpath-semantic" class="informative">
<div class="header-wrapper">
<h6 id="x7-3-2-3-1-syntactic-search-jsonpath">
<bdi class= "secno">
<del class="diff-old">6.2.2.4.1
</del>
<ins class="diff-chg">7.3.2.3.1
</ins>
</bdi>
Syntactic
search:
JSONPath
</h6>
<a class="self-link" href="#jsonpath-semantic" aria-label= "Permalink for Section 7.3.2.3.1">
</a>
<del class="diff-old">The
API
MUST
</del>
</div>
<p>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins>
</em>
</p>
<ins class="diff-new">Support
for
JSONPath
Search
API
is
optional.
If
implemented,
the
JSONPath
API
must
</ins>
allow
searching
TDs
using
an
HTTP
<code>
GET
</code>
<del class="diff-old">request.
</del>
<ins class="diff-chg">request
at
</ins><code><ins class="diff-chg">
/search/jsonpath?query={query}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
query
</ins></code><ins class="diff-chg">
is
the
JSONPath
expression.
</ins>
The
request
<del class="diff-old">MUST
</del>
<ins class="diff-chg">must
</ins>
contain
a
valid
JSONPath
[
<cite>
<a class="bibref" data-link-type= "biblio" href="#bib-jsonpath" title= "JSONPath: Query expressions for JSON">
JSONPATH
</a>
</cite>
]
as
searching
parameter.
A
successful
response
<del class="diff-old">MUST
</del>
<ins class="diff-chg">must
</ins>
have
200
(OK)
status,
contain
<code>
application/json
</code>
<ins class="diff-new">in
the
</ins>
Content-Type
header,
and
<del class="diff-old">in
the
body
</del>
a
set
of
complete
TDs
or
a
set
of
TD
<del class="diff-old">fragments.
</del>
<ins class="diff-chg">fragments
in
the
body.
</ins>
The
syntactic
search
with
JSONPath
is
specified
as
<code>
searchJSONPath
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">action
</ins>
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class= "sec-ref">
<bdi class="secno">
<ins class="diff-new">7.3.2.4
</ins></bdi><ins class="diff-new">
API
Specification
(Thing
Model)
</ins>
</a>.
<del class="diff-old">List
of
errors:
400
(Bad
Request):
JSONPath
expression
not
provided
or
contains
syntax
errors.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
Issue
56
:
Reach
out
to
JSONPath
community
T2TRG
The
standardization
of
JSONPath
expressions
is
in
progress
by
an
independent
working
group.
</del>
</section>
<section id="xpath-semantic" class="informative">
<div class="header-wrapper">
<h6 id="x7-3-2-3-2-syntactic-search-xpath">
<bdi class= "secno">
<del class="diff-old">6.2.2.4.2
</del>
<ins class="diff-chg">7.3.2.3.2
</ins>
</bdi>
Syntactic
search:
XPath
</h6>
<a class="self-link" href="#xpath-semantic" aria-label= "Permalink for Section 7.3.2.3.2">
</a>
<del class="diff-old">The
support
</del>
</div>
<p>
<em>
<ins class="diff-chg">This
section
is
non-normative.
</ins></em></p><ins class="diff-chg">
Support
</ins>
for
XPath
Search
API
is
<del class="diff-old">recommended.
</del>
<ins class="diff-chg">optional.
</ins>
If
implemented,
the
XPath
query
API
<del class="diff-old">MUST
</del>
<ins class="diff-chg">must
</ins>
allow
searching
TDs
using
an
HTTP
<code>
GET
</code>
<del class="diff-old">request.
</del>
<ins class="diff-chg">request
at
</ins><code><ins class="diff-chg">
/search/xpath?query={query}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
query
</ins></code><ins class="diff-chg">
is
the
XPath
expression.
</ins>
The
request
<del class="diff-old">MUST
</del>
<ins class="diff-chg">must
</ins>
contain
a
valid
XPath
<ins class="diff-new">3.1
</ins>
[
<cite>
<a class="bibref" data-link-type= "biblio" href="#bib-xpath-31" title= "XML Path Language (XPath) 3.1">
xpath-31
</a>
</cite>
]
as
search
parameter.
A
successful
response
<del class="diff-old">MUST
</del>
<ins class="diff-chg">must
</ins>
have
200
(OK)
status,
contain
<code>
application/json
</code>
<ins class="diff-new">in
the
</ins>
Content-Type
header,
and
<ins class="diff-new">the
query
response
in
JSON
serialization
</ins>
in
the
<del class="diff-old">body
a
set
of
complete
TDs
or
a
set
of
TD
fragments.
</del>
<ins class="diff-chg">body.
The
data
schema
for
the
response
is
defined
implicitly
by
the
query
and
the
XPath
specification.
</ins>
The
syntactic
search
with
XPath
is
specified
as
<code>
searchXPath
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">action
</ins>
in
<del class="diff-old">Example
3
</del>
<a href="#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class= "sec-ref">
<del class="diff-old">.
List
of
errors:
400
(Bad
Request):
XPath
expression
not
provided
or
contains
syntax
errors.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
501
(Not
Implemented):
XPath
</del>
<bdi class="secno">
<ins class="diff-chg">7.3.2.4
</ins></bdi>
API
<del class="diff-old">not
supported.
</del>
<ins class="diff-chg">Specification
(Thing
Model)
</ins></a>.
</section>
<section id="search-semantic" class="normative">
<div class="header-wrapper">
<h6 id="x7-3-2-3-3-semantic-search-sparql">
<bdi class= "secno">
<del class="diff-old">6.2.2.4.3
</del>
<ins class="diff-chg">7.3.2.3.3
</ins>
</bdi>
Semantic
search:
SPARQL
</h6>
<a class="self-link" href="#search-semantic" aria-label= "Permalink for Section 7.3.2.3.3">
</a>
<del class="diff-old">The
support
</del>
</div>
<ins class="diff-chg">Support
</ins>
for
SPARQL
Search
API
is
optional.
<span class= "rfc2119-assertion" id="tdd-search-sparql-version">
If
implemented,
the
SPARQL
search
API
<em class="rfc2119">
MUST
</em>
allow
searching
TDs
using
the
SPARQL
<ins class="diff-new">1.1
</ins>
protocol
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-sparql11-overview" title= "SPARQL 1.1 Overview">
sparql11-overview
</a>
</cite>
].
</span>
<span class="rfc2119-assertion" id= "tdd-search-sparql-method-get">
The
SPARQL
API
<em class= "rfc2119">
MUST
</em>
accept
queries
using
HTTP
<code>
GET
</code>
<del class="diff-old">requests.
</del>
<ins class="diff-chg">requests
at
</ins><code><ins class="diff-chg">
/search/sparql?query={query}
</ins></code><ins class="diff-chg">
endpoint,
where
</ins><code><ins class="diff-chg">
query
</ins></code><ins class="diff-chg">
is
the
SPARQL
expression.
</ins>
</span>
<span class="rfc2119-assertion" id= "tdd-search-sparql-method-post">
The
support
for
SPARQL
search
using
HTTP
<code>
POST
</code>
method
<ins class="diff-new">at
</ins><code><ins class="diff-new">
/search/sparql
</ins></code><ins class="diff-new">
endpoint
</ins>
is
<em class="rfc2119">
OPTIONAL
</em>.
</span>
<del class="diff-old">UPDATE
queries
are
out
of
the
scope
for
the
API.
</del>
<span class= "rfc2119-assertion" id="tdd-search-sparql-resp-select-ask">
A
successful
<del class="diff-old">response
</del>
<ins class="diff-chg">request
with
a
query
</ins><code><ins class="diff-chg">
SELECT
</ins></code><ins class="diff-chg">
or
</ins><code><ins class="diff-chg">
ASK
</ins></code><em class="rfc2119">
MUST
</em>
<del class="diff-old">have
</del>
<ins class="diff-chg">return
a
response
</ins>
200
(OK)
status,
and
<del class="diff-old">depending
on
the
type
of
query
</del>
contain
<code>
<ins class="diff-new">application/json
</ins></code>
by
default
<del class="diff-old">as
</del>
<ins class="diff-chg">in
the
</ins>
Content-Type
<del class="diff-old">header
application/ld+json
for
</del>
<ins class="diff-chg">header.
</ins></span><span class= "rfc2119-assertion" id= "tdd-search-sparql-resp-describe-construct"><ins class="diff-chg">
A
successful
request
with
a
query
</ins>
<code>
CONSTRUCT
</code>
and
<code>
DESCRIBE
</code>
<del class="diff-old">queries
or
</del>
<em class="rfc2119">
<ins class="diff-chg">MUST
</ins></em><ins class="diff-chg">
return
a
response
200
(OK)
status,
and
contain
</ins>
<code>
<del class="diff-old">application/json
</del>
<ins class="diff-chg">application/ld+json
</ins>
</code>
<del class="diff-old">for
</del>
<ins class="diff-chg">by
default
in
the
Content-Type
header.
</ins></span><span class="rfc2119-assertion" id= "tdd-search-sparql-error"><ins class="diff-chg">
A
request
with
any
query
different
from
</ins>
<code>
SELECT
</code>,
<code>
<ins class="diff-new">ASK
</ins></code>,<code><ins class="diff-new">
CONSTRUCT
</ins>
</code>
or
<code>
<del class="diff-old">ASK
.
The
response
body
</del>
<ins class="diff-chg">DESCRIBE
</ins></code>
<em class="rfc2119">
<del class="diff-old">MAY
</del>
<ins class="diff-chg">MUST
</ins>
</em>
<del class="diff-old">contain
TD
fragments
or
</del>
<ins class="diff-chg">return
</ins>
a
<del class="diff-old">set
of
TDs
depending
on
the
query.
</del>
<ins class="diff-chg">response
400
(Bad
Request).
</ins>
</span>
The
semantic
search
with
SPARQL
is
specified
as
<code>
searchSPARQL
</code>
<del class="diff-old">property
</del>
<ins class="diff-chg">action
</ins>
in
<del class="diff-old">Example
3
</del>
<a href= "#directory-api-spec" data-matched-text="[[[#directory-api-spec]]]" class="sec-ref">
<del class="diff-old">.
List
of
errors:
400
(Bad
Request):
SPARQL
query
not
provided
or
contains
syntax
errors.
401
(Unauthorized):
No
authentication.
403
(Forbidden):
Insufficient
rights
to
the
resource.
501
(Not
Implemented):
SPARQL
</del>
<bdi class="secno">
<ins class="diff-chg">7.3.2.4
</ins></bdi>
API
<del class="diff-old">not
supported.
</del>
<ins class="diff-chg">Specification
(Thing
Model)
</ins></a>.<span class="rfc2119-assertion" id= "tdd-search-sparql-federation">
A
WoT
Thing
Description
Directory
<em class="rfc2119">
MAY
</em>
implement
federation
in
its
SPARQL
query
API.
</span>
<span class="rfc2119-assertion" id= "tdd-search-sparql-federation-version">
If
implemented,
the
SPARQL
API
<em class="rfc2119">
MUST
</em>
implement
the
SPARQL
1.1
Federated
Query
standard
[
<cite>
<a class="bibref" data-link-type= "biblio" href="#bib-sparql11-overview" title= "SPARQL 1.1 Overview">
sparql11-overview
</a>
</cite>
].
</span>
</section>
</section>
<section id="directory-api-spec">
<div class="header-wrapper">
<h5 id="x7-3-2-4-api-specification-thing-model">
<del class="diff-old">6.2.3
</del>
<bdi class= "secno">
<ins class="diff-chg">7.3.2.4
</ins>
</bdi>
<del class="diff-old">Security
and
Privacy
</del>
<ins class="diff-chg">API
Specification
(Thing
Model)
</ins></h5><a class="self-link" href="#directory-api-spec" aria-label= "Permalink for Section 7.3.2.4">
</a>
</div>
<p>
<ins class="diff-chg">A
template
for
the
API
of
Thing
Description
Directories
is
given
here
as
a
</ins><a href="#dfn-thing-model" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-thing-model-1"><ins class="diff-chg">
Thing
Model
</ins></a>.<ins class="diff-chg">
The
Thing
Model
is
normative
(except
where
noted)
but
should
not
be
considered
as
the
sole
reference
to
implement
or
interact
with
a
Thing
Description
Directory.
Please
refer
also
to
the
specifications
given
in
</ins><a href="#exploration-directory-api" data-matched-text="[[[#exploration-directory-api]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-chg">
7.3.2
</ins></bdi><ins class="diff-chg">
Directory
Service
API
</ins></a>.</p><p><ins class="diff-chg">
The
</ins><code><ins class="diff-chg">
searchJSONPath
</ins></code><ins class="diff-chg">
and
</ins><code><ins class="diff-chg">
searchXPath
</ins></code><ins class="diff-chg">
affordances
given
in
this
Thing
Model
are
not
normative
and
are
provided
for
information
only.
</ins></p><pre class="advisement" aria-busy="false"><code class="hljs json">{    <span class="hljs-attr">"@context"</span>: [        <span class="hljs-string">"http://www.w3.org/ns/td"</span>,        <span class=<ins class="diff-chg">
"hljs-string">"https://w3c.github.io/wot-discovery/context/discovery-context.jsonld"</span>
    ],
</ins>    <span class="hljs-attr">"@type"</span>: [        <span class="hljs-string">"tm:ThingModel"</span>,        <span class="hljs-string">"ThingDirectory"</span><ins class="diff-chg">
    ],
</ins>    <span class="hljs-attr">"title"</span>: <span class=<ins class="diff-chg">
"hljs-string">"Thing Description Directory (TDD) Thing Model"</span>,
</ins>    <span class="hljs-attr">"version"</span>: {        <span class="hljs-attr">"model"</span>: <span class=<ins class="diff-chg">
"hljs-string">"1.0.0-beta.2"</span>
    },
</ins>    <span class="hljs-attr">"base"</span>: <span class=<ins class="diff-chg">
"hljs-string">"{{DIRECTORY_BASE_URL}}"</span>,
</ins>    <span class="hljs-attr">"tm:required"</span>: [        <span class="hljs-string">"#/properties/things"</span><ins class="diff-chg">
    ],
</ins>    <span class="hljs-attr">"properties"</span>: {        <span class="hljs-attr">"things"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Retrieve all Thing Descriptions"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"offset"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Number of TDs to skip before the page"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"number"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"default"</span>: <span class="hljs-number">0</span>
                },
</ins>                <span class="hljs-attr">"limit"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Number of TDs in a page"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"number"</span>
                },
</ins>                <span class="hljs-attr">"format"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Payload format"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class="hljs-attr">"enum"</span>: [                        <span class="hljs-string">"array"</span>,                        <span class=<ins class="diff-chg">
"hljs-string">"collection"</span>
                    ],
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"default"</span>: <span class=
"hljs-string">"array"</span>
                },
</ins>                <span class="hljs-attr">"sort_by"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Comparator TD attribute for collection sorting"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"default"</span>: <span class="hljs-string">"id"</span>
                },
</ins>                <span class="hljs-attr">"sort_order"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Sorting order"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class="hljs-attr">"enum"</span>: [                        <span class="hljs-string">"asc"</span>,                        <span class="hljs-string">"desc"</span><ins class="diff-chg">
                    ],
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"default"</span>: <span class=
"hljs-string">"asc"</span>
                }
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things{?offset,limit,format,sort_by,sort_order}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/ld+json"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:headers"</span>: [
                            {
</ins>                                <span class=<ins class="diff-chg">
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Link"</span>
                            }
                        ]
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid query arguments"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        }
    },
</ins>    <span class="hljs-attr">"actions"</span>: {        <span class="hljs-attr">"createThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Create a Thing Description"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"id"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"@type"</span>: <span class=
"hljs-string">"ThingID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
</ins>            <span class="hljs-attr">"input"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema is implied by the content type"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things/{id}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PUT"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">201</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"createAnonymousThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Create an anonymous Thing Description"</span>,
</ins>            <span class="hljs-attr">"input"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema is implied by the content type"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"POST"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response including the system-generated URI"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:headers"</span>: [
                            {
</ins>                                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"System-generated URI"</span>,
</ins>                                <span class=<ins class="diff-chg">
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Location"</span>
                            }
                        ],
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">201</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"retrieveThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Retrieve a Thing Description"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"id"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"@type"</span>: <span class=
"hljs-string">"ThingID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
</ins>            <span class="hljs-attr">"output"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema is implied by the content type"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"safe"</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-attr">"idempotent"</span>: <span class=
"hljs-literal">true</span>,
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things/{id}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"updateThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Update a Thing Description"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"id"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"@type"</span>: <span class=
"hljs-string">"ThingID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
</ins>            <span class="hljs-attr">"input"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema is implied by the content type"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things/{id}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PUT"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/td+json"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"partiallyUpdateThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Partially update a Thing Description"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"id"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"@type"</span>: <span class=
"hljs-string">"ThingID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
</ins>            <span class="hljs-attr">"input"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema is implied by the content type"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things/{id}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"PATCH"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/merge-patch+json"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Invalid serialization or TD"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        },
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"deleteThing"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Delete a Thing Description"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"id"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"@type"</span>: <span class=
"hljs-string">"ThingID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"Thing Description ID"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"format"</span>: <span class=
"hljs-string">"iri-reference"</span>
                }
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/things/{id}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"DELETE"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">204</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"TD with the given id not found"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">404</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"searchJSONPath"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath syntactic search.  This affordance is not normative and is provided for information only."</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"query"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid JSONPath expression"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
</ins>            <span class="hljs-attr">"output"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema depends on the given query"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"safe"</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-attr">"idempotent"</span>: <span class=
"hljs-literal">true</span>,
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/jsonpath?query={query}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"JSONPath expression not provided or contains syntax errors"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"searchXPath"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"XPath syntactic search.  This affordance is not normative and is provided for information only."</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"query"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid XPath expression"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
</ins>            <span class="hljs-attr">"output"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema depends on the given query"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"safe"</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-attr">"idempotent"</span>: <span class=
"hljs-literal">true</span>,
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/xpath?query={query}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"XPath expression not provided or contains syntax errors"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        },
</ins>        <span class="hljs-attr">"searchSPARQL"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"SPARQL semantic search"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"query"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class=
"hljs-string">"A valid SPARQL 1.1. query"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"string"</span>
                }
            },
</ins>            <span class="hljs-attr">"output"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"The schema depends on the given query"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"safe"</span>: <span class=<ins class="diff-chg">
"hljs-literal">true</span>,
</ins>            <span class=<ins class="diff-chg">
"hljs-attr">"idempotent"</span>: <span class=
"hljs-literal">true</span>,
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/sparql?query={query}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"GET"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"SPARQL query not provided or contains syntax errors"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                },
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/search/sparql"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"htv:methodName"</span>: <span class=
"hljs-string">"POST"</span>,
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Success response"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/json"</span>,
</ins>                        <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">200</span>
                    },
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"additionalResponses"</span>: [
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"SPARQL query not provided or contains syntax errors"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"application/problem+json"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:statusCodeValue"</span>: <span class=
"hljs-number">400</span>
                        }
                    ]
                }
            ]
        }
    },
</ins>    <span class="hljs-attr">"events"</span>: {        <span class="hljs-attr">"thingCreated"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Registration of Thing Descriptions inside the directory"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"diff"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Receive the full created TD as event data"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"boolean"</span>
                }
            },
</ins>            <span class="hljs-attr">"data"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class="hljs-string">"Partial/Full TD"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"op"</span>: <span class=
"hljs-string">"subscribeevent"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/events/thing_created{?diff}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"subprotocol"</span>: <span class=
"hljs-string">"sse"</span>,
</ins>                    <span class="hljs-attr">"htv:headers"</span>: [<ins class="diff-chg">
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"ID of the last event for reconnection"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Last-Event-ID"</span>
                        }
                    ],
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        },
</ins>        <span class="hljs-attr">"thingUpdated"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Updates to Thing Descriptions within the directory"</span>,
</ins>            <span class="hljs-attr">"uriVariables"</span>: {                <span class="hljs-attr">"diff"</span>: {                    <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Include TD changes inside event data"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"type"</span>: <span class=
"hljs-string">"boolean"</span>
                }
            },
</ins>            <span class="hljs-attr">"data"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class="hljs-string">"Partial TD"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>,
</ins>                <span class=<ins class="diff-chg">
"hljs-attr">"contentMediaType"</span>: <span class=
"hljs-string">"application/merge-patch+json"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"op"</span>: <span class=
"hljs-string">"subscribeevent"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/events/thing_updated{?diff}"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"subprotocol"</span>: <span class=
"hljs-string">"sse"</span>,
</ins>                    <span class="hljs-attr">"htv:headers"</span>: [<ins class="diff-chg">
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"ID of the last event for reconnection"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Last-Event-ID"</span>
                        }
                    ],
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        },
</ins>        <span class="hljs-attr">"thingDeleted"</span>: {            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"Deletion of Thing Descriptions from the directory"</span>,
</ins>            <span class="hljs-attr">"data"</span>: {                <span class=<ins class="diff-chg">
"hljs-attr">"title"</span>: <span class="hljs-string">"Partial TD"</span>,
</ins>                <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-chg">
"hljs-string">"object"</span>
            },
</ins>            <span class="hljs-attr">"forms"</span>: [<ins class="diff-chg">
                {
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"op"</span>: <span class=
"hljs-string">"subscribeevent"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"href"</span>: <span class=
"hljs-string">"/events/thing_deleted"</span>,
</ins>                    <span class=<ins class="diff-chg">
"hljs-attr">"subprotocol"</span>: <span class=
"hljs-string">"sse"</span>,
</ins>                    <span class="hljs-attr">"htv:headers"</span>: [<ins class="diff-chg">
                        {
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"description"</span>: <span class=
"hljs-string">"ID of the last event for reconnection"</span>,
</ins>                            <span class=<ins class="diff-chg">
"hljs-attr">"htv:fieldName"</span>: <span class=
"hljs-string">"Last-Event-ID"</span>
                        }
                    ],
</ins>                    <span class="hljs-attr">"response"</span>: {                        <span class=<ins class="diff-chg">
"hljs-attr">"contentType"</span>: <span class=
"hljs-string">"text/event-stream"</span>
                    }
                }
            ]
        }
    }
}
</ins></code></pre><div class="note" id="issue-container-generatedID-5"><div role="heading" class="ednote-title marker" id="h-ednote-5" aria-level="6">
<span>
Editor's
note
</span>
<span class= "issue-label">:
<del class="diff-old">Security
Considerations
Overview
</del>
<ins class="diff-chg">Context
URIs
</ins>
</span>
</div>
<p class="">
<del class="diff-old">Minimum
security
</del>
<ins class="diff-chg">The
context
URIs
are
tentative
</ins>
and
<del class="diff-old">privacy
requirements
for
confidentiality,
authentication,
access
control,
etc.
</del>
<ins class="diff-chg">subject
to
change.
</ins>
</p>
</div>
</section>
</section>
</section>
</section>
<section id="security-considerations">
<div class="header-wrapper">
<h2 id="x8-security-considerations">
<del class="diff-old">7.
</del>
<bdi class="secno">
<ins class="diff-chg">8.
</ins>
</bdi>
Security
<ins class="diff-new">Considerations
</ins></h2><a class="self-link" href="#security-considerations" aria-label= "Permalink for Section 8."></a></div><p><ins class="diff-new">
Security
is
a
cross-cutting
issue
that
needs
to
be
considered
in
all
WoT
building
blocks
and
WoT
implementations.
This
chapter
summarizes
some
general
issues
and
guidelines
to
help
preserve
the
security
of
concrete
WoT
discovery
implementations.
For
a
more
detailed
and
complete
analysis
of
both
security
and
privacy
issues,
see
the
</ins><em><ins class="diff-new">
WoT
Security
</ins>
and
Privacy
<del class="diff-old">Considerations
</del>
<ins class="diff-chg">Guidelines
</ins></em><ins class="diff-chg">
specification
[
</ins><cite>
<a class="bibref" data-link-type="biblio" href= "#bib-wot-security" title= "Web of Things (WoT) Security and Privacy Guidelines">
<ins class="diff-new">WOT-SECURITY
</ins>
</a>
</cite>
<ins class="diff-chg">].
WoT
Thing
and
WoT
TDDs
are
also
web
services
and
should
be
implemented
using
best
practices
for
web
services.
In
addition
to
the
specific
security
considerations
below,
the
security
risks
and
mitigations
discussed
in
guides
such
as
the
OWASP
Top
10
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-owasp-top-10" title="OWASP Top Ten"><ins class="diff-chg">
OWASP-Top-10
</ins></a></cite><ins class="diff-chg">
]
should
be
evaluated,
and
if
applicable,
addressed.
</ins></p><section id="security-consideration-dos"><div class="header-wrapper"><h3 id="x8-1-denial-of-service"><bdi class="secno"><ins class="diff-chg">
8.1
</ins></bdi><ins class="diff-chg">
Denial
of
Service
</ins></h3><a class="self-link" href="#security-consideration-dos" aria-label= "Permalink for Section 8.1"></a></div>
<p>
<ins class="diff-new">Certain
functions
of
the
directory
service,
in
particular
search
queries,
may
require
significant
resources
to
execute
and
this
fact
can
be
used
to
launch
denial
of
service
(DoS)
attacks
against
WoT
Thing
Description
Directory
services.
In
such
an
attack
a
WoT
Directory
would
be
overloaded
by
requests
from
the
attacker
and
unable
to
service
other
requests.
</ins></p><dl><dt><ins class="diff-new">
Mitigations:
</ins></dt><dd><ul><li>
<span class="rfc2119-assertion" id="sec-tdd-throttle-queries">
<ins class="diff-chg">A
WoT
Thing
Description
Directory
implementation
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
limit
the
number
of
queries
per
unit
time
from
the
same
requestor.
</ins></span></li><li><span class="rfc2119-assertion" id= "sec-tdd-limit-query-complexity"><ins class="diff-chg">
A
WoT
Thing
Description
Directory
implementation
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
limit
the
complexity
of
queries
(for
example,
the
total
length
of
the
query
expression
or
its
depth).
</ins></span></li><li><span class="rfc2119-assertion" id="sec-tdd-query-watchdog"><ins class="diff-chg">
A
WoT
Thing
Description
Directory
implementation
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
use
a
watchdog
timer
to
abort
queries
that
take
more
than
a
certain
maximum
(implementation-configurable)
amount
of
time.
</ins></span></li></ul></dd></dl></section><section id="security-consideration-amp-ddos"><div class="header-wrapper"><h3 id="x8-2-amplification-and-distributed-denial-of-service"><bdi class="secno"><ins class="diff-chg">
8.2
</ins></bdi><ins class="diff-chg">
Amplification
and
Distributed
Denial
of
Service
</ins></h3><a class="self-link" href="#security-consideration-amp-ddos" aria-label="Permalink for Section 8.2"></a></div><p><ins class="diff-chg">
It
may
also
be
possible
to
use
elements
of
WoT
Discovery
mechanisms
to
launch
distributed
denial
of
service
(DDoS)
attacks
against
other
targets.
In
such
an
attack
the
WoT
Discovery
service
itself
is
not
the
target.
Instead,
an
aspect
of
the
WoT
Discovery
service
would
be
exploited
to
generate
amplified
network
traffic
that
overloads
a
third
party,
the
actual
target.
Such
an
attack
has
two
requirements:
first,
the
ability
to
redirect
traffic
to
a
third
party,
and
second,
an
intermediary
service
that
can
be
exploited
to
amplify
network
traffic
from
the
attacker.
Redirection
of
network
traffic
is
possible
in
some
protocols,
such
as
unsecured
CoAP,
by
modifying
source
information
in
headers.
Amplification
is
possible
by
taking
advantage
of
three
multiplicative
factors:
the
ratio
of
request
to
response
payload
sizes,
use
of
"observe"
in
protocols
like
CoAP
(which
can
give
multiple
results
for
one
request),
and
use
of
multicast
(which
can
allow
multiple
servers
to
respond
to
one
request).
Services
which
do
not
support
authentication
are
ideal
intermediaries
for
such
an
indirect
attack.
Unfortunately,
the
Introduction
mechanisms
for
WoT
Discovery
are
meant
to
provide
open
access
mechanisms
to
initiate
discovery
and
might
be
exploited
for
this
purpose.
</ins></p><dl><dt><ins class="diff-chg">
Mitigations:
</ins></dt><dd><ul><li><span class="rfc2119-assertion" id= "sec-tdd-intro-no-observe"><ins class="diff-chg">
Open
implementations
of
Introduction
mechanisms
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
NOT
</ins></em><ins class="diff-chg">
support
observe
or
similar
extended
result
subprotocols.
</ins></span></li><li><span class="rfc2119-assertion" id= "sec-tdd-intro-no-multicast"><ins class="diff-chg">
Open
implementations
of
Introduction
mechanisms
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
NOT
</ins></em><ins class="diff-chg">
respond
to
multicast
requests
unless
this
is
absolutely
required
by
the
protocol.
</ins></span><span class="rfc2119-assertion" id= "sec-tdd-intro-if-multicast-required"><ins class="diff-chg">
If
support
for
multicast
is
required,
in
the
case
of
CoAP,
the
recommendations
made
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc9175" title= "Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing"><ins class="diff-chg">
RFC9175
</ins></a></cite><ins class="diff-chg">
]
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
applied.
</ins></span><ins class="diff-chg">
Note
however
that
in
the
case
of
discovery
the
number
of
servers
that
might
respond
to
a
multicast
request
will
generally
not
be
known
in
advance,
in
which
case
the
mitigations
proposed
in
[
</ins><cite><a class= "bibref" data-link-type="biblio" href="#bib-rfc9175" title= "Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing"><ins class="diff-chg">
RFC9175
</ins></a></cite><ins class="diff-chg">
]
may
not
be
effective.
</ins></li><li><ins class="diff-chg">
Limit
the
size
of
responses
to
the
minimum.
</ins><span class= "rfc2119-assertion" id="sec-tdd-intro-limit-response-size"><ins class="diff-chg">
The
total
size
of
responses
to
an
Introduction
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
less
than
3x
the
size
of
the
total
size
of
request,
and
this
should
include
any
error
responses.
</ins></span>
This
<del class="diff-old">section
</del>
is
<del class="diff-old">non-normative.
</del>
<ins class="diff-chg">consistent
with
DDOS
mitigations
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9000" title= "QUIC: A UDP-Based Multiplexed and Secure Transport"><ins class="diff-chg">
RFC9000
</ins></a></cite><ins class="diff-chg">
]
(QUIC)
and
HTTP/3.
Here
"total
size"
includes
any
headers
required
by
the
protocol
itself.
</ins></li><li><span class="rfc2119-assertion" id= "sec-tdd-intro-throttling"><ins class="diff-chg">
Introductions
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins>
</em>
<ins class="diff-new">rate-limit
responses
to
any
particular
request
source.
</ins></span>
</li>
<li>
<span class="rfc2119-assertion" id= "sec-tdd-intro-no-ext">
<ins class="diff-chg">Introduction
mechanisms
on
a
segmented
network
behind
a
firewall
(e.g.
a
LAN)
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
NOT
</ins></em><ins class="diff-chg">
respond
to
requests
that
are
(apparently)
from
outside
that
LAN.
</ins></span></li></ul><ins class="diff-chg">
Of
particular
concern
are
Introduction
mechanisms
that
can
return
multiple
results,
such
as
CoRE-RD
and
DID.
It
may
be
necessary
to
use
authentication/authorization
on
such
Introduction
mechanisms
as
well
if
the
other
mitigations
above
are
not
sufficient.
A
recommended
alternative
is
to
move
multiple
results
from
such
Introductions
into
a
WoT
TDD,
which
can
then
be
protected
by
appropriate
authentication
and
authorization
measures.
Then
the
open
Introduction
mechanism
only
has
to
return
one
result,
the
URL
of
the
TDD.
Introduction
mechanisms
that
are
visible
on
the
open
internet
should
be
especially
careful
to
implement
the
above
mitigations,
and
perhaps
avoid
Introduction
mechanisms
that
can
return
multiple
URLs
completely.
</ins></dd></dl></section><section id="security-consideration-lan-self-discovery"><div class="header-wrapper"><h3 id="x8-3-self-discovery-on-lans"><bdi class="secno"><ins class="diff-chg">
8.3
</ins></bdi><ins class="diff-chg">
Self-Discovery
on
LANs
</ins></h3><a class="self-link" href= "#security-consideration-lan-self-discovery" aria-label= "Permalink for Section 8.3"></a></div>
<p>
<del class="diff-old">Security
</del>
<ins class="diff-chg">On
a
LAN,
certificates
</ins>
and
<del class="diff-old">privacy
</del>
<ins class="diff-chg">browsers
may
not
be
able
to
property
set
up
TLS
for
HTTPS
because
browsers
expect
certificates
pointing
to
a
publicly-visible
URL.
Using
HTTP
is
common
practice
inside
LANs
but
in
combination
with
self-description
it
means
that
WoT
Things
would
be
essentially
be
making
TDs
visible
to
everyone
with
access
to
the
private
LAN.
Even
if
security
mechanisms
such
as
HTTP
passwords
were
used,
these
</ins>
are
<del class="diff-old">cross-cutting
issues
</del>
<ins class="diff-chg">not
effective
(they
can
be
easily
discovered
by
a
traffic
analyser)
without
transport
security.
</ins></p><dl><dt><ins class="diff-chg">
Mitigations:
</ins></dt><dd><p><span class="rfc2119-assertion" id="sec-self-psk"><ins class="diff-chg">
PSK
(pre-shared
keys)
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
used
if
possible
on
LANs,
meaning
one
of
the
ciphersuites
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc4279" title= "Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)"><ins class="diff-chg">
RFC4279
</ins></a></cite><ins class="diff-chg">
].
</ins></span><ins class="diff-chg">
This
does
require
</ins>
that
<ins class="diff-new">Things
are
assigned
PSKs
in
a
common
security
domain,
which
is
typically
done
by
following
an
onboarding
process.
Unfortunately,
specific
onboarding
processes
are
currently
out
of
scope
of
the
WoT
specifications.
</ins></p><p><ins class="diff-new">
An
alternative
is
to
depend
on
local
network
security
(i.e.
WEP).
This
is
not
the
best
solution
from
a
security
or
privacy
point
of
view
but
may
be
acceptable
in
some
contexts.
Note
however
that
all
users
with
access
to
the
network
would
in
turn
have
access
to
all
TDs
via
self-description.
</ins><span class="rfc2119-assertion" id="sec-self-segment"><ins class="diff-new">
If
Things
cannot
be
individually
secured
with
transport
security
and
authentication
and
authorization,
a
separate
network
</ins><em class="rfc2119"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
be
set
up,
i.e.
with
an
alternative
SSID,
and
used
only
for
IoT
devices.
</ins></span><ins class="diff-new">
Using
a
segmented
network
reduces
the
need
for
distributing
the
password
to
this
network
to
those
who
</ins>
need
<ins class="diff-new">access
to
the
set
of
IoT
devices
connected
to
it.
</ins></p><p><ins class="diff-new">
Another
alternative
is
to
use
a
reverse
proxy
service
based
in
the
cloud.
Secure
setup
can
be
accomplished
if
the
IoT
device
has
access
to
the
cloud,
since
the
proxy
server
can
have
a
public
URL
and
the
initial
connection
can
use
HTTPS,
then
open
a
secure
tunnel
over
a
websocket.
The
proxy
can
in
turn
re-expose
a
secure
endpoint,
and
possible
add
authentication.
The
disadvantages
of
this
approach
including
depending
on
an
external
cloud
service
and
the
need
to
expose
an
external
access
point
(which
is
itself
a
security
risk).
The
first
disadvantage
can
be
addressed
by
hosting
the
proxy
service
locally
and
exposing
a
public
URL
using
e.g.
dynamic
DNS
if
the
local
server
is
connected
through
an
ISP.
</ins><span class="rfc2119-assertion" id="sec-self-proxy"><ins class="diff-new">
If
Things
cannot
be
individually
secured
with
transport
security
and
authentication
and
authorization,
then
they
</ins><em class= "rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
be
made
available
for
general
access
via
a
proxy
that
can
provide
suitable
access
controls.
</ins></span></p></dd></dl></section></section><section id="privacy-considerations"><div class="header-wrapper"><h2 id="x9-privacy-considerations"><bdi class="secno"><ins class="diff-new">
9.
</ins></bdi><ins class="diff-new">
Privacy
Considerations
</ins></h2><a class="self-link" href="#privacy-considerations" aria-label= "Permalink for Section 9."></a></div><p><ins class="diff-new">
Privacy
is
a
cross-cutting
issue
that
needs
</ins>
to
be
considered
in
all
WoT
building
blocks
and
WoT
implementations.
This
chapter
summarizes
some
general
issues
and
guidelines
to
help
preserve
the
<del class="diff-old">security
and
</del>
privacy
of
concrete
WoT
discovery
implementations.
For
a
more
detailed
and
complete
analysis
of
<ins class="diff-new">both
</ins>
security
and
privacy
issues,
see
the
<em>
WoT
Security
and
Privacy
Guidelines
</em>
specification
[
<cite>
<a class="bibref" data-link-type="biblio" href= "#bib-wot-security" title= "Web of Things (WoT) Security and Privacy Guidelines">
WOT-SECURITY
</a>
</cite>
].
</p>
<p>
The
WoT
discovery
architecture
is
designed
to
avoid
a
dependence
on
the
<del class="diff-old">security
and
</del>
privacy
of
existing
discovery
schemes
by
using
a
two-phase
approach
and
<del class="diff-old">requiring
</del>
<ins class="diff-chg">allowing
for
the
enforcement
of
</ins>
authorization
before
metadata
release.
However
several
<del class="diff-old">security
and
</del>
privacy
risks
still
exist.
These
are
listed
below
along
with
possible
mitigations.
The
level
of
risk
to
privacy
in
particular
depends
on
the
use
case
and
whether
there
is
a
risk
that
information
related
to
a
person
might
be
distributed
in
a
fashion
inconsistent
with
the
privacy
desires
of
that
person.
<del class="diff-old">We
</del>
<ins class="diff-chg">For
privacy
we
</ins>
distinguish
the
following
broad
classes
of
use
case
scenarios:
</p>
<dl>
<dt>
Institutional
</dt>
<dd>
Both
the
Things
producing
metadata
and
the
Consumers
of
that
metadata
are
owned
and
controlled
by
an
institution
or
representatives
of
an
institution.
Example:
Automation
in
a
factory
where
a
control
system
is
accessing
the
state
of
an
assembly
line
in
order
to
evaluate
quality.
</dd>
<dt>
Service
</dt>
<dd>
The
Things
producing
metadata
are
owned
and
controlled
by
an
institution
or
representatives
of
an
institution
while
the
consumers
are
individuals.
Example:
driver
of
an
electric
vehicle
accessing
the
TD
for
a
charge
station
in
order
to
check
status
of
a
charge.
</dd>
<dt>
Personal
</dt>
<dd>
Both
the
Things
producing
metadata
and
the
Consumers
of
that
metadata
are
owned
and
controlled
by
the
same
individual.
Example:
A
smart
home
control
system
for
charging
an
electric
car
from
home-attached
solar
panels,
both
home
and
car
owned
by
the
same
person.
</dd>
<dt>
Personal
Peer-to-Peer
</dt>
<dd>
The
Things
producing
metadata
and
the
Consumers
of
that
metadata
are
owned
and
controlled
by
different
individuals.
Example:
A
smart
home
control
system
for
charging
a
guest's
electric
car
from
home-attached
solar
panels.
</dd>
<dt>
Institutional
Peer-to-Peer
</dt>
<dd>
The
Things
producing
metadata
and
the
Consumers
of
that
metadata
are
owned
and
controlled
by
different
institutions.
Example:
A
utility
provides
and
manages
power
delivered
to
a
factory,
and
the
factory
provides
an
interface
for
the
utility
to
negotiate
on-demand
power
usage
reductions.
</dd>
<dt>
Client
</dt>
<dd>
The
Things
producing
metadata
are
owned
and
controlled
by
an
individual
while
the
consumers
are
an
institution
or
representatives
of
an
institution.
Example:
A
personal
electric
vehicle
exposes
an
interface
to
a
public
charging
station
so
that
the
charging
station
can
evaluate
the
charge
status
of
the
vehicle.
</dd>
</dl>
<p>
All
of
these
in
fact
carry
privacy
risks.
Even
in
the
case
of
factory
automation,
there
is
the
chance
that
data
about
employee
performance
would
be
captured
and
would
have
to
be
managed
appropriately.
</p>
<p>
<ins class="diff-new">In
the
following
we
make
frequent
reference
to
"tracking".
This
term
covers
multiple
privacy
risks,
including
location
tracking
and
behavioral
profiling.
In
general,
the
definition
of
"profiling"
given
in
Article
4
of
the
GDPR
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-gdpr-defs" title= "General Data Protection Regulation (GDPR) Article 4 - Definitions"><ins class="diff-new">
GDPR-Defs
</ins></a></cite><ins class="diff-new">
]
is
to
be
considered
equivalent
to
"tracking"
as
used
in
this
document.
</ins></p><p>
With
these
<ins class="diff-new">definitions
and
</ins>
categories
established,
we
will
now
discuss
some
specific
<ins class="diff-new">privacy
</ins>
risks
and
potential
mitigations.
</p>
<del class="diff-old">7.1
Denial
of
Service
Certain
functions
of
the
directory
service,
in
particular
search
queries,
may
require
significant
resources
to
execute
and
this
fact
can
be
used
to
launch
DDoS
attacks
against
WoT
Thing
Description
Directory
services.
This
is
mostly
of
concern
in
the
Service
scenario,
where
the
metadata
requester
is
a
private
individual
and
the
provider
is
an
institution.
In
some
cases
this
risk
may
appear
in
Peer-to-Peer
scenarios
as
well.
Mitigations:
A
WoT
Thing
Description
Directory
implementation
should
Limit
the
number
of
queries
per
unit
time
from
the
same
requestor
Limit
the
complexity
of
queries
(for
example,
the
total
length
of
the
query
expression
or
its
depth)
Use
a
watchdog
timer
to
abort
queries
that
take
more
than
a
certain
maximum
(implementation-configurable)
amount
of
time.
In
cases
where
queries
are
refused
or
aborted
appropriate
error
responses
should
be
returned.
</del>
<section id="privacy-consideration-location-tracking">
<div class="header-wrapper">
<h3 id="x9-1-location-tracking-and-profiling">
<del class="diff-old">7.2
</del>
<bdi class= "secno">
<ins class="diff-chg">9.1
</ins>
</bdi>
Location
Tracking
<ins class="diff-chg">and
Profiling
</ins></h3><a class="self-link" href= "#privacy-consideration-location-tracking" aria-label= "Permalink for Section 9.1">
</a>
</div>
<p>
A
discovery
service
may
potentially
allow
the
approximate
location
of
a
person
to
be
determined
without
their
consent.
This
risk
occurs
in
some
specific
circumstances
which
can
be
avoided
or
mitigated.
It
is
also
similar
to
the
risk
posed
by
other
network
services
such
as
DHCP
and
DNS.
</p>
<p>
For
this
risk
to
occur,
there
first
has
to
be
an
IoT
device
that
can
be
reliably
associated
with
a
person's
location,
such
as
a
necessary
medical
device
or
a
vehicle.
Note
that
the
risk
only
applies
to
personal
use
cases,
not
institutional
ones.
Secondly,
the
device
has
to
be
configured
to
register
automatically
with
the
nearest
directory
service.
In
this
case,
the
location
of
the
device
can
be
inferred
from
the
network
range
of
the
directory
service
and
the
location
of
the
person
inferred
from
the
location
of
the
device.
</p>
<p>
There
are
a
few
variants
of
this:
</p>
<ul>
<li>
The
TD
or
Thing
could
report
actual
location
information
so
no
inferencing
by
network
range
is
needed;
</li>
<li>
A
directory
could
support
actual
search
by
location;
</li>
<li>
Absence
of
a
TD
in
a
directory
could
reveal
negative
location
<del class="diff-old">information
(e.g.
</del>
<ins class="diff-chg">information.
For
example,
</ins>
if
a
TD
times
out
and
is
removed
from
a
directory,
that
means
the
device
has
not
been
present
for
a
while,
which
could
be
used
to
infer
that
a
person
is
NOT
in
a
particular
location,
e.g.
not
at
home.
</li>
</ul>
<p>
<ins class="diff-new">Location
tracking
is
not
the
only
profiling
risk.
In
general,
"profiling"
includes
any
mechanism
used
to
evaluate
information
about
a
person,
including
economic
status,
health,
preferences,
interests,
reliability,
and
behavior.
Some
of
the
metadata
in
a
TD
can
be
used
to
infer
information
of
this
kind
if
the
described
Thing
can
be
associated
with
a
person.
Some
of
the
mitigations
below
are
also
applicable
to
this
more
general
definition
of
profiling.
</ins></p><p>
Some
of
these
risks
are
shared
by
similar
services.
For
example,
DCHP
automatically
responds
to
requests
for
IP
addresses
on
a
local
network,
and
devices
typically
provide
an
identifier
(a
MAC
address)
as
part
of
this
process,
and
the
DHCP
server
maintains
a
registry.
In
theory,
someone
with
access
to
the
DHCP
server
in,
say,
a
cafe,
could
use
this
information
to
track
someone's
phone
and
infer
their
location.
</p>
<dl>
<dt>
Mitigations:
</dt>
<dd>
There
are
a
few
options
to
mitigate
<del class="diff-old">this
risk:
</del>
<ins class="diff-chg">these
risks:
</ins>
<ul>
<li>
<del class="diff-old">Disable
</del>
<span class="rfc2119-assertion" id= "priv-loc-disable-public-directories">
<ins class="diff-chg">To
avoid
location
tracking
and
other
forms
of
profiling,
a
WoT
Thing
associated
with
a
person
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
disable
</ins>
registration
with
public
directories.
</span>
Registration
would
still
be
possible
with
personal
directories,
for
example,
a
home
gateway,
but
a
user
could
disable
registration
at
other
locations.
This
has
the
disadvantage
that
functionality
is
lost:
personal
devices
cannot
be
discovered
in
public
locations.
This
could
be
addressed
by
having
internet-accessible
private
discovery
<del class="diff-old">services
(e.g.
</del>
<ins class="diff-chg">services.
For
example,
</ins>
the
<ins class="diff-new">user's
</ins>
home
gateway
could
provide
an
internet-accessible
service,
but
with
access
control
limiting
use
to
authorized
users.
</li>
<li>
<del class="diff-old">Rotate
</del>
<span class="rfc2119-assertion" id="priv-loc-anonymous-tds">
<ins class="diff-chg">To
avoid
location
tracking
and
other
forms
of
profiling,
a
WoT
Thing
associated
with
a
person
</ins><em class="rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
use
anonymous
TDs
when
registering
with
a
public
directories.
</ins></span><ins class="diff-chg">
In
some
cases,
it
may
be
possible
to
use
anonymous
TDs
and
omit
explicit
IDs
from
TDs
submitted
to
a
TDD.
In
this
case
the
TDD
will
generate
a
local
ID
valid
only
in
that
TDD.
This
does,
however,
complicate
update
since
the
client
needs
to
remember
the
local
ID
assigned
by
the
TDD.
Anonymous
TDs
also
do
not
prevent
tracking
by
other
means,
such
as
fingerprinting.
</ins></li><li><span class="rfc2119-assertion" id="priv-loc-gen-ids"><ins class="diff-chg">
To
avoid
location
tracking
and
other
forms
of
profiling,
a
WoT
Thing
associated
with
a
person
</ins><em class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
periodically
generate
new
</ins>
IDs.
</span>
Using
fixed
IDs
makes
it
exceptionally
easy
to
track
devices.
This
problem
also
occurs
in
DHCP
with
MAC
address
and
there
is
a
similar
partial
mitigation:
generate
new
random
IDs
periodically.
There
are
however,
a
few
issues.
First
of
all,
other
identification
information
in
the
TD
needs
to
be
hidden.
For
example,
client
IDs
issued
by
CSPs
for
API
security
should
be
omitted
from
TDs
if
they
cannot
be
easily
<del class="diff-old">rotated.
</del>
<ins class="diff-chg">changed.
</ins>
Second,
if
the
device
<del class="diff-old">rotates
the
</del>
<ins class="diff-chg">generates
a
new
</ins>
ID,
the
user
may
still
need
to
know
the
current
ID
to
find
the
device
via
discovery.
This
can
be
accomplished
however
by
generating
new
IDs
using
a
deterministic
cryptographic
generator
that
is
a
function
of
the
current
time.
However,
note
that
<del class="diff-old">rotating
</del>
<ins class="diff-chg">regenerating
</ins>
IDs
alone
does
not
make
tracking
impossible
since
a
TD
might
be
fingerprinted.
Also,
updating
an
ID
might
be
observable
to
the
owner
of
the
directory
service,
who
could
track
and
record
the
updated
ID.
Even
if
the
TD
is
deleted
and
reinserted
the
association
could
be
inferred.
This
is
however
exactly
parallel
to
the
situation
with
DHCP
and
rotation
of
MAC
addresses.
In
general,
however,
generating
new
IDs
at
least
for
each
service
or
person
to
which
a
TD
is
supplied
makes
it
harder
to
connect
registration
events
at
different
locations
and
times.
<ins class="diff-new">It
is
also
prudent
to
generate
new
identifiers
upon
major
changes
in
configuration,
such
as
unregistering
from
a
local
network
or
hub
and
registering
with
a
new
one
(which
typically
indicates
a
change
in
ownership).
There
is
a
related
issue
with
long-lived
IP
addresses
which
might
need
to
be
updated
periodically
to
mitigate
tracking.
In
the
context
of
ipv6
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8981" title= "Temporary Address Extensions for Stateless Address Autoconfiguration in IPv6"><ins class="diff-new">
RFC8981
</ins></a></cite><ins class="diff-new">
]
discusses
this.
Finally,
there
is
a
problem
with
devices
that
require
immutable
identifiers,
e.g.
medical
devices
in
such
jurisdictions.
This
is
discussed
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-wot-thing-description11" title= "Web of Things (WoT) Thing Description 1.1"><ins class="diff-new">
wot-thing-description11
</ins></a></cite><ins class="diff-new">
],
but
in
summary
the
problem
can
be
avoided
if
such
immutable
identifiers
are
made
available
only
as
protected
properties,
e.g.
via
affordances
requiring
authentication,
not
in
the
TD,
and
the
TD
identifier
itself
(if
used)
is
independent
of
the
immutable
identifier,
and
so
can
be
made
mutable.
</ins>
</li>
<li>
<del class="diff-old">The
problem
</del>
<span class="rfc2119-assertion" id= "priv-loc-priv-dir-access">
<ins class="diff-chg">To
reduce
the
risk
</ins>
of
negative
location
<del class="diff-old">inferencing
can
be
mitigated
by
limiting
</del>
<ins class="diff-chg">inferencing,
</ins>
access
to
private
<del class="diff-old">directories,
for
example
in
the
home,
</del>
<ins class="diff-chg">directories
</ins><em class= "rfc2119"><ins class="diff-chg">
SHOULD
</ins></em><ins class="diff-chg">
be
limited
</ins>
by
using
access
controls.
</span>
If
an
attacker
cannot
access
the
service,
they
cannot
retrieve
information
to
infer
location.
Access
rights
provided
to
guests
<del class="diff-old">(Peer-to-Peer
Personal)
</del>
<ins class="diff-chg">(e.g.
for
Peer-to-Peer
Personal
scenarios)
</ins>
should
be
appropriately
time-limited.
Use
of
long
time-to-live
values
may
be
appropriate
in
other
cases.
In
addition,
TDs
should
be
updated
in
a
directory
only
when
they
change.
For
example,
the
TD
for
a
car
may
only
be
updated
when
new
car
firmware
is
available
providing
new
services,
and
the
time-to-live
might
be
set
at
one
month
(covering
most
absences).
</li>
<li>
<span class="rfc2119-assertion" id= "priv-loc-explicit-care">
When
explicit
location
information
is
available,
whether
stored
in
a
TD
or
available
in
a
property,
additional
care
<del class="diff-old">should
</del>
<em class="rfc2119">
<ins class="diff-chg">SHOULD
</ins></em>
be
taken
to
only
share
the
TD
and/or
access
to
the
device
with
trusted
partners,
including
directories.
</span>
<span class="rfc2119-assertion" id= "priv-loc-explicit-strip">
If
the
TD
must
be
shared
with
a
public
directory,
the
location
information
<del class="diff-old">can
</del>
<em class="rfc2119">
<ins class="diff-chg">MAY
</ins></em>
be
stripped.
</span>
</li>
</ul>
</dd>
</dl>
</section>
<section id="privacy-consideration-query-tracking">
<div class="header-wrapper">
<h3 id="x9-2-query-tracking">
<bdi class="secno">
<ins class="diff-new">9.2
</ins></bdi><ins class="diff-new">
Query
Tracking
</ins></h3><a class="self-link" href="#privacy-consideration-query-tracking" aria-label="Permalink for Section 9.2"></a></div><p><ins class="diff-new">
A
directory
service
could
potentially
record
and
track
queries
by
an
individual,
identifying
that
individual
by
their
authenticated
identity
provided.
Then
the
set
of
queries
associated
with
an
individual
could
be
used
to
profile
that
individual,
and
specific
queries
may
also
reveal
personal
information
about
an
individual.
</ins></p><dl><dt><ins class="diff-new">
Mitigations:
</ins></dt><dd><p><span class="rfc2119-assertion" id="priv-query-anon"><ins class="diff-new">
When
accessing
a
public
directory,
like
any
other
public
web
service,
users
and
implementations
</ins><em class="rfc2119"><ins class="diff-new">
SHOULD
</ins></em><ins class="diff-new">
use
an
anonymous
identity
provider.
</ins></span><ins class="diff-new">
In
particular,
OAuth2
can
provide
tokens
which
don't
identify
specific
individuals,
they
just
assert
access
rights
proven
elsewhere.
</ins></p></dd></dl></section></section><section id="performance-considerations" class="informative"><div class="header-wrapper"><h2 id="x10-performance-considerations"><bdi class= "secno"><ins class="diff-new">
10.
</ins></bdi><ins class="diff-new">
Performance
Considerations
</ins></h2><a class="self-link" href="#performance-considerations" aria-label= "Permalink for Section 10."></a></div><p><em><ins class="diff-new">
This
section
is
non-normative.
</ins></em></p><section id="perf-incremental-transfer"><div class="header-wrapper"><h3 id="x10-1-incremental-transfer"><bdi class="secno"><ins class="diff-new">
10.1
</ins></bdi><ins class="diff-new">
Incremental
Transfer
</ins></h3><a class="self-link" href="#perf-incremental-transfer" aria-label= "Permalink for Section 10.1"></a></div><p><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-td-43"><ins class="diff-new">
TD
</ins></a><ins class="diff-new">
objects
are
not
constrained
in
size.
They
may
become
expensive
to
process
and
transfer
individually
or
collectively.
A
single
TD
or
a
list
of
TDs
could
be
too
large
for
a
constrained
device,
serving
its
own
TD
to
consumers,
submitting
it
to
a
directory,
or
consuming
other
TDs.
To
meet
such
requirements,
servers
should
support
incremental
transfer
of
payloads
using
protocol-specific
mechanisms:
</ins></p><ul><li><ins class="diff-new">
HTTP/1.1
servers
should
support
</ins><code><ins class="diff-new">
chunked
</ins></code><a href= "https://tools.ietf.org/html/rfc7230#section-3.3.1"><ins class="diff-new">
Transfer-Encoding
</ins></a><ins class="diff-new">
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc7230" title= "Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"><ins class="diff-new">
RFC7230
</ins></a></cite><ins class="diff-new">
]
to
receive
and
server
data
incrementally.
</ins></li><li><ins class="diff-new">
HTTP/2
servers
should
handle
the
data
incrementally
using
</ins><a href="https://tools.ietf.org/html/rfc7540#section-4"><ins class="diff-new">
HTTP
Frames
</ins></a><ins class="diff-new">
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc7540" title= "Hypertext Transfer Protocol Version 2 (HTTP/2)"><ins class="diff-new">
RFC7540
</ins></a></cite><ins class="diff-new">
].
The
HTTP/1.1
chunked
transfer
encoding
is
not
supported
in
HTTP/2.
</ins></li><li><ins class="diff-new">
CoAP
servers
must
suppoert
block-wise
transfer
[
</ins><cite><a class= "bibref" data-link-type="biblio" href="#bib-rfc7959" title= "Block-Wise Transfers in the Constrained Application Protocol (CoAP)"><ins class="diff-new">
RFC7959
</ins></a></cite><ins class="diff-new">
]
when
relying
on
an
unreliable
transport
protocol
like
UDP
and
should
support
it
when
using
a
reliable
transport
protocol
like
TCP
or
WebSockets
[
</ins><cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8323" title= "CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"><ins class="diff-new">
RFC8323
</ins></a></cite><ins class="diff-new">
].
</ins></li></ul><p><ins class="diff-new">
Most
HTTP
servers
and
clients
automatically
process
the
data
that
is
transferred
in
chunks.
Memory-constrained
clients
should
consider
consuming
the
received
data
incrementally,
instead
of
trying
to
load
a
whole
object
in
memory
for
de-serialization.
</ins></p></section>
</section>
<section id="iana-considerations" class="normative">
<div class="header-wrapper">
<h2 id="x11-iana-considerations">
<bdi class="secno">
<del class="diff-old">8.
</del>
<ins class="diff-chg">11.
</ins>
</bdi>
IANA
Considerations
</h2>
<a class="self-link" href="#iana-considerations" aria-label= "Permalink for Section 11.">
</a>
</div>
<section id="well-known-uri-suffix">
<div class="header-wrapper">
<h3 id="x11-1-well-known-uri-registration">
<bdi class= "secno">
<ins class="diff-chg">11.1
</ins></bdi><ins class="diff-chg">
Well-Known
URI
Registration
</ins></h3><a class="self-link" href="#well-known-uri-suffix" aria-label= "Permalink for Section 11.1"></a></div><p><ins class="diff-chg">
IANA
will
be
asked
to
allocate
the
following
value
into
the
Well-Known
URI
defined
in
[
</ins><cite><a class="bibref" data-link-type= "biblio" href="#bib-rfc8615" title= "Well-Known Uniform Resource Identifiers (URIs)"><ins class="diff-chg">
RFC8615
</ins></a></cite><ins class="diff-chg">
].
</ins></p><ul><li><ins class="diff-chg">
URI
suffix:
</ins><code><ins class="diff-chg">
wot
</ins></code></li></ul></section><section id="service-name"><div class="header-wrapper"><h3 id="x11-2-service-name-registration"><bdi class= "secno"><ins class="diff-chg">
11.2
</ins></bdi><ins class="diff-chg">
Service
Name
Registration
</ins></h3><a class="self-link" href="#service-name" aria-label= "Permalink for Section 11.2"></a></div><p><ins class="diff-chg">
IANA
will
be
asked
to
allocate
the
following
value
into
Service
Name
and
Transport
Protocol
Port
Number
Registry
defined
in
[
</ins><cite><a class="bibref" data-link-type="biblio" href= "#bib-rfc6335" title= "Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"><ins class="diff-chg">
RFC6335
</ins></a></cite><ins class="diff-chg">
].
</ins></p><ul><li><ins class="diff-chg">
Service
Name:
</ins><code><ins class="diff-chg">
wot
</ins></code></li><li><ins class="diff-chg">
Transport
Protocol:
TCP,
UDP
</ins></li><li><ins class="diff-chg">
Description:
Service
name
to
search
a
Thing
or
a
Thing
Description
Directory
of
</ins><abbr title= "World Wide Web Consortium"><ins class="diff-chg">
W3C
</ins></abbr><ins class="diff-chg">
Web
of
Things
</ins></li><li><ins class="diff-chg">
Port
Number:
N/A
</ins></li><li><ins class="diff-chg">
Assignment
notes:
PTR,
SRV,
TXT
RR
types
are
used
</ins></li></ul></section>
<section id="core-resource-type">
<div class="header-wrapper">
<h3 id="x11-3-core-resource-types-registration">
<bdi class= "secno">
<del class="diff-old">8.1
</del>
<ins class="diff-chg">11.3
</ins>
</bdi>
CoRE
Resource
Types
Registration
</h3>
<a class="self-link" href="#core-resource-type" aria-label= "Permalink for Section 11.3">
</a>
</div>
<p>
IANA
will
be
asked
to
allocate
the
following
values
into
the
Resource
Type
(
<code>
rt=
</code>
)
Link
Target
Attribute
Values
sub-registry
of
the
Constrained
Restful
Environments
(CoRE)
Parameters
registry
defined
in
[
<cite>
<a class="bibref" data-link-type="biblio" href="#bib-rfc6690" title= "Constrained RESTful Environments (CoRE) Link Format">
RFC6690
</a>
</cite>
].
</p>
<table class="def">
<thead>
<tr>
<th>
Value
</th>
<th>
Description
</th>
<th>
Reference
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code>
wot.thing
</code>
</td>
<td>
Thing
Description
of
a
Thing
</td>
<td>
<del class="diff-old">[
</del>
<del class="diff-old">wot-discovery
</del>
<a href="#introduction-core-rd-sec" data-matched-text= "[[[#introduction-core-rd-sec]]]" class="sec-ref">
<del class="diff-old">],
§&nbsp;
</del>
<bdi class= "secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</bdi>
CoRE
Link
Format
and
CoRE
Resource
Directory
</a>
</td>
</tr>
<tr>
<td>
<code>
wot.directory
</code>
</td>
<td>
Directory
Description
of
a
<a href= "#dfn-wot-thing-description-directory" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-thing-description-directory-25">
Thing
Description
Directory
</a>
</td>
<td>
<del class="diff-old">[
</del>
<del class="diff-old">wot-discovery
</del>
<a href="#introduction-core-rd-sec" data-matched-text= "[[[#introduction-core-rd-sec]]]" class="sec-ref">
<del class="diff-old">],
§&nbsp;
</del>
<bdi class= "secno">
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
</bdi>
CoRE
Link
Format
and
CoRE
Resource
Directory
</a>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="tdd-extensions-jsonschema" class="appendix">
<div class="header-wrapper">
<h2 id="a-json-schema-for-wot-discovery-td-extensions">
<bdi class= "secno">
<ins class="diff-new">A.
</ins></bdi><ins class="diff-new">
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins></h2><a class="self-link" href="#tdd-extensions-jsonschema" aria-label= "Permalink for Appendix A."></a></div><ins class="diff-new">
The
following
JSON
Schema
specifies
the
extensions
used
in
</ins><a href= "#dfn-wot-enriched-thing-description" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-enriched-thing-description-7"><ins class="diff-new">
Enriched
TDs
</ins></a>.<ins class="diff-new">
It
can
be
used
for
validating
</ins><a href="#dfn-td" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-td-44"><ins class="diff-new">
TDs
</ins></a><ins class="diff-new">
by
a
</ins><a href= "#dfn-wot-tdd" class="internalDFN" data-link-type="dfn" id= "ref-for-dfn-wot-tdd-1"><ins class="diff-new">
TDD
</ins></a><ins class="diff-new">
as
prescribed
in
</ins><a href= "#exploration-directory-api-things-validation" data-matched-text= "[[[#exploration-directory-api-things-validation]]]" class= "sec-ref"><bdi class="secno"><ins class="diff-new">
7.3.2.1.6
</ins></bdi><ins class="diff-new">
Validation
</ins></a>.<pre class="advisement" aria-busy="false"><code class="hljs json">{  <span class="hljs-attr">"title"</span>: <span class=<ins class="diff-new">
"hljs-string">"WoT Discovery TD-extensions Schema - 21 May 2021"</span>,
</ins>  <span class="hljs-attr">"description"</span>: <span class=<ins class="diff-new">
"hljs-string">"JSON Schema for validating TD instances with WoT Discovery extensions"</span>,
</ins>  <span class="hljs-attr">"$schema "</span>: <span class=<ins class="diff-new">
"hljs-string">"http://json-schema.org/draft/2019-09/schema#"</span>,
</ins>  <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"object"</span>,
</ins>  <span class="hljs-attr">"properties"</span>: {    <span class="hljs-attr">"registration"</span>: {      <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"object"</span>,
</ins>      <span class="hljs-attr">"properties"</span>: {        <span class="hljs-attr">"created"</span>: {          <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"string"</span>,
</ins>          <span class="hljs-attr">"format"</span>: <span class=<ins class="diff-new">
"hljs-string">"date-time"</span>
        },
</ins>        <span class="hljs-attr">"expires"</span>: {          <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"string"</span>,
</ins>          <span class="hljs-attr">"format"</span>: <span class=<ins class="diff-new">
"hljs-string">"date-time"</span>
        },
</ins>        <span class="hljs-attr">"retrieved"</span>: {          <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"string"</span>,
</ins>          <span class="hljs-attr">"format"</span>: <span class=<ins class="diff-new">
"hljs-string">"date-time"</span>
        },
</ins>        <span class="hljs-attr">"modified"</span>: {          <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"string"</span>,
</ins>          <span class="hljs-attr">"format"</span>: <span class=<ins class="diff-new">
"hljs-string">"date-time"</span>
        },
</ins>        <span class="hljs-attr">"ttl"</span>: {          <span class="hljs-attr">"type"</span>: <span class=<ins class="diff-new">
"hljs-string">"number"</span>
        }
      }
    }
  }
}
</ins></code></pre></section>
<section id="changes" class="appendix">
<div class="header-wrapper">
<h2 id="b-recent-specification-changes">
<bdi class="secno">
<del class="diff-old">A.
</del>
<ins class="diff-chg">B.
</ins>
</bdi>
Recent
Specification
Changes
</h2>
<a class="self-link" href="#changes" aria-label= "Permalink for Appendix B.">
</a>
</div>
<section id="changes-from-2-june-2021-working-draft">
<div class="header-wrapper">
<h3 id="changes-from-second-draft">
<bdi class="secno">
<del class="diff-old">A.1
</del>
<ins class="diff-chg">B.1
</ins>
</bdi>
Changes
from
<del class="diff-old">First
</del>
<ins class="diff-chg">2
June
2021
Working
</ins>
Draft
</h3>
<a class="self-link" href="#changes-from-second-draft" aria-label= "Permalink for Appendix B.1">
</a>
</div>
<ul>
<li>
<ins class="diff-new">Use
</ins><code><ins class="diff-new">
wot
</ins></code><ins class="diff-new">
for
well-known
URI
service
name.
</ins></li><li><ins class="diff-new">
Refer
to
TD
and
Architecture
specs
for
general
constraints
on
secure
transport.
</ins></li><li><ins class="diff-new">
Define
requirements
for
CoAP-based
TD
Servers.
</ins></li><li><ins class="diff-new">
Introduction
of
TD
Server
exploration,
with
self-description
as
a
special
case.
</ins></li><li><ins class="diff-new">
Elaboration
of
class
diagram
to
clarify
that
not
all
Directories
need
to
be
self-describing.
</ins></li><li><ins class="diff-new">
Clarify
and
consolidate
error
codes
and
ontology.
</ins></li><li><ins class="diff-new">
Add
assertions
for
UTF-8
supporting
internationalization.
</ins></li><li><ins class="diff-new">
Update
overview
figure
showing
introduction
and
exploration
mechanisms.
</ins></li><li><ins class="diff-new">
Add
Discoverer
section
defining
requirements
for
discovery
clients.
</ins></li><li><ins class="diff-new">
Use
Thing
Model
instead
of
a
Thing
Description
example
for
Directory
API.
</ins></li><li><ins class="diff-new">
Refactor
Directory
Service
API
(td-&gt;thing,
split
anonymous
create
action,
retrieve
one
and
search
as
actions,
listing
as
things
property,
split
events)
</ins></li><li><ins class="diff-new">
Add
amplification
DDOS
security
consideration.
</ins></li><li><ins class="diff-new">
Split
Security
and
Privacy
Considerations
into
separate
sections.
</ins></li><li><ins class="diff-new">
Define
status
of
search
mechanisms:
JSON
Path,
XPath,
and
SPARQL.
</ins></li><li><ins class="diff-new">
Pagination
as
array
and
pagination
as
collection.
</ins></li><li><ins class="diff-new">
Updates
to
events
API.
</ins></li><li><ins class="diff-new">
TD
expiry
management.
</ins></li><li><ins class="diff-new">
HEAD
method
support.
</ins></li></ul></section><section id= "changes-from-24-november-2020-first-public-working-draft"><div class="header-wrapper"><h3 id="changes-from-first-draft"><bdi class="secno"><ins class="diff-new">
B.2
</ins></bdi><ins class="diff-new">
Changes
from
24
November
2020
First
Public
Working
Draft
</ins>
</h3>
<a class="self-link" href="#changes-from-first-draft" aria-label= "Permalink for Appendix B.2">
</a>
</div>
<ul>
<li>
Update
name
of
directory
service
to
"Thing
Description
Directory"
with
acronym
TDD,
to
avoid
confusion
with
the
acronym
TD
used
for
Thing
Descriptions.
</li>
<li>
Elaboration
of
complete
API
for
registration
of
a
Thing
Description
with
a
Thing
Description
Directory,
including
support
for
creation,
update,
retrieval,
deletion,
and
listing.
</li>
<li>
Add
recommendation
that
TDs
be
validated
before
storage
in
a
directory.
Note:
this
corresponds
to
work
under
way
in
the
TD
spec
to
precisely
define
appropriate
levels
of
automatic
validation
for
different
contexts,
including
directory
registration.
</li>
<li>
Addition
of
Security
and
Privacy
Considerations
regarding
Denial
of
Service
and
Location
Tracking.
</li>
<li>
Addition
of
IANA
Considerations
regarding
CoRE
Resource
Types.
</li>
<li>
Definition
of
Enriched
TD
to
support
embedded
metadata
in
TDs
returned
by
a
TDD.
</li>
<li>
Updates
to
description
of
exploration
to
avoid
unnecessary
dependence
on
HTTP
(in
the
future,
other
protocols
may
be
supported).
</li>
<li>
Use
of
"resource
type"
instead
of
"endpoint
type"
when
describing
entry
in
CoRE
RD.
</li>
<li>
Addition
of
ontology
for
TDDs
that
include
the
type
<code>
DirectoryDescription
</code>
identifying
TDs
of
directories
and
a
type
<code>
LinkDescription
</code>
to
identify
a
TD
that
is
just
a
link
to
another
TD
(useful
for
referring
to
remote
directories
in
order
to
support
federation).
</li>
<li>
Add
section
for
self-description
exploration
mechanism.
This
supports
the
use
case
where
a
Thing
hosts
its
own
TD
and
peer-to-peer
Thing
communication.
</li>
<li>
Addition
of
diagram
showing
the
directory
information
model.
</li>
<li>
Removal
of
reference
to
Issue
16,
citing
CRUD
interface
requirements.
Replaced
with
CRUDL
(CRUD
+
Listing)
interface
requirement.
</li>
<li>
<em class="rfc2119">
MAY
</em>
assertion
added
to
explicitly
permit
implementation
of
SPARQL
federation,
and
a
requirement
that
if
implemented,
it
needs
to
follow
the
SPARQL
1.1
specification.
</li>
<li>
Updates
to
references:
more
recent
versions
of
CoRE
RD,
DID
Core,
Eventsource,
JSON-LD,
and
JSON
Path
specifications.
Use
of
datatracker
service
(and
URLs)
to
reference
IETF
RFCs.
Addition
of
normative
references
to
RFC7396
and
RFC7540.
</li>
</ul>
</section>
</section>
<section id="acknowledgements" class="appendix normative">
<div class="header-wrapper">
<h2 id="c-acknowledgments">
<bdi class="secno">
<del class="diff-old">B.
</del>
<ins class="diff-chg">C.
</ins>
</bdi>
Acknowledgments
</h2>
<a class="self-link" href="#acknowledgements" aria-label= "Permalink for Appendix C.">
</a>
</div>
<p>
Many
thanks
to
the
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
staff
and
all
other
active
Participants
of
the
<abbr title= "World Wide Web Consortium">
W3C
</abbr>
Web
of
Things
Interest
Group
(WoT
IG)
and
Working
Group
(WoT
WG)
for
their
support,
technical
input
and
suggestions
that
led
to
improvements
to
this
document.
</p>
</section>
<section id="references" class="appendix">
<div class="header-wrapper">
<h2 id="d-references">
<bdi class="secno">
<del class="diff-old">C.
</del>
<ins class="diff-chg">D.
</ins>
</bdi>
References
</h2>
<a class="self-link" href="#references" aria-label= "Permalink for Appendix D.">
</a>
</div>
<section id="normative-references">
<div class="header-wrapper">
<h3 id="d-1-normative-references">
<bdi class="secno">
<del class="diff-old">C.1
</del>
<ins class="diff-chg">D.1
</ins>
</bdi>
Normative
references
</h3>
<a class="self-link" href="#normative-references" aria-label= "Permalink for Appendix D.1">
</a>
</div>
<dl class="bibliography">
<dt id="bib-core-rd">
[CoRE-RD]
</dt>
<dd>
<a href= "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26">
<cite>
CoRE
Resource
Directory
</cite>
</a>.
Christian
Amsüss;
Zach
Shelby;
Michael
Koster;
Carsten
Bormann;
Peter
van
der
Stok.
IETF.
2
November
2020.
URL:
<a href= "https://tools.ietf.org/html/draft-ietf-core-resource-directory-26">
https://tools.ietf.org/html/draft-ietf-core-resource-directory-26
</a>
</dd>
<dt id="bib-did-core">
[DID-CORE]
</dt>
<dd>
<a href="https://www.w3.org/TR/did-core/">
<cite>
Decentralized
Identifiers
(DIDs)
v1.0
</cite>
</a>.
<del class="diff-old">Drummond
Reed;
</del>
Manu
Sporny;
<ins class="diff-new">Amy
Guy;
</ins>
Markus
Sabadello;
<del class="diff-old">Dave
Longley;
Christopher
Allen.
</del>
<ins class="diff-chg">Drummond
Reed.
</ins>
W3C.
<del class="diff-old">29
May
</del>
<ins class="diff-chg">3
August
</ins>
2021.
W3C
<del class="diff-old">Candidate
</del>
<ins class="diff-chg">Proposed
</ins>
Recommendation.
URL:
<a href= "https://www.w3.org/TR/did-core/">
https://www.w3.org/TR/did-core/
</a>
</dd>
<dt id="bib-eventsource">
[EVENTSOURCE]
</dt>
<dd>
<a href="https://www.w3.org/TR/eventsource/">
<cite>
Server-Sent
Events
</cite>
</a>.
Ian
Hickson.
W3C.
28
January
2021.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/eventsource/">
https://www.w3.org/TR/eventsource/
</a>
</dd>
<dt id="bib-gdpr-defs">
<ins class="diff-new">[GDPR-Defs]
</ins></dt><dd><a href="https://gdpr-info.eu/art-4-gdpr/"><cite><ins class="diff-new">
General
Data
Protection
Regulation
(GDPR)
Article
4
-
Definitions
</ins></cite></a>.<ins class="diff-new">
European
Union
(EU)
and
the
European
Economic
Area
(EEA).
URL:
</ins><a href= "https://gdpr-info.eu/art-4-gdpr/"><ins class="diff-new">
https://gdpr-info.eu/art-4-gdpr/
</ins></a></dd>
<dt id="bib-json-ld11">
[JSON-LD11]
</dt>
<dd>
<a href="https://www.w3.org/TR/json-ld11/">
<cite>
JSON-LD
1.1
</cite>
</a>.
Gregg
Kellogg;
Pierre-Antoine
Champin;
Dave
Longley.
W3C.
16
July
2020.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/json-ld11/">
https://www.w3.org/TR/json-ld11/
</a>
</dd>
<dt id="bib-owasp-top-10">
<ins class="diff-new">[OWASP-Top-10]
</ins></dt><dd><a href="https://owasp.org/www-project-top-ten/"><cite><ins class="diff-new">
OWASP
Top
Ten
</ins></cite></a>.<ins class="diff-new">
OWASP.
URL:
</ins><a href= "https://owasp.org/www-project-top-ten/"><ins class="diff-new">
https://owasp.org/www-project-top-ten/
</ins></a></dd>
<dt id="bib-rfc2119">
[RFC2119]
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc2119">
<cite>
Key
words
for
use
in
RFCs
to
Indicate
Requirement
Levels
</cite>
</a>.
S.
Bradner.
IETF.
March
1997.
Best
Current
Practice.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc2119
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc2119">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc2119
</ins>
</a>
</dd>
<dt id="bib-rfc2782">
[RFC2782]
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc2782">
<cite>
A
DNS
RR
for
specifying
the
location
of
services
(DNS
SRV)
</cite>
</a>.
A.
Gulbrandsen;
P.
Vixie;
L.
Esibov.
IETF.
February
2000.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc2782
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc2782">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc2782
</ins>
</a>
</dd>
<dt id="bib-rfc4122">
[RFC4122]
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc4122">
<cite>
A
Universally
Unique
IDentifier
(UUID)
URN
Namespace
</cite>
</a>.
P.
Leach;
M.
Mealling;
R.
Salz.
IETF.
July
2005.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc4122
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc4122">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc4122
</ins></a></dd><dt id="bib-rfc4279"><ins class="diff-chg">
[RFC4279]
</ins></dt><dd><a href= "https://www.rfc-editor.org/rfc/rfc4279"><cite><ins class="diff-chg">
Pre-Shared
Key
Ciphersuites
for
Transport
Layer
Security
(TLS)
</ins></cite></a>.<ins class="diff-chg">
P.
Eronen,
Ed.;
H.
Tschofenig,
Ed..
IETF.
December
2005.
Proposed
Standard.
URL:
</ins><a href= "https://www.rfc-editor.org/rfc/rfc4279"><ins class="diff-chg">
https://www.rfc-editor.org/rfc/rfc4279
</ins></a></dd><dt id="bib-rfc6335"><ins class="diff-chg">
[RFC6335]
</ins></dt><dd><a href="https://www.rfc-editor.org/rfc/rfc6335"><cite><ins class="diff-chg">
Internet
Assigned
Numbers
Authority
(IANA)
Procedures
for
the
Management
of
the
Service
Name
and
Transport
Protocol
Port
Number
Registry
</ins></cite></a>.<ins class="diff-chg">
M.
Cotton;
L.
Eggert;
J.
Touch;
M.
Westerlund;
S.
Cheshire.
IETF.
August
2011.
Best
Current
Practice.
URL:
</ins><a href="https://www.rfc-editor.org/rfc/rfc6335"><ins class="diff-chg">
https://www.rfc-editor.org/rfc/rfc6335
</ins>
</a>
</dd>
<dt id="bib-rfc6690">
[RFC6690]
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc6690">
<cite>
Constrained
RESTful
Environments
(CoRE)
Link
Format
</cite>
</a>.
Z.
Shelby.
IETF.
August
2012.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc6690
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc6690">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc6690
</ins>
</a>
</dd>
<dt id="bib-rfc6762">
[RFC6762]
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc6762">
<cite>
Multicast
DNS
</cite>
</a>.
S.
Cheshire;
M.
Krochmal.
IETF.
February
2013.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc6762
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc6762">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc6762
</ins>
</a>
</dd>
<dt id="bib-rfc6763">
[RFC6763]
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc6763">
<cite>
DNS-Based
Service
Discovery
</cite>
</a>.
S.
Cheshire;
M.
Krochmal.
IETF.
February
2013.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc6763
[RFC7230]
Hypertext
Transfer
Protocol
(HTTP/1.1):
Message
Syntax
and
Routing
.
R.
Fielding,
Ed.;
J.
Reschke,
Ed..
IETF.
June
2014.
Proposed
Standard.
URL:
https://httpwg.org/specs/rfc7230.html
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc6763">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc6763
</ins>
</a>
</dd>
<dt id="bib-rfc7231">
[RFC7231]
</dt>
<dd>
<a href="https://httpwg.org/specs/rfc7231.html">
<cite>
Hypertext
Transfer
Protocol
(HTTP/1.1):
Semantics
and
Content
</cite>
</a>.
R.
Fielding,
Ed.;
J.
Reschke,
Ed..
IETF.
June
2014.
Proposed
Standard.
URL:
<a href= "https://httpwg.org/specs/rfc7231.html">
https://httpwg.org/specs/rfc7231.html
</a>
</dd>
<dt id="bib-rfc7396">
[RFC7396]
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc7396">
<cite>
JSON
Merge
Patch
</cite>
</a>.
P.
Hoffman;
J.
Snell.
IETF.
October
2014.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc7396
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc7396">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc7396
</ins>
</a>
</dd>
<del class="diff-old">[RFC7540]
</del>
<dt id="bib-rfc7807">
<ins class="diff-chg">[RFC7807]
</ins>
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc7807">
<cite>
<del class="diff-old">Hypertext
Transfer
Protocol
Version
2
(HTTP/2)
</del>
<ins class="diff-chg">Problem
Details
for
HTTP
APIs
</ins>
</cite>
</a>.
M.
<del class="diff-old">Belshe;
R.
Peon;
M.
Thomson,
Ed..
</del>
<ins class="diff-chg">Nottingham;
E.
Wilde.
</ins>
IETF.
<del class="diff-old">May
2015.
</del>
<ins class="diff-chg">March
2016.
</ins>
Proposed
Standard.
URL:
<del class="diff-old">https://httpwg.org/specs/rfc7540.html
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc7807">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc7807
</ins>
</a>
</dd>
<del class="diff-old">[RFC7807]
</del>
<dt id="bib-rfc7959">
<ins class="diff-chg">[RFC7959]
</ins>
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc7959">
<cite>
<del class="diff-old">Problem
Details
for
HTTP
APIs
</del>
<ins class="diff-chg">Block-Wise
Transfers
in
the
Constrained
Application
Protocol
(CoAP)
</ins>
</cite>
</a>.
<del class="diff-old">M.
Nottingham;
E.
Wilde.
</del>
<ins class="diff-chg">C.
Bormann;
Z.
Shelby,
Ed..
</ins>
IETF.
<del class="diff-old">March
</del>
<ins class="diff-chg">August
</ins>
2016.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc7807
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc7959">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc7959
</ins>
</a>
</dd>
<dt id="bib-rfc8174">
[RFC8174]
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc8174">
<cite>
Ambiguity
of
Uppercase
vs
Lowercase
in
RFC
2119
Key
Words
</cite>
</a>.
B.
Leiba.
IETF.
May
2017.
Best
Current
Practice.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc8174
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc8174">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc8174
</ins></a></dd><dt id="bib-rfc8288"><ins class="diff-chg">
[RFC8288]
</ins></dt><dd><a href="https://httpwg.org/specs/rfc8288.html"><cite><ins class="diff-chg">
Web
Linking
</ins></cite></a>.<ins class="diff-chg">
M.
Nottingham.
IETF.
October
2017.
Proposed
Standard.
URL:
</ins><a href= "https://httpwg.org/specs/rfc8288.html"><ins class="diff-chg">
https://httpwg.org/specs/rfc8288.html
</ins>
</a>
</dd>
<dt id="bib-rfc8615">
[RFC8615]
</dt>
<dd>
<a href= "https://www.rfc-editor.org/rfc/rfc8615">
<cite>
Well-Known
Uniform
Resource
Identifiers
(URIs)
</cite>
</a>.
M.
Nottingham.
IETF.
May
2019.
Proposed
Standard.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc8615
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc8615">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc8615
</ins></a></dd><dt id="bib-rfc8981"><ins class="diff-chg">
[RFC8981]
</ins></dt><dd><a href= "https://www.rfc-editor.org/rfc/rfc8981"><cite><ins class="diff-chg">
Temporary
Address
Extensions
for
Stateless
Address
Autoconfiguration
in
IPv6
</ins></cite></a>.<ins class="diff-chg">
F.
Gont;
S.
Krishnan;
T.
Narten;
R.
Draves.
IETF.
February
2021.
Proposed
Standard.
URL:
</ins><a href= "https://www.rfc-editor.org/rfc/rfc8981"><ins class="diff-chg">
https://www.rfc-editor.org/rfc/rfc8981
</ins></a></dd><dt id="bib-rfc9000"><ins class="diff-chg">
[RFC9000]
</ins></dt><dd><a href="https://www.rfc-editor.org/rfc/rfc9000"><cite><ins class="diff-chg">
QUIC:
A
UDP-Based
Multiplexed
and
Secure
Transport
</ins></cite></a>.<ins class="diff-chg">
J.
Iyengar,
Ed.;
M.
Thomson,
Ed..
IETF.
May
2021.
Proposed
Standard.
URL:
</ins><a href= "https://www.rfc-editor.org/rfc/rfc9000"><ins class="diff-chg">
https://www.rfc-editor.org/rfc/rfc9000
</ins></a></dd><dt id="bib-rfc9175"><ins class="diff-chg">
[RFC9175]
</ins></dt><dd><a href= "https://www.rfc-editor.org/rfc/rfc9175"><cite><ins class="diff-chg">
Constrained
Application
Protocol
(CoAP):
Echo,
Request-Tag,
and
Token
Processing
</ins></cite></a>.<ins class="diff-chg">
C.
Amsüss;
J.
Preuß
Mattsson;
G.
Selander.
IETF.
February
2022.
Proposed
Standard.
URL:
</ins><a href= "https://www.rfc-editor.org/rfc/rfc9175"><ins class="diff-chg">
https://www.rfc-editor.org/rfc/rfc9175
</ins>
</a>
</dd>
<dt id="bib-sparql11-overview">
[SPARQL11-OVERVIEW]
</dt>
<dd>
<a href="https://www.w3.org/TR/sparql11-overview/">
<cite>
SPARQL
1.1
Overview
</cite>
</a>.
The
W3C
SPARQL
Working
Group.
W3C.
21
March
2013.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/sparql11-overview/">
https://www.w3.org/TR/sparql11-overview/
</a>
</dd>
<del class="diff-old">[wot-architecture]
</del>
<dt id="bib-wot-architecture11">
<ins class="diff-chg">[wot-architecture11]
</ins>
</dt>
<dd>
<a href="https://www.w3.org/TR/wot-architecture11/">
<cite>
Web
of
Things
(WoT)
Architecture
<ins class="diff-new">1.1
</ins>
</cite>
</a>.
<del class="diff-old">Matthias
Kovatsch;
Ryuichi
Matsukura;
</del>
Michael
Lagally;
<ins class="diff-new">Ryuichi
Matsukura;
</ins>
Toru
Kawaguchi;
Kunihiko
Toumura;
Kazuo
Kajimoto.
W3C.
<del class="diff-old">9
April
2020.
W3C
Recommendation.
URL:
https://www.w3.org/TR/wot-architecture/
[wot-discovery]
Web
of
Things
(WoT)
Discovery
.
Andrea
Cimmino;
Michael
McCool;
Farshid
Tavakolizadeh;
Kunihiko
Toumura.
W3C.
</del>
24
November
2020.
W3C
Working
Draft.
URL:
<del class="diff-old">https://www.w3.org/TR/wot-discovery/
</del>
<a href= "https://www.w3.org/TR/wot-architecture11/">
<ins class="diff-chg">https://www.w3.org/TR/wot-architecture11/
</ins>
</a>
</dd>
<del class="diff-old">[wot-thing-description]
</del>
<dt id="bib-wot-thing-description11">
<ins class="diff-chg">[wot-thing-description11]
</ins>
</dt>
<dd>
<a href= "https://www.w3.org/TR/wot-thing-description11/">
<cite>
Web
of
Things
(WoT)
Thing
Description
<ins class="diff-new">1.1
</ins>
</cite>
</a>.
Sebastian
Käbisch;
Takuki
Kamiya;
Michael
McCool;
Victor
<del class="diff-old">Charpenay;
Matthias
Kovatsch.
</del>
<ins class="diff-chg">Charpenay.
</ins>
W3C.
<del class="diff-old">9
April
2020.
</del>
<ins class="diff-chg">11
March
2022.
</ins>
W3C
<del class="diff-old">Recommendation.
</del>
<ins class="diff-chg">Working
Draft.
</ins>
URL:
<del class="diff-old">https://www.w3.org/TR/wot-thing-description/
</del>
<a href= "https://www.w3.org/TR/wot-thing-description11/">
<ins class="diff-chg">https://www.w3.org/TR/wot-thing-description11/
</ins>
</a>
</dd>
<dt id="bib-wot-usecases">
[wot-usecases]
</dt>
<dd>
<a href="https://w3c.github.io/wot-usecases/">
<cite>
Web
of
Things
(WoT):
Use
Cases
</cite>
</a>.
Michael
Lagally;
Michael
McCool;
Ryuichi
Matsukura;
Tomoaki
Mizushima.
W3C.
15
October
2020.
Editor's
Draft.
URL:
<a href= "https://w3c.github.io/wot-usecases/">
https://w3c.github.io/wot-usecases/
</a>
</dd>
<dt id="bib-xpath-31">
[xpath-31]
</dt>
<dd>
<a href="https://www.w3.org/TR/xpath-31/">
<cite>
XML
Path
Language
(XPath)
3.1
</cite>
</a>.
Jonathan
Robie;
Michael
Dyck;
Josh
Spiegel.
W3C.
21
March
2017.
W3C
Recommendation.
URL:
<a href= "https://www.w3.org/TR/xpath-31/">
https://www.w3.org/TR/xpath-31/
</a>
</dd>
</dl>
</section>
<section id="informative-references">
<div class="header-wrapper">
<h3 id="d-2-informative-references">
<bdi class="secno">
<del class="diff-old">C.2
</del>
<ins class="diff-chg">D.2
</ins>
</bdi>
Informative
references
</h3>
<a class="self-link" href="#informative-references" aria-label= "Permalink for Appendix D.2">
</a>
</div>
<dl class="bibliography">
<dt id="bib-jsonpath">
[JSONPATH]
</dt>
<dd>
<a href= "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base">
<cite>
<del class="diff-old">JavaScript
Object
Notation
(JSON)
Path
</del>
<ins class="diff-chg">JSONPath:
Query
expressions
for
JSON
</ins>
</cite>
</a>.
<ins class="diff-new">Stefan
Gössner;
</ins>
Glyn
Normington;
<del class="diff-old">Edward
Surov;
Marko
Mikulicic;
Stefan
Gössner.
</del>
<ins class="diff-chg">Carsten
Bormann.
</ins>
IETF.
<del class="diff-old">7
March
2021.
</del>
DRAFT.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base-00
</del>
<a href= "https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base">
<ins class="diff-chg">https://datatracker.ietf.org/doc/html/draft-ietf-jsonpath-base
</ins></a></dd><dt id="bib-ldp-paging"><ins class="diff-chg">
[LDP-Paging]
</ins></dt><dd><a href="https://www.w3.org/TR/ldp-paging/"><cite><ins class="diff-chg">
Linked
Data
Platform
Paging
1.0
</ins></cite></a>.<ins class="diff-chg">
Steve
Speicher;
John
Arwe;
Ashok
Malhotra.
W3C.
30
June
2015.
W3C
Working
Group
Note.
URL:
</ins><a href= "https://www.w3.org/TR/ldp-paging/"><ins class="diff-chg">
https://www.w3.org/TR/ldp-paging/
</ins>
</a>
</dd>
<dt id="bib-rest-iot">
[REST-IOT]
</dt>
<dd>
<a href= "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06">
<cite>
RESTful
Design
for
Internet
of
Things
Systems
</cite>
</a>.
Ari
Keranen;
Matthias
Kovatsch;
Klaus
Hartke.
IETF.
11
May
2020.
URL:
<a href= "https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06">
https://tools.ietf.org/html/draft-irtf-t2trg-rest-iot-06
</a>
</dd>
<dt id="bib-rfc7230">
<ins class="diff-new">[RFC7230]
</ins></dt><dd><a href="https://httpwg.org/specs/rfc7230.html"><cite><ins class="diff-new">
Hypertext
Transfer
Protocol
(HTTP/1.1):
Message
Syntax
and
Routing
</ins></cite></a>.<ins class="diff-new">
R.
Fielding,
Ed.;
J.
Reschke,
Ed..
IETF.
June
2014.
Proposed
Standard.
URL:
</ins><a href= "https://httpwg.org/specs/rfc7230.html"><ins class="diff-new">
https://httpwg.org/specs/rfc7230.html
</ins></a></dd><dt id="bib-rfc7540"><ins class="diff-new">
[RFC7540]
</ins></dt><dd><a href="https://httpwg.org/specs/rfc7540.html"><cite><ins class="diff-new">
Hypertext
Transfer
Protocol
Version
2
(HTTP/2)
</ins></cite></a>.<ins class="diff-new">
M.
Belshe;
R.
Peon;
M.
Thomson,
Ed..
IETF.
May
2015.
Proposed
Standard.
URL:
</ins><a href= "https://httpwg.org/specs/rfc7540.html"><ins class="diff-new">
https://httpwg.org/specs/rfc7540.html
</ins></a></dd><dt id="bib-rfc8323"><ins class="diff-new">
[RFC8323]
</ins></dt><dd><a href="https://www.rfc-editor.org/rfc/rfc8323"><cite><ins class="diff-new">
CoAP
(Constrained
Application
Protocol)
over
TCP,
TLS,
and
WebSockets
</ins></cite></a>.<ins class="diff-new">
C.
Bormann;
S.
Lemay;
H.
Tschofenig;
K.
Hartke;
B.
Silverajan;
B.
Raymor,
Ed..
IETF.
February
2018.
Proposed
Standard.
URL:
</ins><a href= "https://www.rfc-editor.org/rfc/rfc8323"><ins class="diff-new">
https://www.rfc-editor.org/rfc/rfc8323
</ins></a></dd>
<dt id="bib-rfc8552">
[RFC8552]
</dt>
<dd>
<a href="https://www.rfc-editor.org/rfc/rfc8552">
<cite>
Scoped
Interpretation
of
DNS
Resource
Records
through
"Underscored"
Naming
of
Attribute
Leaves
</cite>
</a>.
D.
Crocker.
IETF.
March
2019.
Best
Current
Practice.
URL:
<del class="diff-old">https://datatracker.ietf.org/doc/html/rfc8552
</del>
<a href= "https://www.rfc-editor.org/rfc/rfc8552">
<ins class="diff-chg">https://www.rfc-editor.org/rfc/rfc8552
</ins>
</a>
</dd>
<dt id="bib-wot-security">
[WOT-SECURITY]
</dt>
<dd>
<a href="https://www.w3.org/TR/wot-security/">
<cite>
Web
of
Things
(WoT)
Security
and
Privacy
Guidelines
</cite>
</a>.
Elena
Reshetova;
Michael
McCool.
W3C.
6
November
2019.
W3C
<ins class="diff-new">Working
Group
</ins>
Note.
URL:
<a href= "https://www.w3.org/TR/wot-security/">
https://www.w3.org/TR/wot-security/
</a>
</dd>
</dl>
</section>
</section>
<p role="navigation" id="back-to-top">
<a href="#title">
<abbr title= "Back to Top">
↑
</abbr>
</a>
</p>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing" aria-label= "Links in this document to definition: Thing">
<div>
<a class="self-link" href="#dfn-thing" aria-label= "Permalink for definition: Thing. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<a href="#ref-for-dfn-thing-1" title= "§ 7.2 Thing Description Server">
§
<del class="diff-old">6.1
Self-description
</del>
<ins class="diff-chg">7.2
Thing
Description
Server
</ins></a></li><li><a href="#ref-for-dfn-thing-2" title= "§ 7.3 Thing Description Directory"><ins class="diff-chg">
§
7.3
Thing
Description
Directory
</ins></a></li><li><a href="#ref-for-dfn-thing-3" title="§ 7.3.2.1.1 Creation"><ins class="diff-chg">
§
7.3.2.1.1
Creation
</ins></a><a href="#ref-for-dfn-thing-4" title= "Reference 2"><ins class="diff-chg">
(2)
</ins>
</a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing-description" aria-label= "Links in this document to definition: Thing Description">
<div>
<a class="self-link" href="#dfn-thing-description" aria-label= "Permalink for definition: Thing Description. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<del class="diff-old">Not
referenced
in
this
document.
</del>
<a href="#ref-for-dfn-thing-description-1" title= "§ 4. Architecture">
<ins class="diff-chg">§
4.
Architecture
</ins></a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-td" aria-label= "Links in this document to definition: TD">
<div>
<a class="self-link" href="#dfn-td" aria-label= "Permalink for definition: TD. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<a href="#ref-for-dfn-td-1" title="§ 7.1 Overview">
§
<del class="diff-old">6.1
Self-description
</del>
<ins class="diff-chg">7.1
Overview
</ins></a><a href="#ref-for-dfn-td-2" title= "Reference 2"><ins class="diff-chg">
(2)
</ins>
</a>
</li>
<li>
<a href="#ref-for-dfn-td-3" title="§ 7.1.1.2 ThingLink">
§
<del class="diff-old">6.2
Directory
</del>
<ins class="diff-chg">7.1.1.2
ThingLink
</ins>
</a>
<a href="#ref-for-dfn-td-4" title= "Reference 2">
(2)
</a>
<a href="#ref-for-dfn-td-5" title= "Reference 3">
<ins class="diff-chg">(3)
</ins></a></li><li><a href="#ref-for-dfn-td-6" title= "§ 7.2 Thing Description Server"><ins class="diff-chg">
§
7.2
Thing
Description
Server
</ins></a><a href="#ref-for-dfn-td-7" title="Reference 2"><ins class="diff-chg">
(2)
</ins></a><a href= "#ref-for-dfn-td-8" title="Reference 3"><ins class="diff-chg">
(3)
</ins></a><a href= "#ref-for-dfn-td-9" title="Reference 4"><ins class="diff-chg">
(4)
</ins></a><a href= "#ref-for-dfn-td-10" title="Reference 5"><ins class="diff-chg">
(5)
</ins></a><a href= "#ref-for-dfn-td-11" title="Reference 6"><ins class="diff-chg">
(6)
</ins></a><a href= "#ref-for-dfn-td-12" title="Reference 7"><ins class="diff-chg">
(7)
</ins></a><a href= "#ref-for-dfn-td-13" title="Reference 8"><ins class="diff-chg">
(8)
</ins></a><a href= "#ref-for-dfn-td-14" title="Reference 9"><ins class="diff-chg">
(9)
</ins></a><a href= "#ref-for-dfn-td-15" title="Reference 10"><ins class="diff-chg">
(10)
</ins></a><a href= "#ref-for-dfn-td-16" title="Reference 11"><ins class="diff-chg">
(11)
</ins></a><a href= "#ref-for-dfn-td-17" title="Reference 12"><ins class="diff-chg">
(12)
</ins></a><a href= "#ref-for-dfn-td-18" title="Reference 13"><ins class="diff-chg">
(13)
</ins></a><a href= "#ref-for-dfn-td-19" title="Reference 14"><ins class="diff-chg">
(14)
</ins></a><a href= "#ref-for-dfn-td-20" title="Reference 15"><ins class="diff-chg">
(15)
</ins></a><a href= "#ref-for-dfn-td-21" title="Reference 16"><ins class="diff-chg">
(16)
</ins></a><a href= "#ref-for-dfn-td-22" title="Reference 17"><ins class="diff-chg">
(17)
</ins></a><a href= "#ref-for-dfn-td-23" title="Reference 18"><ins class="diff-chg">
(18)
</ins></a><a href= "#ref-for-dfn-td-24" title="Reference 19"><ins class="diff-chg">
(19)
</ins></a></li><li><a href="#ref-for-dfn-td-25" title= "§ 7.3.1 Information Model"><ins class="diff-chg">
§
7.3.1
Information
Model
</ins></a><a href= "#ref-for-dfn-td-26" title="Reference 2"><ins class="diff-chg">
(2)
</ins></a></li><li><a href="#ref-for-dfn-td-27" title= "§ 7.3.1.1 Registration Information"><ins class="diff-chg">
§
7.3.1.1
Registration
Information
</ins></a><a href="#ref-for-dfn-td-28" title= "Reference 2"><ins class="diff-chg">
(2)
</ins></a><a href="#ref-for-dfn-td-29" title= "Reference 3">
(3)
</a>
<a href="#ref-for-dfn-td-30" title= "Reference 4">
<ins class="diff-new">(4)
</ins></a></li><li><a href="#ref-for-dfn-td-31" title= "§ 7.3.1.2 Registration Expiry"><ins class="diff-new">
§
7.3.1.2
Registration
Expiry
</ins></a><a href="#ref-for-dfn-td-32" title="Reference 2"><ins class="diff-new">
(2)
</ins></a><a href= "#ref-for-dfn-td-33" title="Reference 3"><ins class="diff-new">
(3)
</ins></a><a href= "#ref-for-dfn-td-34" title="Reference 4"><ins class="diff-new">
(4)
</ins></a></li><li><a href="#ref-for-dfn-td-35" title="§ 7.3.2.1 Things API"><ins class="diff-new">
§
7.3.2.1
Things
API
</ins></a><a href="#ref-for-dfn-td-36" title= "Reference 2"><ins class="diff-new">
(2)
</ins></a></li><li><a href="#ref-for-dfn-td-37" title="§ 7.3.2.1.1 Creation"><ins class="diff-new">
§
7.3.2.1.1
Creation
</ins></a><a href="#ref-for-dfn-td-38" title= "Reference 2"><ins class="diff-new">
(2)
</ins></a></li><li><a href="#ref-for-dfn-td-39" title="§ 7.3.2.1.3 Update"><ins class="diff-new">
§
7.3.2.1.3
Update
</ins></a></li><li><a href="#ref-for-dfn-td-40" title="§ 7.3.2.2 Events API"><ins class="diff-new">
§
7.3.2.2
Events
API
</ins></a><a href="#ref-for-dfn-td-41" title= "Reference 2"><ins class="diff-new">
(2)
</ins></a></li><li><a href="#ref-for-dfn-td-42" title="§ 7.3.2.3 Search API"><ins class="diff-new">
§
7.3.2.3
Search
API
</ins></a></li><li><a href="#ref-for-dfn-td-43" title= "§ 10.1 Incremental Transfer"><ins class="diff-new">
§
10.1
Incremental
Transfer
</ins></a></li><li><a href="#ref-for-dfn-td-44" title= "§ A. JSON Schema for WoT Discovery TD-extensions"><ins class="diff-new">
§
A.
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins></a></li></ul></div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-thing-model" aria-label= "Links in this document to definition: Thing Model"><div><a class="self-link" href="#dfn-thing-model" aria-label= "Permalink for definition: Thing Model. Activate to close this dialog."><ins class="diff-new">
Permalink
</ins></a></div><p><b><ins class="diff-new">
Referenced
in:
</ins></b></p><ul><li><a href="#ref-for-dfn-thing-model-1" title= "§ 7.3.2.4 API Specification (Thing Model)"><ins class="diff-new">
§
7.3.2.4
API
Specification
(Thing
Model)
</ins></a></li></ul></div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-tm" aria-label= "Links in this document to definition: TM"><div><a class="self-link" href="#dfn-tm" aria-label= "Permalink for definition: TM. Activate to close this dialog."><ins class="diff-new">
Permalink
</ins></a></div><p>
<b>
<ins class="diff-new">Referenced
in:
</ins></b></p><ul><li><ins class="diff-new">
Not
referenced
in
this
document.
</ins>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-property" aria-label= "Links in this document to definition: Property">
<div>
<a class="self-link" href="#dfn-property" aria-label= "Permalink for definition: Property. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-action" aria-label= "Links in this document to definition: Action">
<div>
<a class="self-link" href="#dfn-action" aria-label= "Permalink for definition: Action. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-event" aria-label= "Links in this document to definition: Event">
<div>
<a class="self-link" href="#dfn-event" aria-label= "Permalink for definition: Event. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-anonymous-thing-description" aria-label= "Links in this document to definition: Anonymous TD">
<div>
<a class="self-link" href= "#dfn-wot-anonymous-thing-description" aria-label= "Permalink for definition: Anonymous TD. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<a href="#ref-for-dfn-wot-anonymous-thing-description-1" title= "§ 7.3.1.3 Anonymous TD Identifiers">
§
<del class="diff-old">6.2.2.1.1
</del>
<ins class="diff-chg">7.3.1.3
Anonymous
TD
Identifiers
</ins></a></li><li><a href="#ref-for-dfn-wot-anonymous-thing-description-2" title= "§ 7.3.2.1.1 Creation"><ins class="diff-chg">
§
7.3.2.1.1
</ins>
Creation
</a>
<a href= "#ref-for-dfn-wot-anonymous-thing-description-3" title= "Reference 2">
(2)
</a>
<a href= "#ref-for-dfn-wot-anonymous-thing-description-4" title= "Reference 3">
<ins class="diff-new">(3)
</ins></a><a href= "#ref-for-dfn-wot-anonymous-thing-description-5" title= "Reference 4"><ins class="diff-new">
(4)
</ins></a></li><li><a href="#ref-for-dfn-wot-anonymous-thing-description-6" title= "§ 7.3.2.1.2 Retrieval"><ins class="diff-new">
§
7.3.2.1.2
Retrieval
</ins></a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-discoverer" aria-label= "Links in this document to definition: Discoverer">
<div>
<a class="self-link" href="#dfn-wot-discoverer" aria-label= "Permalink for definition: Discoverer. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<del class="diff-old">Not
referenced
in
this
document.
</del>
<a href="#ref-for-dfn-wot-discoverer-1" title= "§ 5. Discoverer Process">
<ins class="diff-chg">§
5.
Discoverer
Process
</ins></a></li><li><a href="#ref-for-dfn-wot-discoverer-2" title= "§ 7.3.2.1.1 Creation"><ins class="diff-chg">
§
7.3.2.1.1
Creation
</ins></a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-discovery" aria-label= "Links in this document to definition: Discovery">
<div>
<a class="self-link" href="#dfn-wot-discovery" aria-label= "Permalink for definition: Discovery. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<del class="diff-old">§
6.2
Directory
</del>
<ins class="diff-chg">Not
referenced
in
this
document.
</ins>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-exploration" aria-label= "Links in this document to definition: Exploration">
<div>
<a class="self-link" href="#dfn-wot-exploration" aria-label= "Permalink for definition: Exploration. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-introduction" aria-label= "Links in this document to definition: Introduction">
<div>
<a class="self-link" href="#dfn-wot-introduction" aria-label= "Permalink for definition: Introduction. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-thing-description-server" aria-label= "Links in this document to definition: Thing Description Server">
<div>
<a class="self-link" href="#dfn-wot-thing-description-server" aria-label= "Permalink for definition: Thing Description Server. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
Not
referenced
in
this
document.
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-td-server" aria-label= "Links in this document to definition: TD Server">
<div>
<a class="self-link" href="#dfn-wot-td-server" aria-label= "Permalink for definition: TD Server. Activate to close this dialog.">
<ins class="diff-new">Permalink
</ins></a></div><p><b><ins class="diff-new">
Referenced
in:
</ins></b></p><ul><li><a href="#ref-for-dfn-wot-td-server-1" title="§ 7.1 Overview"><ins class="diff-new">
§
7.1
Overview
</ins></a></li></ul></div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-thing-description-directory" aria-label= "Links in this document to definition: Thing Description Directory">
<div>
<a class="self-link" href= "#dfn-wot-thing-description-directory" aria-label= "Permalink for definition: Thing Description Directory. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-1" title= "§ 6. Introduction Mechanisms">
§
<del class="diff-old">5.
</del>
<ins class="diff-chg">6.
</ins>
Introduction
Mechanisms
</a>
<a href="#ref-for-dfn-wot-thing-description-directory-2" title= "Reference 2">
(2)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-3" title= "§ 6.1 Direct">
§
<del class="diff-old">5.1
</del>
<ins class="diff-chg">6.1
</ins>
Direct
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-4" title= "Reference 2">
(2)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-5" title= "§ 6.2 Well-Known URIs">
§
<del class="diff-old">5.2
</del>
<ins class="diff-chg">6.2
</ins>
Well-Known
URIs
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-6" title= "Reference 2">
(2)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-7" title= "§ 6.3 DNS-Based Service Discovery">
§
<del class="diff-old">5.3
</del>
<ins class="diff-chg">6.3
</ins>
DNS-Based
Service
Discovery
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-8" title= "Reference 2">
(2)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-9" title= "Reference 3">
(3)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-10" title= "Reference 4">
(4)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-11" title= "Reference 5">
(5)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-12" title= "Reference 6">
(6)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-13" title= "Reference 7">
(7)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-14" title="§ 6.4 CoRE Link Format and CoRE Resource Directory">
§
<del class="diff-old">5.4
</del>
<ins class="diff-chg">6.4
</ins>
CoRE
Link
Format
and
CoRE
Resource
Directory
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-15" title= "Reference 2">
(2)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-16" title= "Reference 3">
(3)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-17" title="§ 6.5 DID Documents">
§
<del class="diff-old">5.5
</del>
<ins class="diff-chg">6.5
</ins>
DID
Documents
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-18" title= "Reference 2">
(2)
</a>
<a href= "#ref-for-dfn-wot-thing-description-directory-19" title= "Reference 3">
(3)
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-20" title="§ 7.1 Overview">
§
<del class="diff-old">6.
Exploration
Mechanisms
</del>
<ins class="diff-chg">7.1
Overview
</ins></a><a href= "#ref-for-dfn-wot-thing-description-directory-21" title= "Reference 2"><ins class="diff-chg">
(2)
</ins>
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-22" title="§ 7.3 Thing Description Directory">
§
<del class="diff-old">6.1
Self-description
</del>
<ins class="diff-chg">7.3
Thing
Description
Directory
</ins>
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-23" title="§ 7.3.1 Information Model">
§
<del class="diff-old">6.2
Directory
</del>
<ins class="diff-chg">7.3.1
Information
Model
</ins>
</a>
<del class="diff-old">(2)
</del>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-24" title="§ 7.3.1.1 Registration Information">
<ins class="diff-chg">§
7.3.1.1
Registration
Information
</ins>
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-thing-description-directory-25" title="§ 11.3 CoRE Resource Types Registration">
§
<del class="diff-old">8.1
</del>
<ins class="diff-chg">11.3
</ins>
CoRE
Resource
Types
Registration
</a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-tdd" aria-label= "Links in this document to definition: TDD">
<div>
<a class="self-link" href="#dfn-wot-tdd" aria-label= "Permalink for definition: TDD. Activate to close this dialog.">
<ins class="diff-new">Permalink
</ins></a></div><p><b><ins class="diff-new">
Referenced
in:
</ins></b></p><ul><li><a href="#ref-for-dfn-wot-tdd-1" title= "§ A. JSON Schema for WoT Discovery TD-extensions"><ins class="diff-new">
§
A.
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins></a></li></ul></div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-partial-thing-description" aria-label= "Links in this document to definition: Partial TD">
<div>
<a class="self-link" href="#dfn-wot-partial-thing-description" aria-label= "Permalink for definition: Partial TD. Activate to close this dialog.">
Permalink
</a>
</div>
<p>
<b>
Referenced
in:
</b>
</p>
<ul>
<li>
<a href="#ref-for-dfn-wot-partial-thing-description-1" title= "§ 7.3.2.1.3 Update">
§
<del class="diff-old">6.2.2.1.3
</del>
<ins class="diff-chg">7.3.2.1.3
</ins>
Update
</a>
</li>
<li>
<a href="#ref-for-dfn-wot-partial-thing-description-2" title= "§ 7.3.2.2 Events API">
§
<del class="diff-old">6.2.2.1.5
Listing
</del>
<ins class="diff-chg">7.3.2.2
Events
API
</ins></a><a href= "#ref-for-dfn-wot-partial-thing-description-3" title= "Reference 2"><ins class="diff-chg">
(2)
</ins>
</a>
</li>
</ul>
</div>
<div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-wot-enriched-thing-description" aria-label= "Links in this document to definition: Enriched TD">
<div>
<a class="self-link" href= "#dfn-wot-enriched-thing-description" aria-label= "Permalink for definition: Enriched TD. Activate to close this dialog.">
<ins class="diff-new">Permalink
</ins></a></div><p><b><ins class="diff-new">
Referenced
in:
</ins></b></p><ul>
<li>
<a href="#ref-for-dfn-wot-enriched-thing-description-1" title= "§ 7.3.1 Information Model">
§
<del class="diff-old">6.2.2.3
Notification
</del>
<ins class="diff-chg">7.3.1
Information
Model
</ins></a></li><li><a href="#ref-for-dfn-wot-enriched-thing-description-2" title= "§ 7.3.1.1 Registration Information"><ins class="diff-chg">
§
7.3.1.1
Registration
Information
</ins></a><a href= "#ref-for-dfn-wot-enriched-thing-description-3" title= "Reference 2"><ins class="diff-chg">
(2)
</ins></a></li><li><a href="#ref-for-dfn-wot-enriched-thing-description-4" title= "§ 7.3.2.1.2 Retrieval"><ins class="diff-chg">
§
7.3.2.1.2
Retrieval
</ins></a><a href= "#ref-for-dfn-wot-enriched-thing-description-5" title= "Reference 2"><ins class="diff-chg">
(2)
</ins></a></li><li><a href="#ref-for-dfn-wot-enriched-thing-description-6" title= "§ 7.3.2.1.6 Validation"><ins class="diff-chg">
§
7.3.2.1.6
Validation
</ins></a></li><li><a href="#ref-for-dfn-wot-enriched-thing-description-7" title= "§ A. JSON Schema for WoT Discovery TD-extensions"><ins class="diff-chg">
§
A.
JSON
Schema
for
WoT
Discovery
TD-extensions
</ins>
</a>
</li>
</ul>
</div>
<script id="respec-dfn-panel">
<![CDATA[ (() =>
{
//
@ts-check
if
(document.respec)
{
document.respec.ready.then(setupPanel);
}
else
{
setupPanel();
}
function
setupPanel()
{
const
listener
=
panelListener();
document.body.addEventListener("keydown",
listener);
document.body.addEventListener("click",
listener);
}
function
panelListener()
{
/**
@type
{HTMLElement}
*/
let
panel
=
null;
return
event
=>
{
const
{
target,
type
}
=
event;
if
(!(target
instanceof
HTMLElement))
return;
//
For
keys,
we
only
care
about
Enter
key
to
activate
the
panel
//
otherwise
it's
activated
via
a
click.
if
(type
===
"keydown"
&&
event.key
!==
"Enter")
return;
const
action
=
deriveAction(event);
switch
(action)
{
case
"show":
{
hidePanel(panel);
/**
@type
{HTMLElement}
*/
const
dfn
=
target.closest("dfn,
.index-term");
panel
=
document.getElementById(`dfn-panel-for-${dfn.id}`);
const
coords
=
deriveCoordinates(event);
displayPanel(dfn,
panel,
coords);
break;
}
case
"dock":
{
panel.style.left
=
null;
panel.style.top
=
null;
panel.classList.add("docked");
break;
}
case
"hide":
{
hidePanel(panel);
panel
=
null;
break;
}
}
};
}
/**
*
@param
{MouseEvent|KeyboardEvent}
event
*/
function
deriveCoordinates(event)
{
const
target
=
/**
@type
HTMLElement
*/
(event.target);
//
We
prevent
synthetic
AT
clicks
from
putting
//
the
dialog
in
a
weird
place.
The
AT
events
sometimes
//
lack
coordinates,
so
they
have
clientX/Y
=
0
const
rect
=
target.getBoundingClientRect();
if
(
event
instanceof
MouseEvent
&&
event.clientX
>
=
rect.left
&&
event.clientY
>
=
rect.top
)
{
//
The
event
probably
happened
inside
the
bounding
rect...
return
{
x:
event.clientX,
y:
event.clientY
};
}
//
Offset
to
the
middle
of
the
element
const
x
=
rect.x
+
rect.width
/
2;
//
Placed
at
the
bottom
of
the
element
const
y
=
rect.y
+
rect.height;
return
{
x,
y
};
}
/**
*
@param
{Event}
event
*/
function
deriveAction(event)
{
const
target
=
/**
@type
{HTMLElement}
*/
(event.target);
const
hitALink
=
!!target.closest("a");
if
(target.closest("dfn:not([data-cite]),
.index-term"))
{
return
hitALink
?
"none"
:
"show";
}
if
(target.closest(".dfn-panel"))
{
if
(hitALink)
{
return
target.classList.contains("self-link")
?
"hide"
:
"dock";
}
const
panel
=
target.closest(".dfn-panel");
return
panel.classList.contains("docked")
?
"hide"
:
"none";
}
if
(document.querySelector(".dfn-panel:not([hidden])"))
{
return
"hide";
}
return
"none";
}
/**
*
@param
{HTMLElement}
dfn
*
@param
{HTMLElement}
panel
*
@param
{{
x:
number,
y:
number
}}
clickPosition
*/
function
displayPanel(dfn,
panel,
{
x,
y
})
{
panel.hidden
=
false;
//
distance
(px)
between
edge
of
panel
and
the
pointing
triangle
(caret)
const
MARGIN
=
20;
const
dfnRects
=
dfn.getClientRects();
//
Find
the
`top`
offset
when
the
`dfn`
can
be
spread
across
multiple
lines
let
closestTop
=
0;
let
minDiff
=
Infinity;
for
(const
rect
of
dfnRects)
{
const
{
top,
bottom
}
=
rect;
const
diffFromClickY
=
Math.abs((top
+
bottom)
/
2
-
y);
if
(diffFromClickY
< minDiff) { minDiff = diffFromClickY; closestTop = top; } } const top = window.scrollY + closestTop + dfnRects[0].height; const left = x - MARGIN; panel.style.left = `${left}px`; panel.style.top = `${top}px`; // Find if the panel is flowing out of the window const panelRect = panel.getBoundingClientRect(); const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width); if (panelRect.right >
SCREEN_WIDTH)
{
const
newLeft
=
Math.max(MARGIN,
x
+
MARGIN
-
panelRect.width);
const
newCaretOffset
=
left
-
newLeft;
panel.style.left
=
`${newLeft}px`;
/**
@type
{HTMLElement}
*/
const
caret
=
panel.querySelector(".caret");
caret.style.left
=
`${newCaretOffset}px`;
}
//
As
it's
a
dialog,
we
trap
focus.
//
TODO:
when
<dialog>
becomes
a
implemented,
we
should
really
//
use
that.
trapFocus(panel,
dfn);
}
/**
*
@param
{HTMLElement}
panel
*
@param
{HTMLElement}
dfn
*
@returns
*/
function
trapFocus(panel,
dfn)
{
/**
@type
NodeListOf
<HTMLAnchorElement>
elements
*/
const
anchors
=
panel.querySelectorAll("a[href]");
//
No
need
to
trap
focus
if
(!anchors.length)
return;
//
Move
focus
to
first
anchor
element
const
first
=
anchors.item(0);
first.focus();
const
trapListener
=
createTrapListener(anchors,
panel,
dfn);
panel.addEventListener("keydown",
trapListener);
//
Hiding
the
panel
releases
the
trap
const
mo
=
new
MutationObserver(records
=>
{
const
[record]
=
records;
const
target
=
/**
@type
HTMLElement
*/
(record.target);
if
(target.hidden)
{
panel.removeEventListener("keydown",
trapListener);
mo.disconnect();
}
});
mo.observe(panel,
{
attributes:
true,
attributeFilter:
["hidden"]
});
}
/**
*
*
@param
{NodeListOf
<HTMLAnchorElement>
}
anchors
*
@param
{HTMLElement}
panel
*
@param
{HTMLElement}
dfn
*
@returns
*/
function
createTrapListener(anchors,
panel,
dfn)
{
const
lastIndex
=
anchors.length
-
1;
let
currentIndex
=
0;
return
event
=>
{
switch
(event.key)
{
//
Hitting
"Tab"
traps
us
in
a
nice
loop
around
elements.
case
"Tab":
{
event.preventDefault();
currentIndex
+=
event.shiftKey
?
-1
:
+1;
if
(currentIndex
< 0) { currentIndex = lastIndex; } else if (currentIndex >
lastIndex)
{
currentIndex
=
0;
}
anchors.item(currentIndex).focus();
break;
}
//
Hitting
"Enter"
on
an
anchor
releases
the
trap.
case
"Enter":
hidePanel(panel);
break;
//
Hitting
"Escape"
returns
focus
to
dfn.
case
"Escape":
hidePanel(panel);
dfn.focus();
return;
}
};
}
/**
@param
{HTMLElement}
panel
*/
function
hidePanel(panel)
{
if
(!panel)
return;
panel.hidden
=
true;
panel.classList.remove("docked");
}
})()
]]>
</script>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js">
</script>
</body>
</html>
